"use strict";(self["webpackChunkaftersaleweb"]=self["webpackChunkaftersaleweb"]||[]).push([[715],{4909:function(e,t,a){a.d(t,{A1:function(){return i},dr:function(){return l},e8:function(){return s},vQ:function(){return n},z1:function(){return r}});var o=a(3745);function l(e){return(0,o.Z)({url:"/api/resourceInfo/listResourceInfo",method:"post",data:e})}function r(e){return(0,o.Z)({url:"/api/resourceInfo/listResourceInfoOrRole?roleId="+e,method:"get"})}function i(e){return(0,o.Z)({url:"/api/resourceInfo/saveResourceInfo",method:"post",data:e})}function s(e){return(0,o.Z)({url:"/api/resourceInfo/updateResourceInfo",method:"post",data:e})}function n(e){return(0,o.Z)({url:"/api/resourceInfo/deleteResourceInfoById",method:"get",params:e})}},3048:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var o=a(9003);const l={class:"moduleBoxView"},r={class:"moduleFrom"},i={class:"moduletTable",ref:"tableDiv"},s={class:"modulePagination"};function n(e,t,a,n,d,m){const u=(0,o.up)("el-input"),c=(0,o.up)("el-form-item"),h=(0,o.up)("el-button"),p=(0,o.up)("el-form"),f=(0,o.up)("el-table-column"),g=(0,o.up)("el-table"),w=(0,o.up)("el-pagination"),b=(0,o.up)("Role-operate"),$=(0,o.up)("Role-resource");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",r,[(0,o.Wm)(p,{inline:!0,model:e.fromData,class:"demo-form-inline"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{label:e.$t("RoleView.name")},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{modelValue:e.fromData.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fromData.name=t),placeholder:e.$t("RoleView.namePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.Wm)(c,{label:e.$t("RoleView.remark")},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{modelValue:e.fromData.remark,"onUpdate:modelValue":t[1]||(t[1]=t=>e.fromData.remark=t),placeholder:e.$t("RoleView.remarkPlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{type:"primary",onClick:t[2]||(t[2]=e=>m.listData())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.search")),1)])),_:1}),(0,o.Wm)(h,{type:"info",onClick:t[3]||(t[3]=e=>m.reset())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.reset")),1)])),_:1}),(0,o.wy)((0,o.Wm)(h,{type:"success",onClick:t[4]||(t[4]=e=>m.add())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.add")),1)])),_:1},512),[[o.F8,m.isButton("role.add")]])])),_:1})])),_:1},8,["model"])]),(0,o._)("div",i,[(0,o.Wm)(g,{data:e.tableData,height:e.tabHeight,"empty-text":e.$t("common.table.noData"),stripe:"",border:"",fit:"","highlight-current-row":"",style:{width:"100%","margin-bottom":"5px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{fixed:"",type:"index",label:e.$t("common.table.number"),width:"90"},null,8,["label"]),(0,o.Wm)(f,{prop:"name",label:e.$t("RoleView.name"),width:"200","show-overflow-tooltip":""},null,8,["label"]),(0,o.Wm)(f,{prop:"nameEn",label:e.$t("RoleView.nameEn"),width:"200","show-overflow-tooltip":""},null,8,["label"]),(0,o.Wm)(f,{prop:"remark",label:e.$t("RoleView.remark"),"show-overflow-tooltip":""},null,8,["label"]),(0,o.Wm)(f,{prop:"createTime",label:e.$t("RoleView.createTime"),width:"250","show-overflow-tooltip":""},null,8,["label"]),(0,o.Wm)(f,{fixed:"right",label:e.$t("common.table.operation"),width:"250"},{default:(0,o.w5)((t=>[(0,o.wy)((0,o.Wm)(h,{type:"primary",size:"small",onClick:e=>m.goRoleResource(t.$index,t.row)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.permission")),1)])),_:2},1032,["onClick"]),[[o.F8,m.isButton("role.upresource")]]),(0,o.wy)((0,o.Wm)(h,{type:"warning",size:"small",onClick:e=>m.goOperate(t.$index,t.row,"edit")},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.edit")),1)])),_:2},1032,["onClick"]),[[o.F8,m.isButton("role.update")]]),(0,o.wy)((0,o.Wm)(h,{type:"danger",size:"small",onClick:e=>m.deleteRow(t.$index,t.row)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.delete")),1)])),_:2},1032,["onClick"]),[[o.F8,m.isButton("role.delete")]])])),_:1},8,["label"])])),_:1},8,["data","height","empty-text"])],512),(0,o._)("div",s,[(0,o.Wm)(w,{background:"","current-page":e.pageNum,"onUpdate:currentPage":t[5]||(t[5]=t=>e.pageNum=t),"page-size":e.pageSize,"onUpdate:pageSize":t[6]||(t[6]=t=>e.pageSize=t),"page-sizes":[10,30,50,75,100],small:!1,layout:"prev, pager, next, sizes, jumper, total",total:e.total,onSizeChange:m.handleSizeChange,onCurrentChange:m.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),(0,o.Wm)(b,{ref:"operate",onOperateClick:m.listData},null,8,["onOperateClick"]),(0,o.Wm)($,{ref:"resource"},null,512)])}var d=a(3885),m=a(5925),u=a(3745);function c(e){return(0,u.Z)({url:"/api/role/listRole",method:"post",data:e})}function h(e){return(0,u.Z)({url:"/api/role/updateRoleResource",method:"post",data:e})}function p(e){return(0,u.Z)({url:"/api/role/saveRole",method:"post",data:e})}function f(e){return(0,u.Z)({url:"/api/role/updateRole",method:"post",data:e})}function g(e){return(0,u.Z)({url:"/api/role/deleteRoleById",method:"get",params:e})}const w={id:"styleVeiw"},b={class:"demo-drawer__content"},$={class:"treeBox"},y={class:"drawerButton"};function k(e,t,a,l,r,i){const s=(0,o.up)("el-tree"),n=(0,o.up)("el-button"),d=(0,o.up)("el-drawer");return(0,o.wg)(),(0,o.iD)("div",w,[(0,o.Wm)(d,{modelValue:r.drawer,"onUpdate:modelValue":t[1]||(t[1]=e=>r.drawer=e),title:e.$t("common.dialog.permissionTitle"),direction:r.direction,"before-close":i.handleClose},{default:(0,o.w5)((()=>[(0,o._)("div",b,[(0,o._)("div",$,[(0,o.Wm)(s,{ref:"tree",data:r.data,"show-checkbox":"","node-key":"id","default-expand-all":!0,"default-checked-keys":r.checkedKeys,props:r.defaultProps,"highlight-current":!0},null,8,["data","default-checked-keys","props"])]),(0,o._)("div",y,[(0,o.Wm)(n,{type:"primary",onClick:i.getSelectedNode},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.confirm")),1)])),_:1},8,["onClick"]),(0,o.Wm)(n,{type:"info",onClick:t[0]||(t[0]=e=>i.closeButton())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.cancel")),1)])),_:1})])])])),_:1},8,["modelValue","title","direction","before-close"])])}var V=a(4909),R=a(6666),W={data(){return{drawer:!1,direction:"rtl",rowData:{},defaultProps:{children:"resourceInfoList",label:"name"},data:[],checkedKeys:[]}},mounted(){},methods:{resourceList(e){this.rowData=e,(0,V.z1)(e.id).then((e=>{200==e.data.status&&(this.data=e.data.data.resourceInfoList,this.checkedKeys=e.data.data.roleResourecIds)})).catch((e=>{}))},getSelectedNode(){const e=this.$refs.tree.getCheckedNodes(),t=this.$refs.tree.getHalfCheckedNodes(),a=[...e,...t];h({id:this.rowData.id,resourceInfoVoList:a}).then((e=>{this.closeButton(),200==e.data.status&&(0,R.bM)({title:this.$t("common.message.successTitle"),message:e.data.msg,type:"success"})})).catch((e=>{}))},closeButton(){this.checkedKeys=[],this.drawer=!1},handleClose(e){this.closeButton(),e()}}},C=a(89);const _=(0,C.Z)(W,[["render",k],["__scopeId","data-v-e14ad65c"]]);var v=_;const D={id:"style-operate"},z={class:"dialog-footer"};function N(e,t,a,l,r,i){const s=(0,o.up)("el-input"),n=(0,o.up)("el-form-item"),d=(0,o.up)("el-form"),m=(0,o.up)("el-button"),u=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.iD)("div",D,[(0,o.Wm)(u,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[5]||(t[5]=t=>e.dialogFormVisible=t),"before-close":i.beforeClose,title:e.titleName,width:"600",draggable:""},{footer:(0,o.w5)((()=>[(0,o._)("span",z,[(0,o.Wm)(m,{onClick:t[3]||(t[3]=e=>i.closeButton())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.cancel")),1)])),_:1}),(0,o.wy)((0,o.Wm)(m,{type:"primary",onClick:t[4]||(t[4]=e=>i.submitButton())},{default:(0,o.w5)((()=>[(0,o.Uk)((0,o.zw)(e.$t("common.button.confirm")),1)])),_:1},512),[[o.F8,"detail"!=e.type]])])])),default:(0,o.w5)((()=>[(0,o.Wm)(d,{model:e.form,rules:e.rules,ref:"ruleForm"},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{label:e.$t("RoleView.name"),"label-width":e.formLabelWidth,prop:"name"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{readonly:e.isReadonly,modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.name=t),placeholder:e.$t("RoleView.namePlaceholder"),autocomplete:"off"},null,8,["readonly","modelValue","placeholder"])])),_:1},8,["label","label-width"]),(0,o.Wm)(n,{label:e.$t("RoleView.nameEn"),"label-width":e.formLabelWidth,prop:"nameEn"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{readonly:e.isReadonly,modelValue:e.form.nameEn,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.nameEn=t),placeholder:e.$t("RoleView.nameEnPlaceholder"),autocomplete:"off"},null,8,["readonly","modelValue","placeholder"])])),_:1},8,["label","label-width"]),(0,o.Wm)(n,{label:e.$t("RoleView.remark"),"label-width":e.formLabelWidth},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{readonly:e.isReadonly,modelValue:e.form.remark,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.remark=t),placeholder:e.$t("RoleView.remarkPlaceholder"),autocomplete:"off"},null,8,["readonly","modelValue","placeholder"])])),_:1},8,["label","label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close","title"])])}var B={name:"style-operate",data:function(){return{dialogFormVisible:!1,rowData:{},form:{},rules:{name:[{required:!0,message:this.$t("RoleView.namePlaceholder"),trigger:"blur"}],nameEn:[{required:!0,message:this.$t("RoleView.nameEnPlaceholder"),trigger:"blur"}]},type:"",titleName:this.$t("common.dialog.defaultTitle"),isReadonly:!1,formLabelWidth:"150px"}},watch:{type(e,t){""!=e&&("add"==e&&(this.titleName=this.$t("common.dialog.addTitle")),"edit"==e&&(this.titleName=this.$t("common.dialog.editTitle")),"detail"==e&&(this.titleName=this.$t("common.dialog.detailTitle")))}},mounted(){},methods:{beforeClose(e){this.closeButton(),e()},closeButton(){this.dialogFormVisible=!1,this.isReadonly=!1,this.form={},this.rowData={},this.$refs.ruleForm.resetFields()},submitButton(){this.$refs.ruleForm.validate((e=>{if(!e)return!1;"add"==this.type?p(this.form).then((e=>{200==e.data.status&&(this.dialogFormVisible=!1,(0,R.bM)({title:this.$t("common.message.successTitle"),message:e.data.msg,type:"success"}),this.$emit("operateClick"))})).catch((e=>{})):"edit"==this.type&&f(this.form).then((e=>{200==e.data.status&&(this.dialogFormVisible=!1,(0,R.bM)({title:this.$t("common.message.successTitle"),message:e.data.msg,type:"success"}),this.$emit("operateClick"))})).catch((e=>{})),this.closeButton()}))}}};const I=(0,C.Z)(B,[["render",N],["__scopeId","data-v-46a4d1d1"]]);var x=I,S=a(4775),T={name:"styleVeiw",components:{userAdminOperate:m.Z,RoleResource:v,RoleOperate:x},data:function(){return{tabHeight:0,fromData:{},tableData:[],total:0,pages:0,pageNum:1,pageSize:30}},mounted(){this.listData(),this.refreshTableHeight()},methods:{refreshTableHeight(){const e=new ResizeObserver((e=>{for(const t of e)t.target===this.$refs.tableDiv&&(this.tabHeight=this.$refs.tableDiv.offsetHeight-20)}));e.observe(this.$refs.tableDiv)},isButton(e){return(0,d.a)(e)},listData(){const e=S.kN.service({lock:!0,text:this.$t("common.loadingText"),background:"rgba(0, 0, 0, 0.7)"});this.fromData.pageSize=this.pageSize,this.fromData.pageNum=this.pageNum,c(this.fromData).then((e=>{this.tableData=e.data.data.list,this.total=e.data.data.total,this.pages=e.data.data.pages,this.pageNum=e.data.data.pageNum,this.pageSize=e.data.data.pageSize})).catch((e=>{console.log(e,"erro")})).finally((()=>{e.close()}))},handleSizeChange(e){console.log(`每页 ${e} 条`),this.pageNum=1,this.pageSize=e,this.listData()},handleCurrentChange(e){console.log(`当前页: ${e}`),this.pageNum=e,this.listData()},reset(){this.fromData={},this.listData()},add(){this.$refs.operate.dialogFormVisible=!0,this.$refs.operate.type="add"},goRoleResource(e,t){this.$refs.resource.drawer=!0,this.$refs.resource.resourceList(t)},goOperate(e,t,a){this.$refs.operate.dialogFormVisible=!0,this.$refs.operate.type=a,"detail"==a?(this.$refs.operate.isReadonly=!0,this.$refs.operate.form=JSON.parse(JSON.stringify(t))):"edit"==a&&(this.$refs.operate.rowData=t,this.$refs.operate.form=JSON.parse(JSON.stringify(t)))},deleteRow(e,t){this.$confirm(this.$t("common.dialog.deleteTips"),this.$t("common.dialog.deleteTitle"),{confirmButtonText:this.$t("common.button.confirm"),cancelButtonText:this.$t("common.button.cancel"),type:"warning"}).then((()=>{g({id:t.id}).then((t=>{200==t.data.status&&(this.tableData.splice(e,1),(0,R.bM)({title:this.$t("common.message.successTitle"),message:t.data.msg,type:"success"}))})).catch((e=>{}))}))}}};const U=(0,C.Z)(T,[["render",n],["__scopeId","data-v-d637d088"]]);var F=U}}]);
//# sourceMappingURL=715.c3781d75.js.map