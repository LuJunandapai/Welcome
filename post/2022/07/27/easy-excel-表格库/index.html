<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Easy Excel è¡¨æ ¼åº“ | é™¤éä¸–ç•Œé¢ å€’</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/Welcome/img/logo.svg">
    <meta name="description" content="èƒèŸ¹ä¸èƒ½å‰¥æˆ‘çš„å£³ï¼Œç¬”è®°æœ¬ä¸å¯èƒ½åœ¨å†™æˆ‘ï¼Œæˆ‘ä¸å¯èƒ½è½åœ¨æ«å¶ä¸Šé›ªèŠ±ä¸Šï¼Œè€Œä½ ä¸å¯èƒ½æƒ³æˆ‘ ...">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/Welcome/assets/css/0.styles.dc2e030a.css" as="style"><link rel="preload" href="/Welcome/assets/js/app.62c113e7.js" as="script"><link rel="preload" href="/Welcome/assets/js/8.d7055a2e.js" as="script"><link rel="preload" href="/Welcome/assets/js/1.ed48a7ee.js" as="script"><link rel="preload" href="/Welcome/assets/js/2.9a3f7cc9.js" as="script"><link rel="preload" href="/Welcome/assets/js/21.4ee97050.js" as="script"><link rel="prefetch" href="/Welcome/assets/js/10.4c48ef06.js"><link rel="prefetch" href="/Welcome/assets/js/11.b879bea0.js"><link rel="prefetch" href="/Welcome/assets/js/12.fb12f646.js"><link rel="prefetch" href="/Welcome/assets/js/13.cbffec13.js"><link rel="prefetch" href="/Welcome/assets/js/14.235162ad.js"><link rel="prefetch" href="/Welcome/assets/js/15.f726175e.js"><link rel="prefetch" href="/Welcome/assets/js/16.c9eb623a.js"><link rel="prefetch" href="/Welcome/assets/js/17.021a23c6.js"><link rel="prefetch" href="/Welcome/assets/js/18.b9380bdc.js"><link rel="prefetch" href="/Welcome/assets/js/19.b245b3c0.js"><link rel="prefetch" href="/Welcome/assets/js/20.60eb44b8.js"><link rel="prefetch" href="/Welcome/assets/js/22.315eec61.js"><link rel="prefetch" href="/Welcome/assets/js/23.8431a4bd.js"><link rel="prefetch" href="/Welcome/assets/js/24.51ef1c6f.js"><link rel="prefetch" href="/Welcome/assets/js/25.72511ca8.js"><link rel="prefetch" href="/Welcome/assets/js/26.1bf3f67c.js"><link rel="prefetch" href="/Welcome/assets/js/27.ce57d01c.js"><link rel="prefetch" href="/Welcome/assets/js/28.f46d854f.js"><link rel="prefetch" href="/Welcome/assets/js/29.c5eb4221.js"><link rel="prefetch" href="/Welcome/assets/js/30.0be5fc4c.js"><link rel="prefetch" href="/Welcome/assets/js/31.6bde0d5c.js"><link rel="prefetch" href="/Welcome/assets/js/32.34f5889a.js"><link rel="prefetch" href="/Welcome/assets/js/33.2ca0ef80.js"><link rel="prefetch" href="/Welcome/assets/js/34.1717fdcc.js"><link rel="prefetch" href="/Welcome/assets/js/35.50467365.js"><link rel="prefetch" href="/Welcome/assets/js/36.386e40d0.js"><link rel="prefetch" href="/Welcome/assets/js/37.4338b548.js"><link rel="prefetch" href="/Welcome/assets/js/38.5aa7ff9c.js"><link rel="prefetch" href="/Welcome/assets/js/39.caf6790b.js"><link rel="prefetch" href="/Welcome/assets/js/4.ffe2048e.js"><link rel="prefetch" href="/Welcome/assets/js/40.2504a486.js"><link rel="prefetch" href="/Welcome/assets/js/41.e7130bc9.js"><link rel="prefetch" href="/Welcome/assets/js/42.f7f7482f.js"><link rel="prefetch" href="/Welcome/assets/js/43.ac1c5fa2.js"><link rel="prefetch" href="/Welcome/assets/js/44.ef3652d5.js"><link rel="prefetch" href="/Welcome/assets/js/45.9b60de4e.js"><link rel="prefetch" href="/Welcome/assets/js/46.df098548.js"><link rel="prefetch" href="/Welcome/assets/js/47.91f84937.js"><link rel="prefetch" href="/Welcome/assets/js/48.4f6c2f9e.js"><link rel="prefetch" href="/Welcome/assets/js/49.b85e5dc1.js"><link rel="prefetch" href="/Welcome/assets/js/5.2488397c.js"><link rel="prefetch" href="/Welcome/assets/js/50.20e79c78.js"><link rel="prefetch" href="/Welcome/assets/js/51.82c31a6c.js"><link rel="prefetch" href="/Welcome/assets/js/52.6508031e.js"><link rel="prefetch" href="/Welcome/assets/js/53.7d686c92.js"><link rel="prefetch" href="/Welcome/assets/js/54.d40bb354.js"><link rel="prefetch" href="/Welcome/assets/js/55.852d6024.js"><link rel="prefetch" href="/Welcome/assets/js/56.37575e79.js"><link rel="prefetch" href="/Welcome/assets/js/57.348d9f72.js"><link rel="prefetch" href="/Welcome/assets/js/58.241f322c.js"><link rel="prefetch" href="/Welcome/assets/js/59.55945236.js"><link rel="prefetch" href="/Welcome/assets/js/6.c8f2a0bc.js"><link rel="prefetch" href="/Welcome/assets/js/60.833eaffc.js"><link rel="prefetch" href="/Welcome/assets/js/61.5c5d0aa8.js"><link rel="prefetch" href="/Welcome/assets/js/62.5d270bfa.js"><link rel="prefetch" href="/Welcome/assets/js/63.07007485.js"><link rel="prefetch" href="/Welcome/assets/js/64.29a4693b.js"><link rel="prefetch" href="/Welcome/assets/js/65.9bdbf700.js"><link rel="prefetch" href="/Welcome/assets/js/66.19c5e075.js"><link rel="prefetch" href="/Welcome/assets/js/67.52c98668.js"><link rel="prefetch" href="/Welcome/assets/js/68.61d9dac4.js"><link rel="prefetch" href="/Welcome/assets/js/69.f4e842e7.js"><link rel="prefetch" href="/Welcome/assets/js/7.72ca8d8f.js"><link rel="prefetch" href="/Welcome/assets/js/70.45749ff8.js"><link rel="prefetch" href="/Welcome/assets/js/71.c9a878d8.js"><link rel="prefetch" href="/Welcome/assets/js/72.f2b5538c.js"><link rel="prefetch" href="/Welcome/assets/js/73.6c759250.js"><link rel="prefetch" href="/Welcome/assets/js/74.c62c6359.js"><link rel="prefetch" href="/Welcome/assets/js/75.99c7f410.js"><link rel="prefetch" href="/Welcome/assets/js/76.2b32b854.js"><link rel="prefetch" href="/Welcome/assets/js/77.40d79900.js"><link rel="prefetch" href="/Welcome/assets/js/78.fb1e2c04.js"><link rel="prefetch" href="/Welcome/assets/js/79.d12ac054.js"><link rel="prefetch" href="/Welcome/assets/js/80.0b012e93.js"><link rel="prefetch" href="/Welcome/assets/js/81.808914ff.js"><link rel="prefetch" href="/Welcome/assets/js/82.9e80a643.js"><link rel="prefetch" href="/Welcome/assets/js/83.2258d338.js"><link rel="prefetch" href="/Welcome/assets/js/84.6f59f24e.js"><link rel="prefetch" href="/Welcome/assets/js/85.30765c19.js"><link rel="prefetch" href="/Welcome/assets/js/86.b78e1547.js"><link rel="prefetch" href="/Welcome/assets/js/87.d19016fa.js"><link rel="prefetch" href="/Welcome/assets/js/9.73227006.js">
    <link rel="stylesheet" href="/Welcome/assets/css/0.styles.dc2e030a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="theme-container" class="theme-container post-container no-sidebar" data-v-60b9a85e><header class="navbar invert" data-v-60b9a85e><a href="/Welcome/" class="home-link router-link-active"><span class="site-name"> $ cd /home/ </span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/Welcome/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg>
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/Welcome/tags/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>
  æ ‡ç­¾ ğŸ·ï¸
</a></div><div class="nav-item"><a href="/Welcome/links/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M305.45 462.59c7.391 7.298 6.188 20.097-3 25.004-77.714 41.802-176.726 29.91-242.344-35.709-65.602-65.603-77.51-164.523-35.692-242.331 4.891-9.095 17.69-10.298 25.003-3l116.812 116.813 27.394-27.394c-.688-2.61-1.594-5.001-1.594-7.814a32.004 32.004 0 1132.004 32.005c-2.797 0-5.204-.891-7.798-1.594l-27.41 27.41zm206.526-159.523a16.103 16.103 0 01-16.002 17.003H463.86a15.97 15.97 0 01-15.892-15.002C440.467 175.549 336.453 70.534 207.03 63.533a15.845 15.845 0 01-15.002-15.908V16.027A16.094 16.094 0 01209.03.024C372.255 8.62 503.475 139.841 511.976 303.067zm-96.012-.297a16.21 16.21 0 01-16.112 17.3h-32.207a16.069 16.069 0 01-15.893-14.705c-6.907-77.011-68.118-138.91-144.924-145.224a15.94 15.94 0 01-14.8-15.893v-32.114a16.134 16.134 0 0117.3-16.096c110.123 8.501 198.228 96.607 206.636 206.732z"/></svg>
  é“¾æ¥ ğŸŒ
</a></div><div class="nav-item"><a href="/Welcome/docs/aboutMe/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path fill="none" d="M0 0h24v24H0z"/><path d="M21 18H6a1 1 0 000 2h15v2H6a3 3 0 01-3-3V4a2 2 0 012-2h16v16zm-5-9V7H8v2h8z"/></svg>
  ä¸¾æ¯ â¤
</a></div> <div class="nav-item"><a class="nav-link ov-parent ov-hover" style="cursor: pointer"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg>
      æœç´¢
    </a></div></nav></div></header> <div class="sidebar-mask" data-v-60b9a85e></div> <aside class="sidebar" data-v-60b9a85e><div class="personal-info-wrapper" data-v-60b9a85e><div class="mobile-hero-avatar" data-v-60b9a85e><img src="/Welcome/img/avatar.jpeg" alt="hero" data-v-60b9a85e></div> <p class="mobile-heading" data-v-60b9a85e>
          æ«å¶å’Œé›ªèŠ±
        </p> <div class="sns-wrapper" data-v-60b9a85e><a href="https://github.com/LuJunandapai" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-59.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg></svg></a><a href="https://www.twitter.com/Lu_isApai" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></svg></a><a href="https://www.facebook.com/" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-139.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"/></svg></svg></a><a href="https://www.linkedin.com/in/" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 01107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg></svg></a><a href="https://www.zhihu.com/people/" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path fill="none" d="M0 0h24v24H0z"/><path d="M12.344 17.963l-1.688 1.074-2.131-3.35c-.44 1.402-1.172 2.665-2.139 3.825-.402.483-.82.918-1.301 1.375-.155.147-.775.717-.878.82l-1.414-1.414c.139-.139.787-.735.915-.856.43-.408.795-.79 1.142-1.206 1.266-1.518 2.03-3.21 2.137-5.231H3v-2h4V7h-.868c-.689 1.266-1.558 2.222-2.618 2.857L2.486 8.143c1.395-.838 2.425-2.604 3.038-5.36l1.952.434c-.14.633-.303 1.227-.489 1.783H11.5v2H9v4h2.5v2H9.185l3.159 4.963zm3.838-.07L17.298 17H19V7h-4v10h.736l.446.893zM13 5h8v14h-3l-2.5 2-1-2H13V5z"/></svg></svg></a><a href="mailto:lu_yuelian@163.com" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg></svg></a>  <a href="/rss.xml" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" width="0" height="0" viewBox="0 0 0 0" fill="currentColor" class="icon-stack ov-icon" style="font-size:1.2em;"><!----> <svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="icon-sns ov-icon ov-inverse" style="font-size:1.2em;"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg></svg></a></div> <hr data-v-60b9a85e></div> <nav class="nav-links"><div class="nav-item"><a href="/Welcome/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg>
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/Welcome/tags/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>
  æ ‡ç­¾ ğŸ·ï¸
</a></div><div class="nav-item"><a href="/Welcome/links/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path d="M305.45 462.59c7.391 7.298 6.188 20.097-3 25.004-77.714 41.802-176.726 29.91-242.344-35.709-65.602-65.603-77.51-164.523-35.692-242.331 4.891-9.095 17.69-10.298 25.003-3l116.812 116.813 27.394-27.394c-.688-2.61-1.594-5.001-1.594-7.814a32.004 32.004 0 1132.004 32.005c-2.797 0-5.204-.891-7.798-1.594l-27.41 27.41zm206.526-159.523a16.103 16.103 0 01-16.002 17.003H463.86a15.97 15.97 0 01-15.892-15.002C440.467 175.549 336.453 70.534 207.03 63.533a15.845 15.845 0 01-15.002-15.908V16.027A16.094 16.094 0 01209.03.024C372.255 8.62 503.475 139.841 511.976 303.067zm-96.012-.297a16.21 16.21 0 01-16.112 17.3h-32.207a16.069 16.069 0 01-15.893-14.705c-6.907-77.011-68.118-138.91-144.924-145.224a15.94 15.94 0 01-14.8-15.893v-32.114a16.134 16.134 0 0117.3-16.096c110.123 8.501 198.228 96.607 206.636 206.732z"/></svg>
  é“¾æ¥ ğŸŒ
</a></div><div class="nav-item"><a href="/Welcome/docs/aboutMe/" class="nav-link ov-parent ov-hover"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path fill="none" d="M0 0h24v24H0z"/><path d="M21 18H6a1 1 0 000 2h15v2H6a3 3 0 01-3-3V4a2 2 0 012-2h16v16zm-5-9V7H8v2h8z"/></svg>
  ä¸¾æ¯ â¤
</a></div> <div class="nav-item"><a class="nav-link ov-parent ov-hover" style="cursor: pointer"><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon ov-wrench ov-hover" style="font-size:1.2em;"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg>
      æœç´¢
    </a></div></nav> <!----> </aside> <div class="content" data-v-60b9a85e><div class="post-header style-img" style="background-image:url(/Welcome/img/in-post/2020-10-29/header.jpg);" data-v-2c97064e><div class="header-mask" style="background:rgba(40, 57, 101, .4);" data-v-2c97064e></div> <div class="header-content" data-v-2c97064e><div class="tags" data-v-2c97064e><span class="tag" data-v-2c97064e>
        Java è¡¥å……
      </span><span class="tag" data-v-2c97064e>
        Spring åŠŸèƒ½
      </span></div> <h1 class="title" data-v-2c97064e>
      Easy Excel è¡¨æ ¼åº“
    </h1> <h3 class="subtitle" data-v-2c97064e>
      EasyExcelæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ã€å¿«é€Ÿã€ç®€æ´ã€è§£å†³å¤§æ–‡ä»¶å†…å­˜æº¢å‡ºçš„Excelå¤„ç†å·¥å…·,
    </h3> <div class="icons" data-v-2c97064e><div class="icon" data-v-2c97064e><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-2c97064e><path d="M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z"/></svg> <span data-v-2c97064e>Lu Da Zhuang</span></div> <div class="icon" data-v-2c97064e><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-2c97064e><path d="M400 64h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54c-3.3 0-6-2.7-6-6V160h352v298c0 3.3-2.7 6-6 6z"/></svg> <span data-v-2c97064e>2022-07-27</span></div> <div class="icon" data-v-2c97064e><svg aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-2c97064e><path fill="none" d="M0 0h24v24H0z"/><path d="M17.618 5.968l1.453-1.453 1.414 1.414-1.453 1.453a9 9 0 11-1.414-1.414zM12 20a7 7 0 100-14 7 7 0 000 14zM11 8h2v6h-2V8zM8 1h8v2H8V1z"/></svg> <span data-v-2c97064e>114 min</span></div></div></div></div> <main class="page"><!----> <div class="theme-content content__default"><blockquote><blockquote><h1 id="easy-excel-è¡¨æ ¼åº“"><a href="#easy-excel-è¡¨æ ¼åº“" class="header-anchor">#</a> Easy Excel è¡¨æ ¼åº“</h1></blockquote></blockquote> <h2 id="easy-excel-åŸºç¡€"><a href="#easy-excel-åŸºç¡€" class="header-anchor">#</a> Easy Excel åŸºç¡€</h2> <h3 id="easy-excel-ä»‹ç»"><a href="#easy-excel-ä»‹ç»" class="header-anchor">#</a> Easy Excel ä»‹ç»</h3> <ul><li><p>Easy Excel å®˜æ–¹æ–‡æ¡£: <a href="https://easyexcel.opensource.alibaba.com/" target="_blank" rel="noopener noreferrer">åœ°å€</a></p></li> <li><p>EasyExcelæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ã€å¿«é€Ÿã€ç®€æ´ã€è§£å†³å¤§æ–‡ä»¶å†…å­˜æº¢å‡ºçš„Excelå¤„ç†å·¥å…·,</p></li> <li><p>ä»–èƒ½è®©ä½ åœ¨ä¸ç”¨è€ƒè™‘æ€§èƒ½ã€å†…å­˜çš„ç­‰å› ç´ çš„æƒ…å†µä¸‹ï¼Œå¿«é€Ÿå®ŒæˆExcelçš„è¯»ã€å†™ç­‰åŠŸèƒ½</p></li></ul> <h3 id="easy-excel-ä¾èµ–"><a href="#easy-excel-ä¾èµ–" class="header-anchor">#</a> Easy Excel ä¾èµ–</h3> <ul><li>ç°åœ¨æ›´æ–°åˆ° 3.x ç‰ˆæœ¬ ä¸€ä¸‹ç¬”è®°ä»¥3.xç‰ˆæœ¬ä¸ºå‡†</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!--Excle 2.2.3 å·¥å…·åº“(alibb)--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>easyexcel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--Excle 3.3.2 å·¥å…·åº“(alibb)--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>easyexcel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="excel-æ³¨è§£"><a href="#excel-æ³¨è§£" class="header-anchor">#</a> Excel æ³¨è§£</h2> <blockquote><p>è¯¦æƒ… Excel æ³¨è§£: <a href="https://blog.csdn.net/weixin_57467236/article/details/126554367" target="_blank" rel="noopener noreferrer">å‚è€ƒåœ°å€</a></p></blockquote> <h3 id="ç±»æ³¨è§£"><a href="#ç±»æ³¨è§£" class="header-anchor">#</a> ç±»æ³¨è§£</h3> <p>åŸºç¡€ç±»æ³¨è§£</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// è¡¨å¤´é«˜åº¦</span>
<span class="token annotation punctuation">@HeadRowHeight</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> 
<span class="token comment">// å†…å®¹è¡Œé«˜åº¦</span>
<span class="token annotation punctuation">@ContentRowHeight</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span> 
<span class="token comment">// åˆ—å®½</span>
<span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> 
<span class="token comment">// è¡¨å¤´æ ·å¼</span>
<span class="token annotation punctuation">@HeadStyle</span><span class="token punctuation">(</span>fillForegroundColor <span class="token operator">=</span> <span class="token number">44</span><span class="token punctuation">)</span> 
</code></pre></div><h3 id="å­—æ®µæ³¨è§£"><a href="#å­—æ®µæ³¨è§£" class="header-anchor">#</a> å­—æ®µæ³¨è§£</h3> <h4 id="excelproperty-å¯¼å‡ºåˆ—"><a href="#excelproperty-å¯¼å‡ºåˆ—" class="header-anchor">#</a> @ExcelProperty å¯¼å‡ºåˆ—</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// @ExcelProperty: å¯¼å‡ºè¯¥å­—æ®µä¸ºä¸€åˆ—</span>
    value<span class="token operator">:</span> æ ‡é¢˜å±æ€§ ä¸ºæ•°ç»„å¯ä¼ å¤šä¸ªæ ‡é¢˜å®ç°å¤æ‚å¤´ ä¾‹<span class="token operator">:</span><span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	index<span class="token operator">:</span> åˆ—å· å¯¼å‡ºæ—¶è¡¨æ ¼åˆ—çš„ä½ç½®
        
<span class="token comment">// è‡ªå¸¦çš„è½¬æ¢ç±»</span>
<span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;å­—ç¬¦ä¸²å›¾ç‰‡è½¬æ¢&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> converter <span class="token operator">=</span> <span class="token class-name">StringImageConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> imageStr<span class="token punctuation">;</span>
   
<span class="token comment">// ç¤ºä¾‹</span>
<span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>
</code></pre></div><h4 id="excelignoreunannotated"><a href="#excelignoreunannotated" class="header-anchor">#</a> @ExcelIgnoreUnannotated</h4> <ul><li>ä½œç”¨äºç±»: è¡¨ç¤ºè¯¥ç±»ä¸‹æœªä½¿ç”¨çš„ @ExcelProperty çš„å­—æ®µä¸è¿›è¡Œå¯¼å‡º</li> <li>å¦‚æœæœªåŠ æ­¤æ³¨è§£ æ‰€æœ‰çš„å­—æ®µéƒ½ä¼šå¯¼å‡º</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;SpuInfo Voå¯¹è±¡&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ExcelIgnoreUnannotated</span> <span class="token comment">// è¡¨ç¤ºè¯¥ç±»ä¸‹æœªä½¿ç”¨çš„ @ExcelProperty çš„å­—æ®µä¸è¿›è¡Œå¯¼å‡º</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpuInfoVo</span> <span class="token keyword">extends</span> <span class="token class-name">SpuInfo</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;åŠŸèƒ½åç§°&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;äº§å“è¡¨æ ¼&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åŠŸèƒ½åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> functionName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»åˆ—åç§°&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;äº§å“è¡¨æ ¼&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç³»åˆ—åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> seriesName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;åˆ›å»ºäºº&quot;</span><span class="token punctuation">)</span> <span class="token comment">// å¦‚æœæœªåŠ æ­¤æ³¨è§£ æ‰€æœ‰çš„å­—æ®µéƒ½ä¼šå¯¼å‡º</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> createUserNmae<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="columnwith"><a href="#columnwith" class="header-anchor">#</a> @ColumnWith</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// è®¾ç½®åˆ—å®½åº¦,åªæœ‰ä¸€ä¸ªå‚æ•°valueï¼Œvalueçš„å•ä½æ˜¯å­—ç¬¦é•¿åº¦ï¼Œæœ€å¤§å¯ä»¥è®¾ç½®255ä¸ªå­—ç¬¦ï¼Œå› ä¸ºä¸€ä¸ªexcelå•å…ƒæ ¼æœ€å¤§å¯ä»¥å†™å…¥çš„å­—ç¬¦ä¸ªæ•°å°±æ˜¯255ä¸ªå­—ç¬¦ã€‚</span>
<span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> imei<span class="token punctuation">;</span>
</code></pre></div><h4 id="excelignore-å¿½ç•¥å¯¼å‡º"><a href="#excelignore-å¿½ç•¥å¯¼å‡º" class="header-anchor">#</a> @ExcelIgnore å¿½ç•¥å¯¼å‡º</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// @ExcelIgnore : å¯¼å‡ºæ—¶å¿½ç•¥è¿™ä¸ªå­—æ®µ</span>

<span class="token annotation punctuation">@ExcelIgnore</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> ignore<span class="token punctuation">;</span>
</code></pre></div><h4 id="datetimeformat-æ—¶é—´è½¬æ¢"><a href="#datetimeformat-æ—¶é—´è½¬æ¢" class="header-anchor">#</a> @DateTimeFormat æ—¶é—´è½¬æ¢</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// @DateTimeFormat : Date æ—¶é—´æ•°æ®ç±»å‹è½¬æ¢</span>

<span class="token comment">/**
* æˆ‘æƒ³å†™åˆ°excel ç”¨å¹´æœˆæ—¥çš„æ ¼å¼ å¯¼å‡º: 2023/8/11 16:15:45
*/</span>
<span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyyå¹´MMæœˆddæ—¥HHæ—¶mmåˆ†ssç§’&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>
</code></pre></div><h4 id="numberformat-åŠ åç¼€å•ä½"><a href="#numberformat-åŠ åç¼€å•ä½" class="header-anchor">#</a> @NumberFormat åŠ åç¼€å•ä½</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// @NumberFormat : Double æ·»åŠ åç¼€å•ä½</span>

<span class="token comment">/**
* æˆ‘æƒ³å†™åˆ°excel ç”¨ç™¾åˆ†æ¯”è¡¨ç¤º å¯¼å‡º: 477%
*/</span>
<span class="token annotation punctuation">@NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;#.##%&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ•°å­—æ ‡é¢˜&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
</code></pre></div><h2 id="vue-å¯¼å…¥ç»„ä»¶"><a href="#vue-å¯¼å…¥ç»„ä»¶" class="header-anchor">#</a> Vue å¯¼å…¥ç»„ä»¶</h2> <p><strong>è¯´æ˜:</strong></p> <ul><li>input -&gt; accept [ç±»å‹ä¸€,ç±»å‹äºŒ ... ] ä¸Šä¼ è¿‡æ»¤ç±»å‹ (ä¸èƒ½å¼ºåˆ¶)</li> <li>xlsx: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</li> <li>xls: application/vnd.ms-excel</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isButton(<span class="token punctuation">'</span>spu.add<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>importExcel()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Upload</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileInput<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span>
       <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>application/vnd.openxmlformats-officedocument.spreadsheetml.sheet<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleFileChange<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¯¼å…¥è¡¨æ ¼</span>
<span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>fileInput<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// ä¸Šä¼ æ–‡ä»¶</span>
<span class="token function">handleFileChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> file <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token comment">// è·å–æ–‡ä»¶åç¼€</span>
  <span class="token keyword">const</span> suffix <span class="token operator">=</span> file<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è·å–æ–‡ä»¶å¤§å°</span>
  <span class="token keyword">const</span> size <span class="token operator">=</span> file<span class="token punctuation">.</span>size<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><blockquote><h1 id="excel-è¯»-å¯¼å…¥æ“ä½œ"><a href="#excel-è¯»-å¯¼å…¥æ“ä½œ" class="header-anchor">#</a> | --&gt; Excel è¯»/å¯¼å…¥æ“ä½œ</h1></blockquote> <h2 id="ajax-è¯·æ±‚å¯¼å…¥"><a href="#ajax-è¯·æ±‚å¯¼å…¥" class="header-anchor">#</a> Ajax è¯·æ±‚å¯¼å…¥</h2> <h3 id="æ ‡å‡†å¯¼å…¥å¯¼å‡ºç»„ä»¶"><a href="#æ ‡å‡†å¯¼å…¥å¯¼å‡ºç»„ä»¶" class="header-anchor">#</a> æ ‡å‡†å¯¼å…¥å¯¼å‡ºç»„ä»¶</h3> <ul><li>accept æŒ‡å®šä¸Šä¼ çª—å£çš„æ–‡ä»¶ç±»å‹ å¯æ”¹éœ€è¦å†ä¸Šä¼ æ–¹æ³•é‡Œè¿›è¡Œå†æ¬¡æ ¡éªŒ</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>importExcel()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Upload</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span> å¯¼å…¥
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileInput<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span>
         <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleFileChange<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>exportExcel()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Download</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span> å¯¼å‡º
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- è¡¨æ ¼é”™è¯¯ä¿¡æ¯ç»„ä»¶ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excel-view</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>excel<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="è¡¨æ ¼é”™è¯¯ä¿¡æ¯ç»„ä»¶"><a href="#è¡¨æ ¼é”™è¯¯ä¿¡æ¯ç»„ä»¶" class="header-anchor">#</a> è¡¨æ ¼é”™è¯¯ä¿¡æ¯ç»„ä»¶</h3> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ExcelView<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 100%</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dialog</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>centerDialogVisible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å¯¼å…¥è¡¨æ ¼é”™è¯¯æç¤º<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>800<span class="token punctuation">&quot;</span></span> <span class="token attr-name">center</span> <span class="token attr-name">:before-close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beforeClose<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">draggable</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tableData<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>350<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stripe</span> <span class="token attr-name">border</span> <span class="token attr-name">fit</span> <span class="token attr-name">highlight-current-row</span> <span class="token attr-name">:empty-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">'</span>common.table.noData<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">fixed</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$t(<span class="token punctuation">'</span>common.table.number<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>80<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mgs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>é”™è¯¯ä¿¡æ¯<span class="token punctuation">&quot;</span></span> <span class="token attr-name">show-overflow-tooltip</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#footer</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialog-footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>closeButton<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å–æ¶ˆ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>copyTxt<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            å¤åˆ¶
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dialog</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'ExcelView'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      centerDialogVisible<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      spanList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      tableData<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// é¡µé¢åŠ è½½ä¼šæ‰§è¡Œæ­¤æ–¹æ³•è¿›è¡Œå›¾è¡¨æ•°æ®èµ‹å€¼åˆå§‹åŒ–æ˜¾ç¤º</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">setTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>spanList<span class="token punctuation">,</span> <span class="token string">'spanList'</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>spanList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>tableData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          mgs<span class="token operator">:</span> item<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">beforeClose</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">closeButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»è°ƒç”¨ doneï¼Œä»¥ç»§ç»­å…³é—­å¯¹è¯æ¡†</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">closeButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>centerDialogVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>spanList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>tableData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">copyTxt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> txt <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>spanList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        txt <span class="token operator">+=</span> item <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      input<span class="token punctuation">.</span>value <span class="token operator">=</span> txt<span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
      input<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'Copy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>message<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'common.message.copySuccess'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- ç»„ä»¶æ ·å¼ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token comment">/*å›¾è¡¨çš„æ ·å¼*/</span>
<span class="token selector">#ExcelView</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="å¯¼å…¥å¯¼å‡ºæ–¹æ³•"><a href="#å¯¼å…¥å¯¼å‡ºæ–¹æ³•" class="header-anchor">#</a> å¯¼å…¥å¯¼å‡ºæ–¹æ³•</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¯¼å‡ºè¡¨æ ¼</span>
<span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¯¼å‡ºè¡¨æ ¼ å‘èµ·è¯·æ±‚</span>
  <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fromData<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// å¯¼å…¥è¡¨æ ¼</span>
<span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>fileInput<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// é‡ç½®æ–‡ä»¶è¾“å…¥æ¡†çš„å€¼ å¦åˆ™åŒä¸€ä¸ªæ–‡ä»¶ä¸ä¼šè§¦å‘changeäº‹ä»¶</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>fileInput<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è§¦å‘ç‚¹å‡»äº‹ä»¶</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// ä¸Šä¼ æ–‡ä»¶</span>
<span class="token function">handleFileChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> file <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'è¯·é€‰æ‹©æ–‡ä»¶!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶ä¿¡æ¯ï¼š'</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span>
  <span class="token comment">// è·å–æ–‡ä»¶åç¼€</span>
  <span class="token keyword">const</span> suffix <span class="token operator">=</span> file<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>suffix <span class="token operator">!==</span> <span class="token string">'xlsx'</span> <span class="token operator">&amp;&amp;</span> suffix <span class="token operator">!==</span> <span class="token string">'xls'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·ä¸Šä¼ Excelæ–‡ä»¶!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è·å–æ–‡ä»¶å¤§å°</span>
  <span class="token keyword">const</span> size <span class="token operator">=</span> file<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶å¤§å°ï¼š'</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span>
  <span class="token comment">// è¡¨æ ¼å¯¼å…¥</span>
  <span class="token function">importExcel</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'res'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">ElNotification</span><span class="token punctuation">(</span><span class="token punctuation">{</span>title<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'common.message.successTitle'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">listData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">201</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>centerDialogVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>spanList <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>excel<span class="token punctuation">.</span><span class="token function">setTableData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="å‘èµ·è¡¨æ ¼è¯·æ±‚"><a href="#å‘èµ·è¡¨æ ¼è¯·æ±‚" class="header-anchor">#</a> å‘èµ·è¡¨æ ¼è¯·æ±‚</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¯¼å‡ºè¡¨æ ¼ - å¯¼å‡ºExcel</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">'/api/spuInfo/exportExcel'</span><span class="token punctuation">,</span>
        method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// å°†æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²</span>
        headers<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span> <span class="token comment">// æŒ‡å®šå†…å®¹ç±»å‹ä¸º JSON</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        responseType<span class="token operator">:</span> <span class="token string">'blob'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯¼å‡ºExcel</span>
        <span class="token function">setExportExcel</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'äº§å“ä¿¡æ¯-'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¯¼å…¥è¡¨æ ¼ - å¯¼å…¥Excel</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">'/api/spuInfo/importExcel'</span><span class="token punctuation">,</span>
        method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> formData<span class="token punctuation">,</span>
        headers<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'multipart/form-data'</span> <span class="token comment">// è®¾ç½®è¯·æ±‚å¤´ä¸ºmultipart/form-data</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ----------- å·¥å…·ç±» -------------</span>
<span class="token comment">/**
 * é€šè¿‡è¡¨æ ¼æµæ•°æ®å¹¶å¯¼å‡ºExcel
 * @param res è¯·æ±‚å“åº”çš„æ–‡ä»¶æµ
 * @param name æ–‡ä»¶åå‰ç¼€
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setExportExcel</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ–‡ä»¶åå‰ç¼€ + æ—¶é—´æˆ³ + æ–‡ä»¶åç¼€</span>
    <span class="token keyword">let</span> suffix <span class="token operator">=</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-disposition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> fileName <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> suffix<span class="token punctuation">;</span>
    <span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">&quot;application/vnd.ms-excel;charset=UTF-8&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>navigator <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>msSaveOrOpenBlob<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// IE</span>
        window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">msSaveOrOpenBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> objectUrl <span class="token operator">=</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitURL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
        <span class="token keyword">let</span> downFile <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
        downFile<span class="token punctuation">.</span>href <span class="token operator">=</span> objectUrl
        downFile<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName <span class="token comment">// ä¸‹è½½åæ–‡ä»¶å</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span> <span class="token comment">// ä¸‹è½½å®Œæˆç§»é™¤å…ƒç´ </span>
        window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>objectUrl<span class="token punctuation">)</span>   <span class="token comment">// åªè¦æ˜ å°„å­˜åœ¨ï¼ŒBlobå°±ä¸èƒ½è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå› æ­¤ä¸€æ—¦ä¸å†éœ€è¦å¼•ç”¨ï¼Œå°±å¿…é¡»å°å¿ƒæ’¤é”€URLï¼Œé‡Šæ”¾æ‰blobå¯¹è±¡ã€‚</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * é€šè¿‡æ–‡ä»¶æµä¸‹è½½æ–‡ä»¶
 * @param res è¯·æ±‚å“åº”çš„æ–‡ä»¶æµ
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setDownloadFile</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ—¶é—´æˆ³ + æ–‡ä»¶åç¼€</span>
    <span class="token keyword">let</span> suffix <span class="token operator">=</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-disposition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> fileName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> suffix<span class="token punctuation">;</span>
    <span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">&quot;application/octet-stream&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>navigator <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>msSaveOrOpenBlob<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// IE</span>
        window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">msSaveOrOpenBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> objectUrl <span class="token operator">=</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitURL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
        <span class="token keyword">let</span> downFile <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
        downFile<span class="token punctuation">.</span>href <span class="token operator">=</span> objectUrl
        downFile<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName <span class="token comment">// ä¸‹è½½åæ–‡ä»¶å</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span> <span class="token comment">// ä¸‹è½½å®Œæˆç§»é™¤å…ƒç´ </span>
        window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>objectUrl<span class="token punctuation">)</span>   <span class="token comment">// åªè¦æ˜ å°„å­˜åœ¨ï¼ŒBlobå°±ä¸èƒ½è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå› æ­¤ä¸€æ—¦ä¸å†éœ€è¦å¼•ç”¨ï¼Œå°±å¿…é¡»å°å¿ƒæ’¤é”€URLï¼Œé‡Šæ”¾æ‰blobå¯¹è±¡ã€‚</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ajax-æ‹¦æˆªå™¨"><a href="#ajax-æ‹¦æˆªå™¨" class="header-anchor">#</a> ajax æ‹¦æˆªå™¨</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¯·æ±‚å“åº”æ‹¦æˆªå™¨</span>
service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
    <span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// å“åº”ä¸º ä¸‹è½½è¡¨æ ¼ / ä¸‹è½½æ–‡ä»¶ - ç›´æ¥è¿”å›</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'application/vnd.ms-excel;charset=utf-8'</span>
            <span class="token operator">||</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'application/octet-stream'</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> response<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å“åº”åå¤„ç†</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> response<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">201</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è¡¨æ ¼å¯¼å…¥å¼‚å¸¸ è¿›è¡Œæ”¾è¡Œ</span>
            <span class="token keyword">return</span> response<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">2002</span> <span class="token operator">||</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">502</span> <span class="token operator">||</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">2011</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ˜¾ç¤ºæç¤ºæ¶ˆæ¯</span>
            <span class="token comment">// ElMessage({message: response.data.msg, type: 'warning',});</span>
            <span class="token function">ElNotification</span><span class="token punctuation">(</span><span class="token punctuation">{</span>title<span class="token operator">:</span> i18n<span class="token punctuation">.</span>global<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'common.dialog.title'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token operator">:</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'warning'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token comment">// æ¸…é™¤ token</span>
            window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è·³è½¬åˆ°ç™»å½•é¡µé¢</span>
            router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è¿”å›ä¸€ä¸ªå¸¦æœ‰é”™è¯¯ä¿¡æ¯çš„Promiseï¼Œä»¥é˜»æ­¢è¿›ä¸€æ­¥çš„é“¾å¼è°ƒç”¨</span>
            <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// æ”¾è¡Œï¼ˆä¸åšä»»ä½•å¤„ç†ï¼‰</span>
            <span class="token keyword">return</span> response<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">ElNotification</span><span class="token punctuation">(</span><span class="token punctuation">{</span>title<span class="token operator">:</span> i18n<span class="token punctuation">.</span>global<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'common.dialog.title'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token operator">:</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> err <span class="token operator">=</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token keyword">let</span> mgs <span class="token operator">=</span> err<span class="token punctuation">.</span>path <span class="token operator">+</span> <span class="token string">'('</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>status <span class="token operator">+</span> <span class="token string">'): '</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">;</span>
        <span class="token function">ElNotification</span><span class="token punctuation">(</span><span class="token punctuation">{</span>title<span class="token operator">:</span> i18n<span class="token punctuation">.</span>global<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'common.dialog.title'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token operator">:</span> err<span class="token punctuation">.</span>message<span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="è¡¨ç°å±‚"><a href="#è¡¨ç°å±‚" class="header-anchor">#</a> è¡¨ç°å±‚</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºè¡¨æ ¼&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;exportExcel&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SpuInfoVo</span> spuInfoVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    spuInfoService<span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> spuInfoVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å…¥Excelè¡¨æ ¼&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/importExcel&quot;</span><span class="token punctuation">,</span> consumes <span class="token operator">=</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span>MULTIPART_FORM_DATA_VALUE<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">importExcelIsSheet</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> spuInfoService<span class="token punctuation">.</span><span class="token function">importExcelIsSheet</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä¸šåŠ¡å±‚"><a href="#ä¸šåŠ¡å±‚" class="header-anchor">#</a> ä¸šåŠ¡å±‚</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">SpuInfoVo</span> spuInfoVo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;äº§å“è¡¨æ ¼&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuInfoVo</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">listSpuInfo</span><span class="token punctuation">(</span><span class="token function">getRequestHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spuInfoVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FreezeAndFilter</span> freezeAndFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FreezeAndFilter</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;A3:H3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> list<span class="token punctuation">,</span> <span class="token class-name">SpuInfoVo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet&quot;</span><span class="token punctuation">,</span> freezeAndFilter<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">WsException</span><span class="token punctuation">(</span><span class="token function">getRespLanguage</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">importExcelIsSheet</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">SpuExcelUtils</span> spuExcelUtils <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuExcelUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ResponseResult</span> responseResult <span class="token operator">=</span> spuExcelUtils<span class="token punctuation">.</span><span class="token function">addExcelData</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> responseResult<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å…¥æ–¹æ³•ç±»"><a href="#å¯¼å…¥æ–¹æ³•ç±»" class="header-anchor">#</a> å¯¼å…¥æ–¹æ³•ç±»</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>excel</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>collection<span class="token punctuation">.</span></span><span class="token class-name">CollUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>date<span class="token punctuation">.</span></span><span class="token class-name">DateUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">EasyExcel</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">ExcelReader</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>read<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span></span><span class="token class-name">ReadSheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ListUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSON<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryWrapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">SpuInfo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">FunctionMapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">SeriesMapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">SpuInfoMapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">OrderNumberUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">RedisUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">SpringContextUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>exception<span class="token punctuation">.</span></span><span class="token class-name">ExcelException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>exception<span class="token punctuation">.</span></span><span class="token class-name">WsException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>resp<span class="token punctuation">.</span></span><span class="token class-name">ResponseResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">FunctionVo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">SeriesVo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">SpuInfoVo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart<span class="token punctuation">.</span></span><span class="token class-name">MultipartFile</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">MyUtils</span><span class="token punctuation">.</span>getRespLanguage<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpuExcelUtils</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * æ¯éš”5æ¡å­˜å‚¨æ•°æ®åº“ï¼Œå®é™…ä½¿ç”¨ä¸­å¯ä»¥100æ¡ï¼Œç„¶åæ¸…ç†list ï¼Œæ–¹ä¾¿å†…å­˜å›æ”¶
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> BATCH_COUNT <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * ç¼“å­˜çš„æ•°æ®ç”¨æˆ·æ·»åŠ  è¾¾åˆ°BATCH_COUNTï¼Œéœ€è¦æ¸…ç†ä¸€æ¬¡
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuInfoVo</span><span class="token punctuation">&gt;</span></span> cachedDataList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayListWithExpectedSize</span><span class="token punctuation">(</span>BATCH_COUNT<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ------------- ä»¥ä¸‹ä¸ºExcelå¯¼å…¥çš„æ•°æ®æ ¡éªŒ -------------</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> functionMap<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> seriesMap<span class="token punctuation">;</span>

    <span class="token comment">// æŸ¥é‡æ ¡éªŒ</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> spuList<span class="token punctuation">;</span>
    <span class="token comment">// å‚¨å­˜æ•°æ®</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SpuInfoVo</span> spuInfoVo<span class="token punctuation">;</span>
    <span class="token comment">// é”™è¯¯ä¿¡æ¯</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> mgsList<span class="token punctuation">;</span>

    <span class="token comment">// ------------- ä»¥ä¸‹ä¸ºExcelæ ¡éªŒæ•°æ®è·å– -------------</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">getFunctionMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        functionMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FunctionMapper</span> bean <span class="token operator">=</span> <span class="token class-name">SpringContextUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">FunctionMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">listFunction</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FunctionVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>functionVo <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            functionMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>functionVo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> functionVo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            functionMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>functionVo<span class="token punctuation">.</span><span class="token function">getNameEn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> functionVo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">getSeriesMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        seriesMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SeriesMapper</span> bean <span class="token operator">=</span> <span class="token class-name">SpringContextUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">SeriesMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bean<span class="token punctuation">.</span><span class="token function">listSeries</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SeriesVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>seriesVo <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            seriesMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>seriesVo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> seriesVo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            seriesMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>seriesVo<span class="token punctuation">.</span><span class="token function">getNameEn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> seriesVo<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">getSpuList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        spuList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SpuInfoMapper</span> baseMapper <span class="token operator">=</span> <span class="token class-name">SpringContextUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuInfo</span><span class="token punctuation">&gt;</span></span> where <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        where<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SpuInfo</span><span class="token punctuation">&gt;</span></span> spuInfos <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span><span class="token punctuation">;</span>
        spuInfos<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>spuInfo <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            spuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>spuInfo<span class="token punctuation">.</span><span class="token function">getSpuName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            spuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>spuInfo<span class="token punctuation">.</span><span class="token function">getNameEn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ------------- ä»¥ä¸‹ä¸ºExcelå¯¼å…¥æ•°æ® -------------</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">addExcelData</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpuInfoMapper</span> baseMapper <span class="token operator">=</span> <span class="token class-name">SpringContextUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getFunctionMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getSeriesMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getSpuList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mgsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ†åˆ«è¯»å–å…¨éƒ¨sheet</span>
            <span class="token class-name">ExcelReader</span> reader <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReadSheet</span><span class="token punctuation">&gt;</span></span> sheets <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">excelExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// éå†sheet</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sheets<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// ä¾æ¬¡è·å–sheetåŠå®ƒçš„ç¬¬ä¸‰è¡Œä»¥ä¸‹çš„æ•°æ®</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> sheetList <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">headRowNumber</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doReadSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sheetList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// åœ¨è¿‡æ»¤åè½¬åŒ–JSONæ—¶å¦‚æœå•å…ƒæ ¼å†…å®¹å­˜åœ¨ç‰¹æ®Šå­—ç¬¦ä¼šå‡ºç°è½¬åŒ–å¼‚å¸¸æŠ¥é”™</span>
                    <span class="token comment">// String mapStr = sheetList.get(j).toString().replaceAll(&quot;([^:\\{\\},]+)&quot;, &quot;$1\&quot;&quot;).replace(&quot;=&quot;, &quot;:\&quot;&quot;);</span>
                    <span class="token comment">// Map&lt;Integer, String&gt; resultMap = JSON.parseObject(mapStr, Map.class);</span>
                    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> resultMap <span class="token operator">=</span> <span class="token function">parseStringToMap</span><span class="token punctuation">(</span>sheetList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>spuList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        mgsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ç¬¬ &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; çš„äº§å“ä¸­æ–‡åç§°å·²å­˜åœ¨!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>spuList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        mgsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ç¬¬ &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; çš„äº§å“è‹±æ–‡åç§°å·²å­˜åœ¨!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>functionMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        mgsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ç¬¬ &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; çš„äº§å“åŠŸèƒ½ä¸å­˜åœ¨!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>seriesMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        mgsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ç¬¬ &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; çš„äº§å“ç³»åˆ—ä¸å­˜åœ¨!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">// å½“å­˜åœ¨æ ¡éªŒé”™è¯¯æ˜¯å°±ä¸åœ¨æ–°å¢å…¥æ•°æ®åº“</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>mgsList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">continue</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    spuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpuInfoVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setSpuCode</span><span class="token punctuation">(</span><span class="token class-name">OrderNumberUtils</span><span class="token punctuation">.</span><span class="token function">createSerialNumber</span><span class="token punctuation">(</span>baseMapper<span class="token punctuation">,</span> <span class="token string">&quot;SPU-&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setCreateUser</span><span class="token punctuation">(</span><span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setEnable</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setSpuName</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setNameEn</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setFunction</span><span class="token punctuation">(</span>functionMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setSeries</span><span class="token punctuation">(</span>seriesMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setSpecs</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setRemarks</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    spuInfoVo<span class="token punctuation">.</span><span class="token function">setRemarksEn</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cachedDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>spuInfoVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// è¾¾åˆ°BATCH_COUNTäº†ï¼Œéœ€è¦å»å­˜å‚¨ä¸€æ¬¡æ•°æ®åº“ï¼Œé˜²æ­¢æ•°æ®å‡ ä¸‡æ¡æ•°æ®åœ¨å†…å­˜ï¼Œå®¹æ˜“OOM</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedDataList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> BATCH_COUNT<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">// è°ƒç”¨æ–¹æ³•ä¿å­˜æ•°æ®</span>
                        <span class="token function">saveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// å­˜å‚¨å®Œæˆæ¸…ç† list</span>
                        cachedDataList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayListWithExpectedSize</span><span class="token punctuation">(</span>BATCH_COUNT<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">continue</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">// éå†æœ€åä¸€æ¡æ•°æ®æ—¶ï¼Œä¿å­˜æ•°æ® é˜²æ­¢æ¼æ‰</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> sheetList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">saveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// è¯·æ±‚å“åº”è¿”å› </span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>mgsList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// å­˜åœ¨æ ¡éªŒé”™è¯¯éœ€è¦æŠ›å‡ºå¼‚å¸¸ è¿›è¡Œæ•°æ®åº“äº‹åŠ¡å›æ»š </span>
                <span class="token comment">// è¡¨æ ¼å¯¼å…¥å¼‚å¸¸ å…¨å±€æ•æ‰åˆ°è¿›è¡Œä½¿ç”¨ ResponseResult è¿”å›</span>
                <span class="token comment">// å‰ç«¯ ajax æ‹¦æˆªå™¨å¿…é¡»æ”¾è¡Œ åœ¨è¯·æ±‚é€šè¿‡åˆ¤æ–­çŠ¶æ€ç è¿›è¡Œè¡¨æ ¼æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ExcelException</span><span class="token punctuation">(</span>mgsList<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token function">getRespLanguage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">WsException</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å…¥å¤±è´¥, è¯·ç¨åé‡è¯•!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">saveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpuInfoMapper</span> baseMapper <span class="token operator">=</span> <span class="token class-name">SpringContextUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">SpuInfoMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;{}æ¡æ•°æ®ï¼Œå¼€å§‹å­˜å‚¨æ•°æ®åº“ï¼&quot;</span><span class="token punctuation">,</span> cachedDataList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨ä¸šåŠ¡å±‚çš„æ–¹æ³•ä¿å­˜æ•°æ®</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>cachedDataList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             baseMapper<span class="token punctuation">.</span><span class="token function">batchSaveSpuInfo</span><span class="token punctuation">(</span>cachedDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å­˜å‚¨æ•°æ®åº“æˆåŠŸï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * å°†è¡¨æ ¼è¡Œæ•°æ®è½¬åŒ–ä¸ºMap&lt;å•å…ƒæ ¼åºå·0å¼€å§‹, å•å…ƒæ ¼å†…å®¹&gt;
     * @param text å•å…ƒæ ¼å†…å®¹(å¯è¿‡æ»¤æ‰ç‰¹æ®Šå­—ç¬¦ä¸²)
     * @return Map&lt;å•å…ƒæ ¼åºå·0å¼€å§‹, å•å…ƒæ ¼å†…å®¹&gt;
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">parseStringToMap</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ¨¡å¼</span>
        <span class="token class-name">Pattern</span> pattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">&quot;(\\d+)=([^,]+)(?:, |$)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Matcher</span> matcher <span class="token operator">=</span> pattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼Œå¹¶å°†åŒ¹é…ç»“æœæ”¾å…¥mapä¸­</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>matcher<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Integer</span> key <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>matcher<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> value <span class="token operator">=</span> matcher<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="è¡¨æ ¼å¯¼å…¥å¼‚å¸¸ç±»"><a href="#è¡¨æ ¼å¯¼å…¥å¼‚å¸¸ç±»" class="header-anchor">#</a> è¡¨æ ¼å¯¼å…¥å¼‚å¸¸ç±»</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @Description: è‡ªå®šä¹‰å¼‚å¸¸
 **/</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExcelException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>


    <span class="token comment">/**
     * å¼‚å¸¸ä¿¡æ¯
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> msgList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å…¨å±€è¡¨æ ¼å¼‚å¸¸æ•æ‰"><a href="#å…¨å±€è¡¨æ ¼å¼‚å¸¸æ•æ‰" class="header-anchor">#</a> å…¨å±€è¡¨æ ¼å¼‚å¸¸æ•æ‰</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>exception<span class="token punctuation">.</span></span><span class="token class-name">WsException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>kaiyun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>resp<span class="token punctuation">.</span></span><span class="token class-name">ResponseResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExceptionHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestControllerAdvice</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionAdvice</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * å¤„ç†è‡ªå®šä¹‰å¼‚å¸¸
     * @param e
     * @return
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">WsException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">WsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å¤„ç†Excelå¯¼å…¥å¼‚å¸¸
     * @param e
     * @return
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">ExcelException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">handleExcelException</span><span class="token punctuation">(</span><span class="token class-name">ExcelException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMsgList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="åŸºæœ¬å¯¼å…¥"><a href="#åŸºæœ¬å¯¼å…¥" class="header-anchor">#</a> åŸºæœ¬å¯¼å…¥</h2> <h3 id="ç®€è¿°"><a href="#ç®€è¿°" class="header-anchor">#</a> ç®€è¿°</h3> <ul><li>åŸºæœ¬å¯¼å…¥å‚è€ƒåœ°å€: <a href="https://blog.csdn.net/SGFSFGFF/article/details/124146014" target="_blank" rel="noopener noreferrer">åœ°å€</a></li> <li>å¯¼å…¥æ˜¯æ ¹æ® å®ä½“ç±»å­—æ®µ <strong>@ExcelProperty(value = &quot;å‡ºèº«å¹´æœˆæ—¥&quot;, index = 4)</strong> çš„valueå¯¹åº”çš„è¯»å–</li> <li>å¯¼å…¥åˆå§‹è¡Œæ•°ä¸ºç¬¬äºŒè¡Œéœ€ç‰¹åˆ«æ³¨æ„å¯¼å…¥æ¨¡æ¿çš„æ ‡é¢˜</li></ul> <h3 id="å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹"><a href="#å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹" class="header-anchor">#</a> å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</h3> <table><thead><tr><th>å§“å</th> <th>å¹´é¾„</th> <th>æ€§åˆ«</th> <th>æ‰‹æœºå·</th> <th>å‡ºèº«å¹´æœˆæ—¥</th></tr></thead> <tbody><tr><td>å°æ</td> <td>23</td> <td>ç”·</td> <td>11245788547</td> <td>2000/12/12</td></tr> <tr><td>å°ç½‘</td> <td>24</td> <td>å¥³</td> <td>13875498623</td> <td>1999/12/13</td></tr> <tr><td>å°é—®</td> <td>25</td> <td>å¥³</td> <td>17745788549</td> <td>1998/12/14</td></tr> <tr><td>å°ç ´</td> <td>26</td> <td>ç”·</td> <td>11551788550</td> <td>1997/12/15</td></tr> <tr><td>å°è¯•è¯•</td> <td>27</td> <td>å¥³</td> <td>17882133311</td> <td>1996/12/16</td></tr> <tr><td>å°å±€</td> <td>28</td> <td>ç”·</td> <td>18787854552</td> <td>1995/12/17</td></tr> <tr><td>å°å§”</td> <td>29</td> <td>å¥³</td> <td>17954588553</td> <td>1994/12/18</td></tr></tbody></table> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230814154424575.png" alt="image-20230814154424575"></p> <h3 id="å¯¼å…¥ä»£ç ç¤ºä¾‹"><a href="#å¯¼å…¥ä»£ç ç¤ºä¾‹" class="header-anchor">#</a> å¯¼å…¥ä»£ç ç¤ºä¾‹</h3> <h4 id="å®ä½“ç±»"><a href="#å®ä½“ç±»" class="header-anchor">#</a> å®ä½“ç±»</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">ImportVo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExcelProperty</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb<span class="token punctuation">.</span></span><span class="token class-name">CustomStringStringConverter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span> <span class="token comment">// é‡å†™equalså’Œhashcodeæ–¹æ³•</span>
<span class="token annotation punctuation">@NoArgsConstructor</span> <span class="token comment">// æ— å‚æ„é€ æ–¹æ³•</span>
<span class="token annotation punctuation">@AllArgsConstructor</span> <span class="token comment">// å…¨å‚æ„æ„é€ æ–¹æ³•</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserMessage</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;å§“å&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;å¹´é¾„&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ€§åˆ«&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ‰‹æœºå·&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> phone<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;å‡ºèº«å¹´æœˆæ—¥&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> birthday<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="å¯¼å…¥ç›‘å¬å™¨"><a href="#å¯¼å…¥ç›‘å¬å™¨" class="header-anchor">#</a> å¯¼å…¥ç›‘å¬å™¨</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb<span class="token punctuation">.</span></span><span class="token class-name">ImportGj</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">AnalysisContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>read<span class="token punctuation">.</span>listener<span class="token punctuation">.</span></span><span class="token class-name">ReadListener</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ListUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSON<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">ImportVo<span class="token punctuation">.</span>UserMessage</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ExecelTestService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * æœ‰ä¸ªå¾ˆé‡è¦çš„ç‚¹ DemoDataListener ä¸èƒ½è¢«springç®¡ç†ï¼Œè¦æ¯æ¬¡è¯»å–exceléƒ½è¦new,ç„¶åé‡Œé¢ç”¨åˆ°springå¯ä»¥æ„é€ æ–¹æ³•ä¼ è¿›å»
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoDataListener</span> <span class="token keyword">implements</span> <span class="token class-name">ReadListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMessage</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * æ¯éš”5æ¡å­˜å‚¨æ•°æ®åº“ï¼Œå®é™…ä½¿ç”¨ä¸­å¯ä»¥100æ¡ï¼Œç„¶åæ¸…ç†list ï¼Œæ–¹ä¾¿å†…å­˜å›æ”¶
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> BATCH_COUNT <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * ç¼“å­˜çš„æ•°æ®ç”¨æˆ·æ·»åŠ  è¾¾åˆ°BATCH_COUNTï¼Œéœ€è¦æ¸…ç†ä¸€æ¬¡
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMessage</span><span class="token punctuation">&gt;</span></span> cachedDataList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayListWithExpectedSize</span><span class="token punctuation">(</span>BATCH_COUNT<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * ä¸šåŠ¡å±‚å¯¹è±¡, éœ€è¦è°ƒç”¨ç›‘å¬å™¨ä¼ å…¥, ç”¨äºè°ƒç”¨æ–¹æ³•ä¿å­˜æ•°æ®
     * å‡è®¾è¿™ä¸ªæ˜¯ä¸€ä¸ªDAOï¼Œå½“ç„¶æœ‰ä¸šåŠ¡é€»è¾‘è¿™ä¸ªä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªserviceã€‚å½“ç„¶å¦‚æœä¸ç”¨å­˜å‚¨è¿™ä¸ªå¯¹è±¡æ²¡ç”¨ã€‚
     * å¦‚æœä½¿ç”¨äº†spring,è¯·ä½¿ç”¨è¿™ä¸ªæ„é€ æ–¹æ³•ã€‚æ¯æ¬¡åˆ›å»ºListenerçš„æ—¶å€™éœ€è¦æŠŠspringç®¡ç†çš„ç±»ä¼ è¿›æ¥
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">ExecelTestService</span> execelTestService<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">DemoDataListener</span><span class="token punctuation">(</span><span class="token class-name">ExecelTestService</span> execelTestService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>execelTestService <span class="token operator">=</span> execelTestService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * è¿™ä¸ªæ¯ä¸€æ¡æ•°æ®è§£æéƒ½ä¼šæ¥è°ƒç”¨
     * @param data å½“å‰è§£æåˆ°çš„æ•°æ®
     * @param context å†…å®¹
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">UserMessage</span> data<span class="token punctuation">,</span> <span class="token class-name">AnalysisContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è§£æåˆ°ä¸€æ¡æ•°æ®:{}&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†è§£æåˆ°çš„æ•°æ®å­˜å‚¨åˆ°listé›†åˆä¸­</span>
        cachedDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¾¾åˆ°BATCH_COUNTäº†ï¼Œéœ€è¦å»å­˜å‚¨ä¸€æ¬¡æ•°æ®åº“ï¼Œé˜²æ­¢æ•°æ®å‡ ä¸‡æ¡æ•°æ®åœ¨å†…å­˜ï¼Œå®¹æ˜“OOM</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedDataList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> BATCH_COUNT<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è°ƒç”¨æ–¹æ³•ä¿å­˜æ•°æ®</span>
            <span class="token function">saveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å­˜å‚¨å®Œæˆæ¸…ç† list</span>
            cachedDataList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayListWithExpectedSize</span><span class="token punctuation">(</span>BATCH_COUNT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ‰€æœ‰æ•°æ®è§£æå®Œæˆäº† éƒ½ä¼šæ¥è°ƒç”¨
     * @param context
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doAfterAllAnalysed</span><span class="token punctuation">(</span><span class="token class-name">AnalysisContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿™é‡Œä¹Ÿè¦ä¿å­˜æ•°æ®ï¼Œç¡®ä¿æœ€åé—ç•™çš„æ•°æ®ä¹Ÿå­˜å‚¨åˆ°æ•°æ®åº“</span>
        <span class="token function">saveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * åŠ ä¸Šå­˜å‚¨æ•°æ®åº“
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">saveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;{}æ¡æ•°æ®ï¼Œå¼€å§‹å­˜å‚¨æ•°æ®åº“ï¼&quot;</span><span class="token punctuation">,</span> cachedDataList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨ä¸šåŠ¡å±‚çš„æ–¹æ³•ä¿å­˜æ•°æ®</span>
        execelTestService<span class="token punctuation">.</span><span class="token function">saveExecls</span><span class="token punctuation">(</span>cachedDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å­˜å‚¨æ•°æ®åº“æˆåŠŸï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="è¡¨ç°å±‚-2"><a href="#è¡¨ç°å±‚-2" class="header-anchor">#</a> è¡¨ç°å±‚</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/importExcel&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> importExcelController <span class="token punctuation">{</span>
    
    <span class="token comment">/**
     * ä¸šåŠ¡å±‚å¯¹è±¡
     */</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">ExecelTestService</span> execelTestService<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;åŸºç¡€å¯¼å…¥Excel&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/importExcel&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
        <span class="token comment">// .headRowNumber(2) è®¾ç½®å¤šè¡Œå¤´è¡¨ç¤ºå¤´æœ‰ä¸¤è¡Œä»ç¬¬ä¸‰è¡Œå¼€å§‹è¯»å–</span>
        <span class="token comment">// EasyExcel.read(file.getInputStream(), UserMessage.class, new DemoDataListener(execelTestService)).headRowNumber(2).sheet().doRead();</span>
        <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UserMessage</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DemoDataListener</span><span class="token punctuation">(</span>execelTestService<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="ä¸šåŠ¡å±‚-2"><a href="#ä¸šåŠ¡å±‚-2" class="header-anchor">#</a> ä¸šåŠ¡å±‚</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ExecelTestService</span> <span class="token keyword">extends</span> <span class="token class-name">IService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExecelTest</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token comment">// å¯¼å…¥æ·»åŠ </span>
    <span class="token keyword">void</span> <span class="token function">saveExecls</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMessage</span><span class="token punctuation">&gt;</span></span> cachedDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExecelTestServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExecelTestMapper</span><span class="token punctuation">,</span> <span class="token class-name">ExecelTest</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ExecelTestService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ExecelTestMapper</span> execelTestMapper<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveExecls</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMessage</span><span class="token punctuation">&gt;</span></span> userMessageList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¿›å…¥äº†serviceå±‚....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userMessageList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰§è¡Œå®Œæ¯•....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å¯¼å…¥æµ‹è¯•ç»“æœ"><a href="#å¯¼å…¥æµ‹è¯•ç»“æœ" class="header-anchor">#</a> å¯¼å…¥æµ‹è¯•ç»“æœ</h4> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230814155900165.png" alt="image-20230814155900165"></p> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230814154745757.png" alt="image-20230814154745757"></p> <h2 id="ä¸€æ¬¡è¯»å–å…¨éƒ¨-sheet"><a href="#ä¸€æ¬¡è¯»å–å…¨éƒ¨-sheet" class="header-anchor">#</a> ä¸€æ¬¡è¯»å–å…¨éƒ¨ Sheet</h2> <h3 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <ul><li>æ‰€éœ€çš„ <strong>å¯¼å…¥ç›‘å¬å™¨å’Œå®ä½“ç±» ä¸ åŸºæœ¬å¯¼å…¥</strong> ä¸€è‡´</li> <li>æ³¨æ„ DemoDataListenerçš„doAfterAllAnalysed ä¼šåœ¨æ¯ä¸ªsheetè¯»å–å®Œæ¯•åè°ƒç”¨ä¸€æ¬¡ã€‚ç„¶åæ‰€æœ‰sheetéƒ½ä¼šå¾€åŒä¸€ä¸ªDemoDataListeneré‡Œé¢å†™</li> <li>ä¼šé€ æˆæ•°æ®é‡å¤ï¼Œéœ€è¦åœ¨DemoDataListeneré‡Œé¢åšæ•°æ®å»é‡å¤„ç†</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;åŸºç¡€å¯¼å…¥Excelå¤šä¸ªsheetæ•°æ® / ä¸€æ¬¡æ€§è¯»å–å…¨éƒ¨sheet&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/importExcelIsSheet&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">importExcelIsSheet</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
    <span class="token comment">// ä¸€æ¬¡æ€§è¯»å–å…¨éƒ¨sheet: .headRowNumber(2) è®¾ç½®å¤šè¡Œå¤´è¡¨ç¤ºå¤´æœ‰ä¸¤è¡Œä»ç¬¬ä¸‰è¡Œå¼€å§‹è¯»å–</span>
    <span class="token comment">// 1. è¿™é‡Œéœ€è¦æ³¨æ„ DemoDataListenerçš„doAfterAllAnalysed ä¼šåœ¨æ¯ä¸ªsheetè¯»å–å®Œæ¯•åè°ƒç”¨ä¸€æ¬¡ã€‚ç„¶åæ‰€æœ‰sheetéƒ½ä¼šå¾€åŒä¸€ä¸ªDemoDataListeneré‡Œé¢å†™</span>
    <span class="token comment">// 2. ä¼šé€ æˆæ•°æ®é‡å¤ï¼Œéœ€è¦åœ¨DemoDataListeneré‡Œé¢åšæ•°æ®å»é‡å¤„ç†</span>
    <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UserMessage</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DemoDataListener</span><span class="token punctuation">(</span>execelTestService<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">headRowNumber</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doReadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-2"><a href="#å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-2" class="header-anchor">#</a> å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230815103146084.png" alt="image-20230815103146084"></p> <h2 id="åˆ†åˆ«è¯»å–-sheet"><a href="#åˆ†åˆ«è¯»å–-sheet" class="header-anchor">#</a> åˆ†åˆ«è¯»å– Sheet</h2> <h3 id="ä»£ç ç¤ºä¾‹-2"><a href="#ä»£ç ç¤ºä¾‹-2" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <ul><li>æ‰€éœ€çš„ <strong>å¯¼å…¥ç›‘å¬å™¨å’Œå®ä½“ç±» ä¸ åŸºæœ¬å¯¼å…¥</strong> ä¸€è‡´</li> <li>åˆ†å¼€è¯»å–è¡¨æ ¼çš„å¤šä¸ª Sheet ä¸ä¼šé€ æˆæ•°æ®é‡å¤çš„é—®é¢˜</li> <li>ç¡®å®š Sheet çš„æ•°é‡å¯å†™æ­» æˆ–è€…å‚è€ƒæµçš„å¯¼å…¥å†™æˆå¾ªç¯</li> <li>å¦‚æœå¤šä¸ª Sheet å¯¹åº”çš„å®ä½“ç±»ä¸ä¸€æ · åˆ™å¯¼å…¥ç›‘å¬å™¨å¯¹åº”çš„ä¹Ÿè¦é‡æ–°é…ç½®</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;åŸºç¡€å¯¼å…¥Excelå¤šä¸ªsheetæ•°æ® / åˆ†åˆ«è¯»å–å…¨éƒ¨sheet&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/importExcelIsSheetDuoci&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">importExcelIsSheetDuoci</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
    <span class="token comment">// .sheet(0) è¡¨ç¤ºè¯»å–ç¬¬ä¸€ä¸ªsheet .headRowNumber(2) è®¾ç½®å¤šè¡Œå¤´è¡¨ç¤ºå¤´æœ‰ä¸¤è¡Œä»ç¬¬ä¸‰è¡Œå¼€å§‹è¯»å–</span>
    <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UserMessage</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DemoDataListener</span><span class="token punctuation">(</span>execelTestService<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">headRowNumber</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doReadSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// .sheet(1) è¡¨ç¤ºè¯»å–ç¬¬äºŒä¸ªsheet .headRowNumber(2) è®¾ç½®å¤šè¡Œå¤´è¡¨ç¤ºå¤´æœ‰ä¸¤è¡Œä»ç¬¬ä¸‰è¡Œå¼€å§‹è¯»å–</span>
    <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UserMessage</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DemoDataListener</span><span class="token punctuation">(</span>execelTestService<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">headRowNumber</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doReadSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-3"><a href="#å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-3" class="header-anchor">#</a> å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230815103146084.png" alt="image-20230815103146084"></p> <h2 id="ä»¥æµå¯¼å…¥å¤šä¸ª-sheet"><a href="#ä»¥æµå¯¼å…¥å¤šä¸ª-sheet" class="header-anchor">#</a> ä»¥æµå¯¼å…¥å¤šä¸ª Sheet</h2> <h3 id="ä»£ç ç¤ºä¾‹-3"><a href="#ä»£ç ç¤ºä¾‹-3" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <ul><li>ä½¿ç”¨è¿™ç§æ–¹å¼æ— éœ€ ç›‘å¬å™¨å’Œå®ä½“ç±»</li> <li>ä¸ä¼šé€ æˆæ•°æ®é‡å¤çš„é—®é¢˜</li> <li>è¡¨æ ¼å¯¼å…¥å•å…ƒæ ¼æ²¡æœ‰æ•°æ®æ—¶ä¼šå¯¼è‡´æ•°æ®ä¸ºnullä½†ä¸å½±å“è½¬åŒ– ä½†æ˜¯åœ¨èµ‹å€¼éœ€æ³¨æ„å­—æ®µç±»å‹è½¬æ¢</li> <li>ç‰¹åˆ«æ³¨æ„æ ¼å¼çš„è½¬æ¢ è¯»å–ä¸º {0=å°ç½‘, 1=24, 2=å¥³, 3=13875498623, 4=1999/12/13} è½¬æ¢ä¸º {0:&quot;å°æ&quot;,1:&quot;23&quot;,2:&quot;ç”·&quot;,3:&quot;11245788547&quot;,4:&quot;1999/12/13&quot;}</li> <li>ç¡®å®š Sheet çš„æ•°é‡å¯æ ¹æ®å‚è€ƒ <strong>åˆ†åˆ«è¯»å– Sheet</strong> å†™æ­»</li> <li>å¦‚æœå¤šä¸ª Sheet å¯¹åº”çš„å®ä½“ç±»ä¸ä¸€æ · ä¸é‡‡ç”¨éå†é€‰æ‹©å†™æ­»å¯¹åº”ä¸åŒæ•°æ®</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;ä»¥æµçš„æ–¹å¼å¯¼å…¥Excelå¤šä¸ªsheetæ•°æ®&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/importExcelIsSheetLiu&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">importExcelIsSheetLiu</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">{</span>
    
    <span class="token comment">// å­˜å‚¨æ•°æ®</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMessage</span><span class="token punctuation">&gt;</span></span> userMessageList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ†åˆ«è¯»å–å…¨éƒ¨sheet</span>
        <span class="token class-name">ExcelReader</span> reader <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReadSheet</span><span class="token punctuation">&gt;</span></span> sheets <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">excelExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// éå†sheet</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sheets<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ä¾æ¬¡è·å–sheetåŠå®ƒçš„ç¬¬ä¸‰è¡Œä»¥ä¸‹çš„æ•°æ®</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> sheetList <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">headRowNumber</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doReadSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> item <span class="token operator">:</span> sheetList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// item: {0=å°ç½‘, 1=24, 2=å¥³, 3=13875498623, 4=1999/12/13} è¡¨æ ¼å¯¼å…¥å•å…ƒæ ¼æ²¡æœ‰æ•°æ®æ—¶ä¼šå¯¼è‡´æ•°æ®ä¸ºnullä½†ä¸å½±å“è½¬åŒ–</span>
                <span class="token comment">// mapStr: {0:&quot;å°æ&quot;,1:&quot;23&quot;,2:&quot;ç”·&quot;,3:&quot;11245788547&quot;,4:&quot;1999/12/13&quot;}</span>
                <span class="token class-name">String</span> mapStr <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;([^:\\{\\},]+)&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;$1\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;:\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// è§£æå­—ç¬¦ä¸²ä¸º Map&lt;Integer, String&gt;</span>
                <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> resultMap <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>mapStr<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// åˆ›å»ºå¯¹è±¡ å­˜å‚¨æ•°æ®</span>
                <span class="token class-name">UserMessage</span> userMessage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                userMessage<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                userMessage<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token string">&quot;null&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                userMessage<span class="token punctuation">.</span><span class="token function">setSex</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                userMessage<span class="token punctuation">.</span><span class="token function">setPhone</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                userMessage<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span>resultMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                userMessageList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>userMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// ä¿å­˜æ•°æ®</span>
        execelTestService<span class="token punctuation">.</span><span class="token function">saveExecls</span><span class="token punctuation">(</span>userMessageList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;å‡ºç°å¼‚å¸¸, å¯¼å…¥å¤±è´¥&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-4"><a href="#å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-4" class="header-anchor">#</a> å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230815103146084.png" alt="image-20230815103146084"></p> <blockquote><h1 id="excel-å†™-å¯¼å‡ºæ“ä½œ"><a href="#excel-å†™-å¯¼å‡ºæ“ä½œ" class="header-anchor">#</a> | --&gt; Excel å†™/å¯¼å‡ºæ“ä½œ</h1></blockquote> <blockquote><p><a href="https://easyexcel.opensource.alibaba.com/docs/current/quickstart/write" target="_blank" rel="noopener noreferrer">å†™Excel</a> :  è·å–æ•°æ®åº“æ•°æ® åˆ¶ä½œæˆExcelè¡¨æ ¼ä»¥ä¾›å¯¼å‡º</p></blockquote> <ul><li>æ³¨è§£å‚è€ƒ: <a href="https://blog.csdn.net/weixin_57467236/article/details/126554367" target="_blank" rel="noopener noreferrer">Excel æ³¨è§£åœ°å€</a></li> <li>ä¸€å¯¹å¤šæ‹¦æˆªå™¨: <a href="https://blog.csdn.net/qq_41057885/article/details/126411957" target="_blank" rel="noopener noreferrer">åœ°å€</a></li></ul> <h2 id="ajax-è¯·æ±‚ä¸‹è½½"><a href="#ajax-è¯·æ±‚ä¸‹è½½" class="header-anchor">#</a> Ajax è¯·æ±‚ä¸‹è½½</h2> <ul><li>æ³¨æ„æ‹¦æˆªå™¨æ”¾è¡Œ å…·ä½“è§ vue2 ç¬”è®°</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ----------- è¯·æ±‚ -------------</span>
<span class="token comment">// å¯¼å‡ºè¡¨æ ¼ - å¯¼å‡ºExcel</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">'/api/spuInfo/exportExcel'</span><span class="token punctuation">,</span>
        method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// å°†æ•°æ®è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²</span>
        headers<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span> <span class="token comment">// æŒ‡å®šå†…å®¹ç±»å‹ä¸º JSON</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        responseType<span class="token operator">:</span> <span class="token string">'blob'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯¼å‡ºExcel</span>
        <span class="token function">setExportExcel</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'äº§å“ä¿¡æ¯-'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä¸‹è½½æ–‡ä»¶ - é€šè¿‡æ–‡ä»¶è·¯å¾„</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">downloadFileByFilePath</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">'/api/uploadFile/downloadFileByFilePath'</span><span class="token punctuation">,</span>
        method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        params<span class="token operator">:</span> <span class="token punctuation">{</span>
            filePath<span class="token operator">:</span> filePath
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        responseType<span class="token operator">:</span> <span class="token string">'blob'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä¸‹è½½æ–‡ä»¶</span>
        <span class="token function">setDownloadFile</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ----------- å·¥å…·ç±» -------------</span>
<span class="token comment">/**
 * é€šè¿‡è¡¨æ ¼æµæ•°æ®å¹¶å¯¼å‡ºExcel
 * @param res è¯·æ±‚å“åº”çš„æ–‡ä»¶æµ
 * @param name æ–‡ä»¶åå‰ç¼€
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setExportExcel</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ–‡ä»¶åå‰ç¼€ + æ—¶é—´æˆ³ + æ–‡ä»¶åç¼€</span>
    <span class="token keyword">let</span> suffix <span class="token operator">=</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-disposition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> fileName <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> suffix<span class="token punctuation">;</span>
    <span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">&quot;application/vnd.ms-excel;charset=UTF-8&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>navigator <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>msSaveOrOpenBlob<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// IE</span>
        window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">msSaveOrOpenBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> objectUrl <span class="token operator">=</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitURL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
        <span class="token keyword">let</span> downFile <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
        downFile<span class="token punctuation">.</span>href <span class="token operator">=</span> objectUrl
        downFile<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName <span class="token comment">// ä¸‹è½½åæ–‡ä»¶å</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span> <span class="token comment">// ä¸‹è½½å®Œæˆç§»é™¤å…ƒç´ </span>
        window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>objectUrl<span class="token punctuation">)</span>   <span class="token comment">// åªè¦æ˜ å°„å­˜åœ¨ï¼ŒBlobå°±ä¸èƒ½è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå› æ­¤ä¸€æ—¦ä¸å†éœ€è¦å¼•ç”¨ï¼Œå°±å¿…é¡»å°å¿ƒæ’¤é”€URLï¼Œé‡Šæ”¾æ‰blobå¯¹è±¡ã€‚</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * é€šè¿‡æ–‡ä»¶æµä¸‹è½½æ–‡ä»¶
 * @param res è¯·æ±‚å“åº”çš„æ–‡ä»¶æµ
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setDownloadFile</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ—¶é—´æˆ³ + æ–‡ä»¶åç¼€</span>
    <span class="token keyword">let</span> suffix <span class="token operator">=</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-disposition'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> fileName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> suffix<span class="token punctuation">;</span>
    <span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">&quot;application/octet-stream&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>navigator <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>msSaveOrOpenBlob<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// IE</span>
        window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">msSaveOrOpenBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> objectUrl <span class="token operator">=</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitURL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
        <span class="token keyword">let</span> downFile <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
        downFile<span class="token punctuation">.</span>href <span class="token operator">=</span> objectUrl
        downFile<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName <span class="token comment">// ä¸‹è½½åæ–‡ä»¶å</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span>
        downFile<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>downFile<span class="token punctuation">)</span> <span class="token comment">// ä¸‹è½½å®Œæˆç§»é™¤å…ƒç´ </span>
        window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>objectUrl<span class="token punctuation">)</span>   <span class="token comment">// åªè¦æ˜ å°„å­˜åœ¨ï¼ŒBlobå°±ä¸èƒ½è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå› æ­¤ä¸€æ—¦ä¸å†éœ€è¦å¼•ç”¨ï¼Œå°±å¿…é¡»å°å¿ƒæ’¤é”€URLï¼Œé‡Šæ”¾æ‰blobå¯¹è±¡ã€‚</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="excel-å†™å·¥å…·ç±»"><a href="#excel-å†™å·¥å…·ç±»" class="header-anchor">#</a> Excel å†™å·¥å…·ç±»</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">EasyExcel</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">ExcelWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token class-name">ImageData</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token class-name">WriteCellData</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">FileUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>handler<span class="token punctuation">.</span></span><span class="token class-name">WriteHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span></span><span class="token class-name">WriteSheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteCellStyle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteFont</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">IndexedColors</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">UnsupportedEncodingException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URL<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span></span><span class="token class-name">AtomicReference</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>regex<span class="token punctuation">.</span></span><span class="token class-name">Matcher</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>regex<span class="token punctuation">.</span></span><span class="token class-name">Pattern</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EasyExcelUtil</span> <span class="token punctuation">{</span>

    <span class="token comment">// ---------- å¯¼å‡ºå‰å°è£…é¢„è®¾å·¥å…·ç±»æ–¹æ³• ----------</span>
    <span class="token comment">/**
     * é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”
     * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
     * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{</span>
        <span class="token comment">// é€šçŸ¥æµè§ˆå™¨ä»¥é™„ä»¶çš„å½¢å¼ä¸‹è½½å¤„ç†ï¼Œè®¾ç½®è¿”å›å¤´è¦æ³¨æ„æ–‡ä»¶åæœ‰ä¸­æ–‡çš„æƒ…å†µ</span>
        <span class="token class-name">String</span> datetime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyyMMddHHmmss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/vnd.ms-excel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-disposition&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attachment;filename=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>excelName<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;gb2312&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;ISO8859-1&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime <span class="token operator">+</span> <span class="token string">&quot;.xlsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”/è®¾ç½®è¡¨å¤´å±…ä¸­æ ·å¼
     * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
     * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
     * @return ExcelWriter è¡¨æ ¼å¤„ç†å¯¹è±¡
     * @throws IOException IOå¼‚å¸¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExcelWriter</span> <span class="token function">collocateResponseStyle</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// é€šçŸ¥æµè§ˆå™¨ä»¥é™„ä»¶çš„å½¢å¼ä¸‹è½½å¤„ç†ï¼Œè®¾ç½®è¿”å›å¤´è¦æ³¨æ„æ–‡ä»¶åæœ‰ä¸­æ–‡çš„æƒ…å†µ</span>
        <span class="token class-name">String</span> datetime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyyMMddHHmmss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/vnd.ms-excel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-disposition&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attachment;filename=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>excelName<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;gb2312&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;ISO8859-1&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime <span class="token operator">+</span> <span class="token string">&quot;.xlsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1 è®¾ç½®è¡¨å¤´æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> headStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1.1 è®¾ç½®è¡¨å¤´æ•°æ®å±…ä¸­ / å‚ç›´å±…ä¸­ / è®¾ç½®å­—ä½“é«˜åº¦ï¼ˆä»¥ç‚¹ä¸ºå•ä½ï¼‰</span>
        headStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        headStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        headStyle<span class="token punctuation">.</span><span class="token function">setFillForegroundColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span>PALE_BLUE<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteFont</span> headWriteFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headWriteFont<span class="token punctuation">.</span><span class="token function">setFontHeightInPoints</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headStyle<span class="token punctuation">.</span><span class="token function">setWriteFont</span><span class="token punctuation">(</span>headWriteFont<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2 è®¾ç½®è¡¨æ ¼å†…å®¹æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> bodyStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.1 è®¾ç½®è¡¨æ ¼å†…å®¹æ°´å¹³å±…ä¸­ / å‚ç›´å±…ä¸­</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å­—ä½“å¤§å°</span>
        <span class="token class-name">WriteFont</span> contentWriteFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        contentWriteFont<span class="token punctuation">.</span><span class="token function">setFontHeightInPoints</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setWriteFont</span><span class="token punctuation">(</span>contentWriteFont<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 4 æ‹¿åˆ°è¡¨æ ¼å¤„ç†å¯¹è±¡</span>
        <span class="token keyword">return</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">needHead</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">excelType</span><span class="token punctuation">(</span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span>
                <span class="token comment">// è®¾ç½®å•å…ƒæ ¼çš„é£æ ¼æ ·å¼</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">(</span>headStyle<span class="token punctuation">,</span> bodyStyle<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">// ---------- å¯¼å‡ºå°è£…å·¥å…·ç±»æ–¹æ³• ----------</span>
    <span class="token comment">/**
     * ç®€å•çš„å¯¼å‡º Excel è¡¨æ ¼ é»˜è®¤æ ·å¼
     * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
     * @param dataList æ•°æ®é›†åˆ
     * @param entityClass å®ä½“ç±»
     * @param sheetName å¤šè¡¨æ ¼sheetçš„åç§° ä¸æ˜¯å¯¼å‡ºè¡¨æ ¼æ–‡ä»¶çš„åç§°
     * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
     * @throws IOException æŠ›å‡ºå¼‚å¸¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">easyDownload</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> dataList<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entityClass<span class="token punctuation">,</span> <span class="token class-name">String</span> sheetName<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¼å‡º</span>
        <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> entityClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doWrite</span><span class="token punctuation">(</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * ç®€å•çš„å¯¼å‡º Excel è¡¨æ ¼ å±…ä¸­æ ·å¼
     * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
     * @param dataList æ•°æ®é›†åˆ
     * @param entityClass å®ä½“ç±»
     * @param sheetName å¤šè¡¨æ ¼sheetçš„åç§° ä¸æ˜¯å¯¼å‡ºè¡¨æ ¼æ–‡ä»¶çš„åç§°
     * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
     * @throws IOException æŠ›å‡ºå¼‚å¸¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">easyDownloadStyle</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> dataList<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entityClass<span class="token punctuation">,</span> <span class="token class-name">String</span> sheetName<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 3 è®¾ç½®è¡¨æ ¼sheetæ ·å¼</span>
        <span class="token class-name">WriteSheet</span> sheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetNo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4 æ‹¿åˆ°è¡¨æ ¼å¤„ç†å¯¹è±¡</span>
        <span class="token class-name">ExcelWriter</span> writer <span class="token operator">=</span> <span class="token function">collocateResponseStyle</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 5 å†™å…¥excelæ•°æ®</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 6 å…³é—­æµ</span>
        writer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å¯¼å‡º Excel è¡¨æ ¼ å±…ä¸­æ ·å¼ æŒ‡å®šæ‹¦æˆªå™¨(å¯å®ç°ä¸€å¯¹å¤šå¯¼å‡º)
     * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
     * @param dataList æ•°æ®é›†åˆ
     * @param entityClass å®ä½“ç±»
     * @param sheetName å¤šè¡¨æ ¼sheetçš„åç§° ä¸æ˜¯å¯¼å‡ºè¡¨æ ¼æ–‡ä»¶çš„åç§°
     * @param t æ‹¦æˆªå™¨
     * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
     * @param &lt;T&gt; æ‹¦æˆªå™¨æ³›å‹
     * @throws IOException æŠ›å‡ºå¼‚å¸¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> dataList<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entityClass<span class="token punctuation">,</span> <span class="token class-name">String</span> sheetName<span class="token punctuation">,</span> <span class="token class-name">T</span> t<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1 è®¾ç½®è¡¨å¤´æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> headStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1.1 è®¾ç½®è¡¨å¤´æ•°æ®å±…ä¸­</span>
        headStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2 è®¾ç½®è¡¨æ ¼å†…å®¹æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> bodyStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.1 è®¾ç½®è¡¨æ ¼å†…å®¹æ°´å¹³å±…ä¸­</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.2 è®¾ç½®è¡¨æ ¼å†…å®¹å‚ç›´å±…ä¸­</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3 è®¾ç½®è¡¨æ ¼sheetæ ·å¼</span>
        <span class="token class-name">WriteSheet</span> sheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetNo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4 æ‹¿åˆ°è¡¨æ ¼å¤„ç†å¯¹è±¡</span>
        <span class="token class-name">ExcelWriter</span> writer <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">needHead</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">excelType</span><span class="token punctuation">(</span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span>
                <span class="token comment">// è‡ªå®šä¹‰æ‹¦æˆªå™¨</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">WriteHandler</span><span class="token punctuation">)</span> t<span class="token punctuation">)</span>
                <span class="token comment">// è®¾ç½®å•å…ƒæ ¼çš„é£æ ¼æ ·å¼</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">(</span>headStyle<span class="token punctuation">,</span> bodyStyle<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 5 å†™å…¥excelæ•°æ®</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 6 å…³é—­æµ</span>
        writer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * ä½¿ç”¨æ‹¦æˆªå™¨ å¤šä¸ª
     * @param excelName
     * @param dataList
     * @param entityClass
     * @param sheetName
     * @param t
     * @param v
     * @param response
     * @param &lt;T&gt;
     * @param &lt;V&gt;
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> dataList<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entityClass<span class="token punctuation">,</span> <span class="token class-name">String</span> sheetName<span class="token punctuation">,</span> <span class="token class-name">T</span> t<span class="token punctuation">,</span> <span class="token class-name">V</span> v<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1 è®¾ç½®è¡¨å¤´æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> headStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1.1 è®¾ç½®è¡¨å¤´æ•°æ®å±…ä¸­</span>
        headStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2 è®¾ç½®è¡¨æ ¼å†…å®¹æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> bodyStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.1 è®¾ç½®è¡¨æ ¼å†…å®¹æ°´å¹³å±…ä¸­</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.2 è®¾ç½®è¡¨æ ¼å†…å®¹å‚ç›´å±…ä¸­</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3 è®¾ç½®è¡¨æ ¼sheetæ ·å¼</span>
        <span class="token class-name">WriteSheet</span> sheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetNo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4 æ‹¿åˆ°è¡¨æ ¼å¤„ç†å¯¹è±¡</span>
        <span class="token class-name">ExcelWriter</span> writer <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">needHead</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">excelType</span><span class="token punctuation">(</span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span>
                <span class="token comment">// è‡ªå®šä¹‰æ‹¦æˆªå™¨</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">WriteHandler</span><span class="token punctuation">)</span> t<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">WriteHandler</span><span class="token punctuation">)</span> v<span class="token punctuation">)</span>
                <span class="token comment">// è®¾ç½®å•å…ƒæ ¼çš„é£æ ¼æ ·å¼</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">(</span>headStyle<span class="token punctuation">,</span> bodyStyle<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 5 å†™å…¥excelæ•°æ®</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 6 å…³é—­æµ</span>
        writer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å¯¼å‡ºå¤šä¸ªsheetè¡¨æ ¼: æ¯ä¸ªsheetè¡¨æ ¼å¯¹åº”ä¸€ä¸ªå¯¹è±¡/ç›¸åŒå¯¹è±¡
     * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
     * @param dataAndSheets sheetè¡¨æ ¼åç§°: key (åç§°ä¸èƒ½ç›¸åŒ) æ•°æ®é›†åˆ: value (æ•°æ®é›†åˆçš„å¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ä¸ªå¯¹è±¡)
     * @param entityClass å¯¹è±¡çš„å­—èŠ‚ç å¯¹è±¡
     * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
     * @param &lt;T&gt; æ³›å‹
     * @throws IOException æŠ›å‡ºå¼‚å¸¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">easyDownloadSheets</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> dataAndSheets<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entityClass<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 2. åˆ›å»º ExcelWriter å¯¹è±¡</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token function">collocateResponseStyle</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. éå† Map</span>
        <span class="token class-name">AtomicReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> i <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataAndSheets<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 4. åˆ›å»º WriteSheet å¯¹è±¡</span>
            <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            i<span class="token punctuation">.</span><span class="token function">getAndSet</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 5. å†™å…¥æ•°æ®</span>
            excelWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 6. å…³é—­æµ</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * å¯¼å‡ºå¤šä¸ªsheetè¡¨æ ¼: æ¯ä¸ªsheetè¡¨æ ¼å¯¹åº”ä¸€ä¸ªå¯¹è±¡/ä¸åŒå¯¹è±¡
     * 1. lsMapä¸­çš„é›†åˆä¸ºç©ºå°†ä¸ä¼šå¯¼å‡ºä¼šè·³è¿‡
     * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
     * @param lsMap key: sheetè¡¨æ ¼åç§° value: æ•°æ®é›†åˆ
     * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
     * @throws IOException æŠ›å‡ºå¼‚å¸¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>  <span class="token function">easyDownloadSheetsNo</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> lsMap<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 2. åˆ›å»º ExcelWriter å¯¹è±¡</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span>  <span class="token function">collocateResponseStyle</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. éå† lsMap é›†åˆ key: æ•°æ®é›†åˆ  value: å¯¹è±¡çš„å­—èŠ‚ç å¯¹è±¡</span>
        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// 4. åˆ›å»º WriteSheet å¯¹è±¡</span>
        <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> lsMap<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> key <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> value <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 5. å†™å…¥æ•°æ®</span>
            excelWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            num<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 6. å…³é—­æµ</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// ---------- å¯¼å‡ºç±»å‹è½¬æ¢å°è£…å·¥å…·ç±»æ–¹æ³• ----------</span>
    <span class="token comment">/**
     * å¯¼å‡ºè¡¨æ ¼å›¾ç‰‡ (å•ä¸ªå›¾ç‰‡): æ ¼å¼æµè½¬æ¢
     * @param imagePath å›¾ç‰‡è·¯å¾„ (æœ¬åœ°è·¯å¾„) (ç½‘ç»œè·¯å¾„)
     * @param typeClazz è½¬æ¢çš„ç±»å‹ (File.class, InputStream.class, byte[].class, URL.class)
     * @return è¿”å›è½¬æ¢åçš„ç±»å‹
     * @param &lt;T&gt; æ³›å‹
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">imageConvert</span><span class="token punctuation">(</span><span class="token class-name">String</span> imagePath<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> typeClazz<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ¤æ–­ç±»å‹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> <span class="token class-name">File</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> <span class="token class-name">InputStream</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">openInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å¯¼å‡ºè¡¨æ ¼å›¾ç‰‡ (å¤šä¸ªå›¾ç‰‡): æ ¼å¼æµè½¬æ¢, å¤šå¼ å›¾ç‰‡ä¼šå åŠ åœ¨ä¸€ä¸ªå•å…ƒæ ¼ä¸­
     * @param imagePaths å›¾ç‰‡è·¯å¾„ (æœ¬åœ°è·¯å¾„)
     * @param wordStr å›¾ç‰‡åœ°ä¸‹å•å…ƒæ ¼å¯¹åº”çš„æ–‡å­—
     * @return è¿”å›è½¬æ¢åçš„ç±»å‹
     * @throws IOException æŠ›å‡ºå¼‚å¸¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">imageConvert</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> imagePaths<span class="token punctuation">,</span> <span class="token class-name">String</span> wordStr<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> writeCellData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1. é…ç½®WriteCellDataå¯¹è±¡, è¿™é‡Œå¯ä»¥è®¾ç½®ä¸º EMPTY åˆ™ä»£è¡¨ä¸éœ€è¦å…¶ä»–æ•°æ®äº†</span>
        writeCellData<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellData<span class="token punctuation">.</span><span class="token function">setStringValue</span><span class="token punctuation">(</span>wordStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageData</span><span class="token punctuation">&gt;</span></span> imageDataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ImageData</span> imageData <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. åˆ›å»ºå¯¹åº”å¯¹è±¡è¿›è¡Œå­˜å‚¨, å¯ä»¥æ”¾å…¥å¤šä¸ªå›¾ç‰‡</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> imagePath <span class="token operator">:</span> imagePaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            imageData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 3. æ”¾å…¥2è¿›åˆ¶å›¾ç‰‡-è®¾ç½®å›¾ç‰‡ç±»å‹</span>
            imageData<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            imageData<span class="token punctuation">.</span><span class="token function">setImageType</span><span class="token punctuation">(</span><span class="token class-name">ImageData<span class="token punctuation">.</span>ImageType</span><span class="token punctuation">.</span>PICTURE_TYPE_PNG<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 4. é…ç½®å›¾ç‰‡åœ¨å•å…ƒæ ¼çš„æ ·å¼ (ä¸Š/å³/ä¸‹/å·¦ éœ€è¦ç•™ç©º è¿™ä¸ªç±»ä¼¼äº css çš„ margin) è¿™é‡Œå®æµ‹ ä¸èƒ½è®¾ç½®å¤ªå¤§ è¶…è¿‡å•å…ƒæ ¼åŸå§‹å¤§å°å æ‰“å¼€ä¼šæç¤ºä¿®å¤ã€‚æš‚æ—¶æœªæ‰¾åˆ°å¾ˆå¥½çš„è§£æ³•ã€‚</span>
            imageData<span class="token punctuation">.</span><span class="token function">setTop</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            imageData<span class="token punctuation">.</span><span class="token function">setRight</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            imageData<span class="token punctuation">.</span><span class="token function">setBottom</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            imageData<span class="token punctuation">.</span><span class="token function">setLeft</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 5. èµ‹å€¼</span>
            imageDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            writeCellData<span class="token punctuation">.</span><span class="token function">setImageDataList</span><span class="token punctuation">(</span>imageDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 6. è®¾ç½®å›¾ç‰‡çš„ä½ç½® å‡è®¾ ç°åœ¨ç›®æ ‡ æ˜¯ è¦†ç›– å½“å‰å•å…ƒæ ¼ å’Œå½“å‰å•å…ƒæ ¼å³è¾¹çš„å•å…ƒæ ¼ / èµ·ç‚¹ç›¸å¯¹äºå½“å‰å•å…ƒæ ¼ä¸º0 å½“ç„¶å¯ä»¥ä¸å†™</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstColumnIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 7. å‰é¢3ä¸ªå¯ä»¥ä¸å†™ ä¸‹é¢è¿™ä¸ªéœ€è¦å†™ ä¹Ÿå°±æ˜¯ ç»“å°¾ éœ€è¦ç›¸å¯¹å½“å‰å•å…ƒæ ¼ å¾€å³ç§»åŠ¨ä¸€æ ¼ / ä¹Ÿå°±æ˜¯è¯´ è¿™ä¸ªå›¾ç‰‡ä¼šè¦†ç›–å½“å‰å•å…ƒæ ¼å’Œ åé¢çš„é‚£ä¸€æ ¼</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastColumnIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> writeCellData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å°†è¡¨æ ¼è¡Œæ•°æ®è½¬åŒ–ä¸ºMap&lt;å•å…ƒæ ¼åºå·0å¼€å§‹, å•å…ƒæ ¼å†…å®¹&gt;
     * @param text å•å…ƒæ ¼å†…å®¹(å¯è¿‡æ»¤æ‰ç‰¹æ®Šå­—ç¬¦ä¸²)
     * @return Map&lt;å•å…ƒæ ¼åºå·0å¼€å§‹, å•å…ƒæ ¼å†…å®¹&gt;
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">parseStringToMap</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ¨¡å¼</span>
        <span class="token class-name">Pattern</span> pattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">&quot;(\\d+)=([^,]+)(?:, |$)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Matcher</span> matcher <span class="token operator">=</span> pattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼Œå¹¶å°†åŒ¹é…ç»“æœæ”¾å…¥mapä¸­</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>matcher<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Integer</span> key <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>matcher<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> value <span class="token operator">=</span> matcher<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> map<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ---------- å¡«å……æ¨¡æ¿å¯¼å‡ºæ–¹æ³• ----------</span>

    <span class="token comment">/**
     * ç®€å•é»˜è®¤å¡«å……å¯¼å‡ºæ–¹æ³•
     * @param fill æ¨¡æ¿è·¯å¾„ 
     * @param object å¡«å……çš„æ•°æ®
     * @param response res
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">easyFillDownload</span><span class="token punctuation">(</span><span class="token class-name">String</span> fill<span class="token punctuation">,</span> <span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> excelName <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>fill<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteSheet</span> writeSheet  <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Excel è¯·æ±‚æµ‹è¯•</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">EasyExcel</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">ExcelWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">FileUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ListUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span></span><span class="token class-name">WriteSheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteCellStyle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteFont</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb<span class="token punctuation">.</span></span><span class="token class-name">ExcelMergeCellHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb<span class="token punctuation">.</span></span><span class="token class-name">TestFileUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>ex<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ExecelTestService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Api</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiOperation</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">FillPatternType</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">IndexedColors</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URL<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>


<span class="token comment">/**
 * (ExecelTest)è¡¨æ§åˆ¶å±‚
 *
 * @author Lu-Apai: There is no BUG in seeing light and believing light to be light AOLIGEI ...
 * @since 2023-08-09 15:43:32
 */</span>

<span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;$tableInfo.comment&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/execelTest&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExecelTestController</span> <span class="token punctuation">{</span>
    
    <span class="token comment">/**
     * ä¸šåŠ¡å±‚å¯¹è±¡
     */</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ExecelTestService</span> execelTestService<span class="token punctuation">;</span>

    <span class="token comment">// ----------- ä»¥ä¸‹æ˜¯æµ‹è¯•ä»£ç  ---------------</span>
    <span class="token comment">/**
     * æŒ‡å®šåˆ—å¯¼å‡º: @ExcelProperty(value = &quot;åˆ—å&quot;, index = åˆ—å·)
     * @param response
     * @throws IOException
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;download&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æŒ‡å®šåˆ—å¯¼å‡º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">DemoData</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;åŸºç¡€å¯¼å‡ºæµ‹è¯•&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span><span class="token string">&quot;æŒ‡å®šåˆ—å¯¼å‡ºè¡¨&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token class-name">DemoData</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º: @ExcelProperty(value = {&quot;ä¸»æ ‡é¢˜&quot;,&quot;äºŒçº§æ ‡é¢˜&quot;, &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;}, index = 0)
     * 1. å¤šçº§æ ‡é¢˜: value ä¸ºæ•°ç»„, éœ€è¦ä¸€ä¸€å¯¹åº”
     * @param response
     * @throws IOException
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadFuZhaTou&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFuZhaTou</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">FuZhaTou</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡ºè¡¨&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadFuZhaTouSheets&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡ºå¤šä¸ªsheetåŒå¯¹è±¡é›†åˆ&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFuZhaTouSheets</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> data1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">FuZhaTou</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FuZhaTou</span> datas1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas1<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;is ç‰› pisad&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas1<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas1<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">15.2999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> ls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet2&quot;</span><span class="token punctuation">,</span> data1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadSheets</span><span class="token punctuation">(</span><span class="token string">&quot;å¤šä¸ªsheetåŒå¯¹è±¡&quot;</span><span class="token punctuation">,</span> ls<span class="token punctuation">,</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadFuZhaTouSheetsNo&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡ºå¤šä¸ªsheetä¸åŒå¯¹è±¡é›†åˆ&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFuZhaTouSheetsNo</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">DemoData</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²aaa&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">9.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            a<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">FuZhaTou</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²bbb&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            b<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> ls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet1-æ ‡ç­¾aaa&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet2-æ ‡ç­¾bbb&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadSheetsNo</span><span class="token punctuation">(</span><span class="token string">&quot;å¤šä¸ªsheetä¸åŒå¯¹è±¡æµ‹è¯•è¡¨&quot;</span><span class="token punctuation">,</span> ls<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadChange&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º æ•°æ®è½¬æ¢&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadChange</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConverterData</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ConverterData</span> nv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConverterData</span><span class="token punctuation">(</span><span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8.25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ConverterData</span> nan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConverterData</span><span class="token punctuation">(</span><span class="token string">&quot;å°å¢&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4.77</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nan<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ®è½¬æ¢&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token class-name">ConverterData</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-è½¬æ¢&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadImage&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºå›¾ç‰‡è¡¨æ ¼&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadImage</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
        <span class="token class-name">String</span> imagePath1 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-16-48.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath2 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\4bad14d0347d48cfb774bbc4e394629c.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath3 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-17.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath4 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-47.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath6 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_14-56-46.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath7 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-30_14-51-55.png&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
        <span class="token class-name">String</span> imagePath5 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503204942958.png&quot;</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageDemoApai</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span>  <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ImageDemoApai</span> imageDemoApai <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">(</span><span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setInputStream</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">openInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>imagePath3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setByteArray</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span>imagePath5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3. å¤šä¸ªå›¾ç‰‡-éœ€è¦é¢å¤–æ”¾å…¥æ–‡å­—-è€Œä¸”éœ€è¦æ”¾å…¥2ä¸ªå›¾ç‰‡-ç¬¬ä¸€ä¸ªå›¾ç‰‡é å·¦-ç¬¬äºŒä¸ªé å³-è€Œä¸”è¦é¢å¤–çš„å ç”¨ä»–åé¢çš„å•å…ƒæ ¼</span>
        <span class="token comment">// 2. åˆ›å»ºWriteCellDataå¯¹è±¡ç„¶åèµ‹å€¼åˆ°å¯¹åº”çš„å¯¹è±¡ä¸­</span>
        <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> writeCellData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setWriteCellDataFile</span><span class="token punctuation">(</span>writeCellData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. é…ç½®WriteCellDataå¯¹è±¡, è¿™é‡Œå¯ä»¥è®¾ç½®ä¸º EMPTY åˆ™ä»£è¡¨ä¸éœ€è¦å…¶ä»–æ•°æ®äº†</span>
        writeCellData<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellData<span class="token punctuation">.</span><span class="token function">setStringValue</span><span class="token punctuation">(</span><span class="token string">&quot;é¢å¤–çš„æ”¾ä¸€äº›æ–‡å­—,è¿™é‡Œæ˜¯å¤šä¸ªå›¾ç‰‡çš„è¡¨æ ¼å•å…ƒæ ¼...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4. åˆ›å»ºå¯¹åº”å¯¹è±¡è¿›è¡Œå­˜å‚¨, å¯ä»¥æ”¾å…¥å¤šä¸ªå›¾ç‰‡</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageData</span><span class="token punctuation">&gt;</span></span> imageDataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ImageData</span> imageData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellData<span class="token punctuation">.</span><span class="token function">setImageDataList</span><span class="token punctuation">(</span>imageDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 5. æ”¾å…¥2è¿›åˆ¶å›¾ç‰‡-è®¾ç½®å›¾ç‰‡ç±»å‹</span>
        imageData<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setImageType</span><span class="token punctuation">(</span><span class="token class-name">ImageData<span class="token punctuation">.</span>ImageType</span><span class="token punctuation">.</span>PICTURE_TYPE_PNG<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 6. é…ç½®å›¾ç‰‡åœ¨å•å…ƒæ ¼çš„æ ·å¼ (ä¸Š/å³/ä¸‹/å·¦ éœ€è¦ç•™ç©º è¿™ä¸ªç±»ä¼¼äº css çš„ margin) è¿™é‡Œå®æµ‹ ä¸èƒ½è®¾ç½®å¤ªå¤§ è¶…è¿‡å•å…ƒæ ¼åŸå§‹å¤§å°å æ‰“å¼€ä¼šæç¤ºä¿®å¤ã€‚æš‚æ—¶æœªæ‰¾åˆ°å¾ˆå¥½çš„è§£æ³•ã€‚</span>
        imageData<span class="token punctuation">.</span><span class="token function">setTop</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRight</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setBottom</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setLeft</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 7. æ”¾å…¥ç¬¬äºŒä¸ªå›¾ç‰‡ å’Œæ”¾å…¥ç¬¬ä¸€ä¸ªå›¾ç‰‡ä¸€æ ·çš„æ“ä½œ</span>
        imageData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellData<span class="token punctuation">.</span><span class="token function">setImageDataList</span><span class="token punctuation">(</span>imageDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath7<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setImageType</span><span class="token punctuation">(</span><span class="token class-name">ImageData<span class="token punctuation">.</span>ImageType</span><span class="token punctuation">.</span>PICTURE_TYPE_PNG<span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setTop</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRight</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setBottom</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setLeft</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 8. è®¾ç½®å›¾ç‰‡çš„ä½ç½® å‡è®¾ ç°åœ¨ç›®æ ‡ æ˜¯ è¦†ç›– å½“å‰å•å…ƒæ ¼ å’Œå½“å‰å•å…ƒæ ¼å³è¾¹çš„å•å…ƒæ ¼ / èµ·ç‚¹ç›¸å¯¹äºå½“å‰å•å…ƒæ ¼ä¸º0 å½“ç„¶å¯ä»¥ä¸å†™</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstColumnIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 9. å‰é¢3ä¸ªå¯ä»¥ä¸å†™ ä¸‹é¢è¿™ä¸ªéœ€è¦å†™ ä¹Ÿå°±æ˜¯ ç»“å°¾ éœ€è¦ç›¸å¯¹å½“å‰å•å…ƒæ ¼ å¾€å³ç§»åŠ¨ä¸€æ ¼ / ä¹Ÿå°±æ˜¯è¯´ è¿™ä¸ªå›¾ç‰‡ä¼šè¦†ç›–å½“å‰å•å…ƒæ ¼å’Œ åé¢çš„é‚£ä¸€æ ¼</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastColumnIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å­˜å‚¨åˆ°listä¸­ è¿›è¡Œå¯¼å‡º</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageDemoApai<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºå›¾ç‰‡è¡¨æ ¼&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">,</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-å›¾ç‰‡&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadImageUtil&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºå›¾ç‰‡è¡¨æ ¼ ä½¿ç”¨å·¥å…·ç±»&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadImageUtil</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
        <span class="token class-name">String</span> imagePath1 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-16-48.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath2 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\4bad14d0347d48cfb774bbc4e394629c.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath3 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-17.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath4 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-47.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath6 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_14-56-46.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> imagePath7 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-30_14-51-55.png&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
        <span class="token class-name">String</span> imagePath5 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503204942958.png&quot;</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageDemoApai</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span>  <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ImageDemoApai</span> imageDemoApai <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">(</span><span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setFile</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath1<span class="token punctuation">,</span> <span class="token class-name">File</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setInputStream</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath2<span class="token punctuation">,</span> <span class="token class-name">InputStream</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>imagePath3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setByteArray</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath4<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath5<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imagePath6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        strs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imagePath7<span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageDemoApai<span class="token punctuation">.</span><span class="token function">setWriteCellDataFile</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> <span class="token string">&quot;cså¤šä¸ªå›¾ç‰‡&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å­˜å‚¨åˆ°listä¸­ è¿›è¡Œå¯¼å‡º</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageDemoApai<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºå›¾ç‰‡è¡¨æ ¼ ä½¿ç”¨å·¥å…·ç±»&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">,</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-å›¾ç‰‡&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/exportExcelSty&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºExcelè®¾ç½®å•å…ƒæ ¼æ ·å¼&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportExcelSty</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;writeCellDataWrite&quot;</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.xlsx&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteCellDemoData</span> writeCellDemoData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellDemoData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®è¶…é“¾æ¥</span>
        <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hyperlink <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;å®˜æ–¹ç½‘ç«™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellDemoData<span class="token punctuation">.</span><span class="token function">setHyperlink</span><span class="token punctuation">(</span>hyperlink<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HyperlinkData</span> hyperlinkData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HyperlinkData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hyperlink<span class="token punctuation">.</span><span class="token function">setHyperlinkData</span><span class="token punctuation">(</span>hyperlinkData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        hyperlinkData<span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token string">&quot;https://github.com/alibaba/easyexcel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hyperlinkData<span class="token punctuation">.</span><span class="token function">setHyperlinkType</span><span class="token punctuation">(</span><span class="token class-name">HyperlinkData<span class="token punctuation">.</span>HyperlinkType</span><span class="token punctuation">.</span>URL<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®å¤‡æ³¨</span>
        <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> comment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;å¤‡æ³¨çš„å•å…ƒæ ¼ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellDemoData<span class="token punctuation">.</span><span class="token function">setCommentData</span><span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CommentData</span> commentData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommentData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        comment<span class="token punctuation">.</span><span class="token function">setCommentData</span><span class="token punctuation">(</span>commentData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        commentData<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span><span class="token string">&quot;Jiaju Zhuang&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commentData<span class="token punctuation">.</span><span class="token function">setRichTextStringData</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RichTextStringData</span><span class="token punctuation">(</span><span class="token string">&quot;è¿™æ˜¯ä¸€ä¸ªå¤‡æ³¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¤‡æ³¨çš„é»˜è®¤å¤§å°æ˜¯æŒ‰ç…§å•å…ƒæ ¼çš„å¤§å° è¿™é‡Œæƒ³è°ƒæ•´åˆ°4ä¸ªå•å…ƒæ ¼é‚£ä¹ˆå¤§ æ‰€ä»¥å‘å å‘ä¸‹ å„é¢å¤–å ç”¨äº†ä¸€ä¸ªå•å…ƒæ ¼</span>
        commentData<span class="token punctuation">.</span><span class="token function">setRelativeLastColumnIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commentData<span class="token punctuation">.</span><span class="token function">setRelativeLastRowIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®å…¬å¼</span>
        <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> formula <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellDemoData<span class="token punctuation">.</span><span class="token function">setFormulaData</span><span class="token punctuation">(</span>formula<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FormulaData</span> formulaData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormulaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        formula<span class="token punctuation">.</span><span class="token function">setFormulaData</span><span class="token punctuation">(</span>formulaData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°† 123456789 ä¸­çš„ç¬¬ä¸€ä¸ªæ•°å­—æ›¿æ¢æˆ 2</span>
        <span class="token comment">// è¿™é‡Œåªæ˜¯ä¾‹å­ å¦‚æœçœŸçš„æ¶‰åŠåˆ°å…¬å¼ èƒ½å†…å­˜ç®—å¥½å°½é‡å†…å­˜ç®—å¥½ å…¬å¼èƒ½ä¸ç”¨å°½é‡ä¸ç”¨</span>
        formulaData<span class="token punctuation">.</span><span class="token function">setFormulaValue</span><span class="token punctuation">(</span><span class="token string">&quot;REPLACE(123456789,1,1,2)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®å•ä¸ªå•å…ƒæ ¼çš„æ ·å¼ å½“ç„¶æ ·å¼ å¾ˆå¤šçš„è¯ ä¹Ÿå¯ä»¥ç”¨æ³¨è§£ç­‰æ–¹å¼ã€‚</span>
        <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> writeCellStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;å•å…ƒæ ¼æ ·å¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellStyle<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellDemoData<span class="token punctuation">.</span><span class="token function">setWriteCellStyle</span><span class="token punctuation">(</span>writeCellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteCellStyle</span> writeCellStyleData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellStyle<span class="token punctuation">.</span><span class="token function">setWriteCellStyle</span><span class="token punctuation">(</span>writeCellStyleData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿™é‡Œéœ€è¦æŒ‡å®š FillPatternType ä¸ºFillPatternType.SOLID_FOREGROUND ä¸ç„¶æ— æ³•æ˜¾ç¤ºèƒŒæ™¯é¢œè‰².</span>
        writeCellStyleData<span class="token punctuation">.</span><span class="token function">setFillPatternType</span><span class="token punctuation">(</span><span class="token class-name">FillPatternType</span><span class="token punctuation">.</span>SOLID_FOREGROUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// èƒŒæ™¯ç»¿è‰²</span>
        writeCellStyleData<span class="token punctuation">.</span><span class="token function">setFillForegroundColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span>GREEN<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼</span>
        <span class="token comment">// è¿™é‡Œéœ€è¦è®¾ç½® inMomery=true ä¸ç„¶ä¼šå¯¼è‡´æ— æ³•å±•ç¤ºå•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼ï¼Œæ‰€ä»¥æ…ç”¨</span>
        <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> richTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        richTest<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>RICH_TEXT_STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellDemoData<span class="token punctuation">.</span><span class="token function">setRichText</span><span class="token punctuation">(</span>richTest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RichTextStringData</span> richTextStringData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RichTextStringData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        richTest<span class="token punctuation">.</span><span class="token function">setRichTextStringDataValue</span><span class="token punctuation">(</span>richTextStringData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        richTextStringData<span class="token punctuation">.</span><span class="token function">setTextString</span><span class="token punctuation">(</span><span class="token string">&quot;çº¢è‰²ç»¿è‰²é»˜è®¤&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å‰2ä¸ªå­—çº¢è‰²</span>
        <span class="token class-name">WriteFont</span> writeFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeFont<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span>RED<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        richTextStringData<span class="token punctuation">.</span><span class="token function">applyFont</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> writeFont<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¥ä¸‹æ¥2ä¸ªå­—ç»¿è‰²</span>
        writeFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeFont<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span>GREEN<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        richTextStringData<span class="token punctuation">.</span><span class="token function">applyFont</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> writeFont<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WriteCellDemoData</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>writeCellDemoData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token class-name">WriteCellDemoData</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inMemory</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token string">&quot;æ¨¡æ¿&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doWrite</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadOneIs&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºè¡¨æ ¼ ä¸€å¯¹å¤šæ ¼å¼æ•°æ®&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadOneIs</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
        <span class="token class-name">String</span> url1 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503204942958.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> url2 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503211609233.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">School</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;è€åˆ˜&quot;</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°æ&quot;</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒå¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸ƒç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°å¢&quot;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒå¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;å»ºæ°´åˆä¸­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JS-78425&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åˆä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°ä¹&quot;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">&quot;å»ºæ°´è·¯ç½‘é‡‘è¡—é“27å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url2<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;å»ºæ°´åˆä¸­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JS-78425&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åˆä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°é¹…&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;å»ºæ°´è·¯ç½‘é‡‘è¡—é“27å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url2<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s7<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®éœ€è¦å¾…åˆå¹¶çš„è¡Œå’Œåˆ—ã€‚å‚æ•°1ï¼šæ•°å€¼æ•°ç»„ï¼ŒæŒ‡å®šéœ€è¦åˆå¹¶çš„åˆ—ï¼›å‚æ•°2ï¼šæ•°å€¼ï¼ŒæŒ‡å®šä»ç¬¬å‡ è¡Œå¼€å§‹åˆå¹¶</span>
        <span class="token class-name">ExcelMergeCellHandler</span> excelMergeCellHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelMergeCellHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span><span class="token string">&quot;å­¦æ ¡_ä¸€å¯¹å¤šæ•°æ®è¡¨&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">,</span> <span class="token class-name">School</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-å­¦æ ¡ä¿¡æ¯&quot;</span><span class="token punctuation">,</span> excelMergeCellHandler<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¯¼å‡ºåŸºç¡€è¡¨ å±…ä¸­æ ·å¼</span>
        <span class="token comment">// EasyExcelUtil.easyDownloadStyle(&quot;å­¦æ ¡_ä¸€å¯¹å¤šæ•°æ®è¡¨&quot;, list, School.class, &quot;sheet-å­¦æ ¡ä¿¡æ¯&quot;, response);</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/exportExcelOneIs&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºExcel&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// æŸ¥è¯¢éœ€è¦å¯¼å‡ºçš„æ•°æ®</span>
        <span class="token class-name">List</span> result <span class="token operator">=</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 1è®¾ç½®è¡¨å¤´æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> headStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 1.1è®¾ç½®è¡¨å¤´æ•°æ®å±…ä¸­</span>
        headStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2è®¾ç½®è¡¨æ ¼å†…å®¹æ ·å¼</span>
        <span class="token class-name">WriteCellStyle</span> bodyStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.1è®¾ç½®è¡¨æ ¼å†…å®¹æ°´å¹³å±…ä¸­</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.2è®¾ç½®è¡¨æ ¼å†…å®¹å‚ç›´å±…ä¸­</span>
        bodyStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3è®¾ç½®è¡¨æ ¼sheetæ ·å¼</span>
        <span class="token class-name">WriteSheet</span> sheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token string">&quot;å®¢æˆ·ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetNo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4æ‹¿åˆ°è¡¨æ ¼å¤„ç†å¯¹è±¡</span>
        <span class="token class-name">ExcelWriter</span> writer <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">needHead</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">excelType</span><span class="token punctuation">(</span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span>
                <span class="token comment">// è®¾ç½®éœ€è¦å¾…åˆå¹¶çš„è¡Œå’Œåˆ—ã€‚å‚æ•°1ï¼šæ•°å€¼æ•°ç»„ï¼ŒæŒ‡å®šéœ€è¦åˆå¹¶çš„åˆ—ï¼›å‚æ•°2ï¼šæ•°å€¼ï¼ŒæŒ‡å®šä»ç¬¬å‡ è¡Œå¼€å§‹åˆå¹¶</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExcelMergeCellHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">// è®¾ç½®å•å…ƒæ ¼çš„é£æ ¼æ ·å¼</span>
                <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">(</span>headStyle<span class="token punctuation">,</span> bodyStyle<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 5å†™å…¥excelæ•°æ®</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 6é€šçŸ¥æµè§ˆå™¨ä»¥é™„ä»¶çš„å½¢å¼ä¸‹è½½å¤„ç†ï¼Œè®¾ç½®è¿”å›å¤´è¦æ³¨æ„æ–‡ä»¶åæœ‰ä¸­æ–‡</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-disposition&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attachment;filename=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;å®¢æˆ·ä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;gb2312&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;ISO8859-1&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.xlsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;multipart/form-data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¯¼å‡ºè¡¨æ ¼ ä¸€å¯¹å¤šæ ¼å¼æ•°æ® æ¨¡æ‹Ÿæ•°æ®</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Customer</span><span class="token punctuation">&gt;</span></span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Customer</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Customer</span> customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;JiangXi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ±Ÿè¥¿ç”µä¿¡å…¬å¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ±Ÿè¥¿çœå—æ˜Œå¸‚ä¸œæ¹–åŒº&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;12345678910&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">&quot;https://m.360buyimg.com/babel/jfs/t1/221733/11/14107/61280/62fde84dE467522ce/79bbd42aa93f5a83.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Customer</span> customer2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;JiangXi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ±Ÿè¥¿ç”µä¿¡å…¬å¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ±Ÿè¥¿çœå—æ˜Œå¸‚ä¸œæ¹–åŒº&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æå››&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15848563521&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">&quot;https://m.360buyimg.com/babel/jfs/t1/221733/11/14107/61280/62fde84dE467522ce/79bbd42aa93f5a83.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customer2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Customer</span> customer3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;GuangDong&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹¿ä¸œç”µä¿¡å…¬å¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹¿ä¸œçœå¹¿å·å¸‚èŠ±éƒ½åŒº&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°æ˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15847953624&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">&quot;https://m.360buyimg.com/babel/jfs/t1/215924/36/19623/23344/62baa985E4df523c6/4893237860b306d6.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customer3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Customer</span> customer4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;GuangDong&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹¿ä¸œç”µä¿¡å…¬å¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹¿ä¸œçœå¹¿å·å¸‚å¤©æ²³åŒº&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°çº¢&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;16849531548&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">&quot;https://m.360buyimg.com/babel/jfs/t1/189640/15/26493/35837/62baa97eE6abda209/461f91e682d0e81a.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customer4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Customer</span> customer5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;GuangDong&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹¿ä¸œç”µä¿¡å…¬å¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹¿ä¸œçœå¹¿å·å¸‚å¤©æ²³åŒº&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°å&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;16985632481&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">&quot;https://m.360buyimg.com/babel/jfs/t1/189640/15/26493/35837/62baa97eE6abda209/461f91e682d0e81a.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customer5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Customer</span> customer6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åŒ—äº¬ç”µä¿¡å…¬å¸&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åŒ—äº¬å¸‚ä¸œåŸåŒº&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å§œç»´&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;16598645874&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">&quot;https://m.360buyimg.com/babel/jfs/t1/31481/11/16081/24873/62baa97dE6f3991d0/94ae13d66b9bbfdd.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customer6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> gb2312 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;å®¢æˆ·ä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;gb2312&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;ISO8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gb2312<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="åŸºæœ¬å¯¼å‡º"><a href="#åŸºæœ¬å¯¼å‡º" class="header-anchor">#</a> åŸºæœ¬å¯¼å‡º</h2> <h3 id="å®ä½“ç±»-2"><a href="#å®ä½“ç±»-2" class="header-anchor">#</a> å®ä½“ç±»</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoData</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ•°å­—æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="è¡¨ç°å±‚-3"><a href="#è¡¨ç°å±‚-3" class="header-anchor">#</a> è¡¨ç°å±‚</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * æŒ‡å®šåˆ—å¯¼å‡º: @ExcelProperty(value = &quot;åˆ—å&quot;, index = åˆ—å·)
 * @param response
 * @throws IOException
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;download&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æŒ‡å®šåˆ—å¯¼å‡º&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DemoData</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¤šè¡¨æ ¼sheetçš„åç§° ä¸æ˜¯å¯¼å‡ºè¡¨æ ¼æ–‡ä»¶çš„åç§°</span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;åŸºç¡€å¯¼å‡ºæµ‹è¯•&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token class-name">DemoData</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å‡ºæ¨¡æ¿ç¤ºä¾‹"><a href="#å¯¼å‡ºæ¨¡æ¿ç¤ºä¾‹" class="header-anchor">#</a> å¯¼å‡ºæ¨¡æ¿ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230811083802278.png" alt="image-20230811083802278"></p> <h2 id="å¤æ‚å¤´å¯¼å‡º"><a href="#å¤æ‚å¤´å¯¼å‡º" class="header-anchor">#</a> å¤æ‚å¤´å¯¼å‡º</h2> <h3 id="å®ä½“ç±»åŠæ ·å¼"><a href="#å®ä½“ç±»åŠæ ·å¼" class="header-anchor">#</a> å®ä½“ç±»åŠæ ·å¼</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FuZhaTou</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;é‡‘é¢æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230811085032704.png" alt="image-20230811085032704"></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FuZhaTou</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;é‡‘é¢æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230811101825564.png" alt="image-20230811101825564"></p> <h3 id="è¡¨ç°å±‚-4"><a href="#è¡¨ç°å±‚-4" class="header-anchor">#</a> è¡¨ç°å±‚</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º: @ExcelProperty(value = {&quot;ä¸»æ ‡é¢˜&quot;,&quot;äºŒçº§æ ‡é¢˜&quot;, &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;}, index = 0)
* 1. å¤šçº§æ ‡é¢˜: value ä¸ºæ•°ç»„, éœ€è¦ä¸€ä¸€å¯¹åº”
* @param response
* @throws IOException
*/</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadFuZhaTou&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFuZhaTou</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FuZhaTou</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å¯¼å‡ºå¤šä¸ªsheet-åŒå¯¹è±¡"><a href="#å¯¼å‡ºå¤šä¸ªsheet-åŒå¯¹è±¡" class="header-anchor">#</a> å¯¼å‡ºå¤šä¸ªsheet(åŒå¯¹è±¡)</h2> <h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="header-anchor">#</a> æ³¨æ„ç‚¹</h3> <ol><li>å¯¼å‡ºå¤šä¸ªsheetè¡¨æ ¼: æ¯ä¸ªsheetè¡¨æ ¼å¯¹åº”ä¸€ä¸ªå¯¹è±¡</li> <li>sheetè¡¨æ ¼åç§°: key (åç§°ä¸èƒ½ç›¸åŒ) æ•°æ®é›†åˆ: value (æ•°æ®é›†åˆçš„å¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ä¸ªå¯¹è±¡)</li></ol> <h3 id="ä»£ç ç¤ºä¾‹-4"><a href="#ä»£ç ç¤ºä¾‹-4" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FuZhaTou</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;é‡‘é¢æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadFuZhaTouSheets&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡ºå¤šä¸ªsheetåŒå¯¹è±¡é›†åˆ&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFuZhaTouSheets</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> data1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FuZhaTou</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FuZhaTou</span> datas1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas1<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;is ç‰› pisad&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas1<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas1<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">15.2999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        data1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> ls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet1&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet2&quot;</span><span class="token punctuation">,</span> data1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadSheets</span><span class="token punctuation">(</span>ls<span class="token punctuation">,</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å‡ºæ ·å¼ç¤ºä¾‹"><a href="#å¯¼å‡ºæ ·å¼ç¤ºä¾‹" class="header-anchor">#</a> å¯¼å‡ºæ ·å¼ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230811112812788.png" alt="image-20230811112812788"></p> <h2 id="å¯¼å‡ºå¤šä¸ªsheet-ä¸åŒå¯¹è±¡"><a href="#å¯¼å‡ºå¤šä¸ªsheet-ä¸åŒå¯¹è±¡" class="header-anchor">#</a> å¯¼å‡ºå¤šä¸ªsheet(ä¸åŒå¯¹è±¡)</h2> <h3 id="æ³¨æ„ç‚¹-2"><a href="#æ³¨æ„ç‚¹-2" class="header-anchor">#</a> æ³¨æ„ç‚¹</h3> <ol><li>å¯¼å‡ºå¤šä¸ªsheetè¡¨æ ¼: æ¯ä¸ªsheetè¡¨æ ¼å¯¹åº”ä¸€ä¸ªå¯¹è±¡, å¯ä»¥ä¸ºä¸åŒçš„å®ä½“ç±»å¯¹è±¡</li> <li>å¯¼å‡ºçš„æ•°æ®é›†åˆä¸ºç©ºå°†ä¸ä¼šå¯¼å‡º ä¼šè·³è¿‡</li></ol> <h3 id="ä»£ç ç¤ºä¾‹-5"><a href="#ä»£ç ç¤ºä¾‹-5" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FuZhaTou</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸»æ ‡é¢˜&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§æ ‡é¢˜ä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;é‡‘é¢æ ‡é¢˜&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoData</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ•°å­—æ ‡é¢˜&quot;</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadFuZhaTouSheetsNo&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡ºå¤šä¸ªsheetä¸åŒå¯¹è±¡é›†åˆ&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFuZhaTouSheetsNo</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DemoData</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DemoData</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²aaa&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">9.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FuZhaTou</span><span class="token punctuation">&gt;</span></span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FuZhaTou</span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FuZhaTou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;å­—ç¬¦ä¸²bbb&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        datas<span class="token punctuation">.</span><span class="token function">setDoubleData</span><span class="token punctuation">(</span><span class="token number">0.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        b<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> ls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet1-æ ‡ç­¾aaa&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ls<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;sheet2-æ ‡ç­¾bbb&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadSheetsNo</span><span class="token punctuation">(</span>ls<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å‡ºæ ·å¼ç¤ºä¾‹-2"><a href="#å¯¼å‡ºæ ·å¼ç¤ºä¾‹-2" class="header-anchor">#</a> å¯¼å‡ºæ ·å¼ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230811151344549.png" alt="image-20230811151344549"></p> <h2 id="å¯¼å‡ºè‡ªå®šä¹‰æ ¼å¼è½¬æ¢"><a href="#å¯¼å‡ºè‡ªå®šä¹‰æ ¼å¼è½¬æ¢" class="header-anchor">#</a> å¯¼å‡ºè‡ªå®šä¹‰æ ¼å¼è½¬æ¢</h2> <h3 id="ä»£ç ç¤ºä¾‹-6"><a href="#ä»£ç ç¤ºä¾‹-6" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <ul><li>ç‰¹åˆ«æ³¨æ„ è½¬åŒ–çš„å­—æ®µç±»å‹éœ€è¦è·Ÿè½¬æ¢å™¨æŒ‡å®šçš„ç±»å‹ä¸€è‡´ å¦åˆ™ä¸ä¼šä½¿ç”¨åˆ°è½¬æ¢å™¨</li></ul> <blockquote><p>è¡¨ç°å±‚</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadChange&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ ‡é¢˜æŒ‡å®šåˆ—å¯¼å‡º æ•°æ®è½¬æ¢&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadChange</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConverterData</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ConverterData</span> nv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConverterData</span><span class="token punctuation">(</span><span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8.25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ConverterData</span> nan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConverterData</span><span class="token punctuation">(</span><span class="token string">&quot;å°å¢&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4.77</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nan<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token class-name">ConverterData</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-è½¬æ¢&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å®ä½“ç±»</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token annotation punctuation">@NoArgsConstructor</span> <span class="token comment">// æ— å‚æ„é€ æ–¹æ³•</span>
<span class="token annotation punctuation">@AllArgsConstructor</span> <span class="token comment">// å…¨å‚æ„æ„é€ æ–¹æ³•</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConverterData</span> <span class="token punctuation">{</span>
    
    <span class="token comment">/**
     * converter: è‡ªå®šä¹‰è½¬æ¢å™¨ åå­—å‰é¢åŠ ä¸Š: è‡ªå®šä¹‰-name
     */</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;å§“å&quot;</span><span class="token punctuation">,</span> converter <span class="token operator">=</span> <span class="token class-name">CustomStringStringConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token comment">/**
     * converter: è‡ªå®šä¹‰è½¬æ¢å™¨ 1-ç”· 0-å¥³
     */</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ€§åˆ«&quot;</span><span class="token punctuation">,</span> converter <span class="token operator">=</span> <span class="token class-name">SexConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> sex<span class="token punctuation">;</span>
    <span class="token comment">/**
     * æˆ‘æƒ³å†™åˆ°excel ç”¨å¹´æœˆæ—¥çš„æ ¼å¼
     */</span>
    <span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyyyå¹´MMæœˆddæ—¥HHæ—¶mmåˆ†ssç§’&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token string">&quot;æ—¥æœŸæ ‡é¢˜&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>
    <span class="token comment">/**
     * æˆ‘æƒ³å†™åˆ°excel ç”¨ç™¾åˆ†æ¯”è¡¨ç¤º
     */</span>
    <span class="token annotation punctuation">@NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;#.##%&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ•°å­—æ ‡é¢˜&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> doubleData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>converter: è‡ªå®šä¹‰è½¬æ¢å™¨</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>converters<span class="token punctuation">.</span></span><span class="token class-name">Converter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>converters<span class="token punctuation">.</span></span><span class="token class-name">ReadConverterContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>converters<span class="token punctuation">.</span></span><span class="token class-name">WriteConverterContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token class-name">WriteCellData</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * è‡ªå®šä¹‰ç±»å‹è½¬æ¢åŠ è½½å™¨ 1-ç”· 0-å¥³
 * ç”¨äºå°† Excel å•å…ƒæ ¼ä¸­çš„å€¼è½¬æ¢ä¸º Java å¯¹è±¡ï¼Œä»¥åŠå°† Java å¯¹è±¡è½¬æ¢ä¸º Excel å•å…ƒæ ¼ä¸­çš„å€¼
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SexConverter</span> <span class="token keyword">implements</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * ç”¨äºæŒ‡å®šè¯¥è½¬æ¢å™¨æ”¯æŒçš„ Java ç±»å‹:
	 * 1. åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œä½ è¿”å›äº† Integer.classï¼Œè¿™è¡¨ç¤ºè¯¥è½¬æ¢å™¨æ”¯æŒå°†æ•´æ•°å€¼è½¬æ¢ä¸º Excel å•å…ƒæ ¼ä¸­çš„å­—ç¬¦ä¸²ï¼Œ
	 * 2. ä»¥åŠå°† Excel å•å…ƒæ ¼ä¸­çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°
	 * @return
	 */</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Class</span> <span class="token function">supportJavaTypeKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * ç”¨äºæŒ‡å®šè¯¥è½¬æ¢å™¨æ”¯æŒçš„ Excel æ•°æ®ç±»å‹:
	 * 1. åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œä½ è¿”å›äº† CellDataTypeEnum.STRINGï¼Œè¿™è¡¨ç¤ºè¯¥è½¬æ¢å™¨æ”¯æŒåœ¨ Excel ä¸­ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹æ¥è¡¨ç¤ºæ•°æ®
	 * @return
	 */</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">CellDataTypeEnum</span> <span class="token function">supportExcelTypeKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>STRING<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * è¿™ä¸ªæ–¹æ³•åœ¨ä» Excel è¯»å–æ•°æ®æ—¶è°ƒç”¨:
	 * 1. ç”¨äºå°† Excel å•å…ƒæ ¼ä¸­çš„å€¼è½¬æ¢ä¸º Java å¯¹è±¡ã€‚åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œå®ƒå°† &quot;ç”·&quot; è½¬æ¢ä¸ºæ•´æ•°å€¼ 1ï¼Œå°† &quot;å¥³&quot; è½¬æ¢ä¸ºæ•´æ•°å€¼ 0
	 * 2. context.getReadCellData().getStringValue() è·å–åˆ°çš„æ˜¯å•å…ƒæ ¼çš„å€¼
	 * @return
	 * @throws Exception
	 */</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">convertToJavaData</span><span class="token punctuation">(</span><span class="token class-name">ReadConverterContext</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> context<span class="token punctuation">.</span><span class="token function">getReadCellData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;ç”·ç”Ÿ&quot;</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token comment">/**
	 * è¿™ä¸ªæ–¹æ³•åœ¨å°†æ•°æ®å†™å…¥ Excel æ—¶è°ƒç”¨:
	 * 1. ç”¨äºå°† Java å¯¹è±¡è½¬æ¢ä¸º Excel å•å…ƒæ ¼ä¸­çš„å€¼ã€‚åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œå®ƒå°†æ•´æ•°å€¼ 1 è½¬æ¢ä¸ºå­—ç¬¦ä¸² &quot;ç”·&quot;ï¼Œå°†æ•´æ•°å€¼ 0 è½¬æ¢ä¸ºå­—ç¬¦ä¸² &quot;å¥³&quot;
	 * 2. context.getValue() è·å–åˆ°çš„æ˜¯å¯¼å‡ºå­—æ®µçš„å€¼
	 * @return
	 * @throws Exception
	 */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">convertToExcelData</span><span class="token punctuation">(</span><span class="token class-name">WriteConverterContext</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">&quot;ç”·ç”Ÿ&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å¥³ç”Ÿ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>converters<span class="token punctuation">.</span></span><span class="token class-name">Converter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>converters<span class="token punctuation">.</span></span><span class="token class-name">ReadConverterContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>converters<span class="token punctuation">.</span></span><span class="token class-name">WriteConverterContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token class-name">WriteCellData</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * String and string converter
 *
 * @author Jiaju Zhuang
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomStringStringConverter</span> <span class="token keyword">implements</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">supportJavaTypeKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CellDataTypeEnum</span> <span class="token function">supportExcelTypeKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>STRING<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * è¿™é‡Œè¯»çš„æ—¶å€™ä¼šè°ƒç”¨
     * @return
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convertToJavaData</span><span class="token punctuation">(</span><span class="token class-name">ReadConverterContext</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;è‡ªå®šä¹‰ï¼š&quot;</span> <span class="token operator">+</span> context<span class="token punctuation">.</span><span class="token function">getReadCellData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * è¿™é‡Œæ˜¯å†™çš„æ—¶å€™ä¼šè°ƒç”¨ ä¸ç”¨ç®¡
     * @return
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">convertToExcelData</span><span class="token punctuation">(</span><span class="token class-name">WriteConverterContext</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;è‡ªå®šä¹‰ï¼š&quot;</span> <span class="token operator">+</span> context<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹"><a href="#å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹" class="header-anchor">#</a> å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230811162259175.png" alt="image-20230811162259175"></p> <h2 id="å›¾ç‰‡å¯¼å‡º"><a href="#å›¾ç‰‡å¯¼å‡º" class="header-anchor">#</a> å›¾ç‰‡å¯¼å‡º</h2> <blockquote><p>å¯ä½¿ç”¨æœ¬åœ°æˆ–è€…ç½‘ç»œå›¾ç‰‡è¿›è¡Œå¯¼å‡º / å­—æ®µä¸ºå®ä½“ç±»åœ°å€å¯¼å‡ºåŠ ä¸Š è½¬æ¢å™¨å³å¯ converter = StringImageConverter.class</p></blockquote> <h3 id="ä»£ç ç¤ºä¾‹-7"><a href="#ä»£ç ç¤ºä¾‹-7" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <h4 id="å®ä½“ç±»-3"><a href="#å®ä½“ç±»-3" class="header-anchor">#</a> å®ä½“ç±»</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>ex</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExcelProperty</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">ColumnWidth</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">ContentRowHeight</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>converters<span class="token punctuation">.</span>string<span class="token punctuation">.</span></span><span class="token class-name">StringImageConverter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token class-name">WriteCellData</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URL<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@NoArgsConstructor</span> <span class="token comment">// æ— å‚æ„é€ æ–¹æ³•</span>
<span class="token annotation punctuation">@AllArgsConstructor</span> <span class="token comment">// å…¨å‚æ„æ„é€ æ–¹æ³•</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span> <span class="token comment">// é‡å†™equalså’Œhashcodeæ–¹æ³•</span>
<span class="token annotation punctuation">@ContentRowHeight</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">// æ–‡æœ¬è¡Œé«˜åº¦</span>
<span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token comment">// åˆ—å®½åº¦</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImageDemoApai</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å§“å&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹´é¾„&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚è€ƒå›¾ç‰‡&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¤´åƒ-File&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">File</span> file<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚è€ƒå›¾ç‰‡&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¤§å¤´è´´-InputStream&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">InputStream</span> inputStream<span class="token punctuation">;</span>

    <span class="token comment">/**
     * å¦‚æœstringç±»å‹ å¿…é¡»æŒ‡å®šè½¬æ¢å™¨ï¼Œstringé»˜è®¤è½¬æ¢æˆstring
     */</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚è€ƒå›¾ç‰‡&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;èº«ä»½è¯ç…§ç‰‡-String&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> converter <span class="token operator">=</span> <span class="token class-name">StringImageConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> string<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚è€ƒå›¾ç‰‡&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä½å€ç…§ç‰‡-byte[]&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> byteArray<span class="token punctuation">;</span>

    <span class="token comment">/**
     * æ ¹æ®urlå¯¼å‡º
     *
     * @since 2.1.1
     */</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚è€ƒå›¾ç‰‡&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¾®ä¿¡ç½‘å›¾&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">URL</span> url<span class="token punctuation">;</span>

    <span class="token comment">/**
     * æ ¹æ®æ–‡ä»¶å¯¼å‡º å¹¶è®¾ç½®å¯¼å‡ºçš„ä½ç½®ã€‚
     * å¤šå›¾ç‰‡å¯¼å‡º å åŠ ä¸€ä¸ªå•å…ƒæ ¼ä¸­
     * @since 3.0.0-beta1
     */</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ä¸ªäººä¿¡æ¯è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚è€ƒå›¾ç‰‡&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸ªäººå›¾é›†&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> writeCellDataFile<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="è¡¨ç°å±‚-5"><a href="#è¡¨ç°å±‚-5" class="header-anchor">#</a> è¡¨ç°å±‚</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadImage&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºå›¾ç‰‡è¡¨æ ¼&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadImage</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
    <span class="token class-name">String</span> imagePath1 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-16-48.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath2 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\4bad14d0347d48cfb774bbc4e394629c.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath3 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-17.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath4 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-47.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath6 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_14-56-46.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath7 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-30_14-51-55.png&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
    <span class="token class-name">String</span> imagePath5 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503204942958.png&quot;</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageDemoApai</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span>  <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ImageDemoApai</span> imageDemoApai <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">(</span><span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setInputStream</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">openInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>imagePath3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setByteArray</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span>imagePath5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. å¤šä¸ªå›¾ç‰‡-éœ€è¦é¢å¤–æ”¾å…¥æ–‡å­—-è€Œä¸”éœ€è¦æ”¾å…¥2ä¸ªå›¾ç‰‡-ç¬¬ä¸€ä¸ªå›¾ç‰‡é å·¦-ç¬¬äºŒä¸ªé å³-è€Œä¸”è¦é¢å¤–çš„å ç”¨ä»–åé¢çš„å•å…ƒæ ¼</span>
    <span class="token comment">// 2. åˆ›å»ºWriteCellDataå¯¹è±¡ç„¶åèµ‹å€¼åˆ°å¯¹åº”çš„å¯¹è±¡ä¸­</span>
    <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> writeCellData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setWriteCellDataFile</span><span class="token punctuation">(</span>writeCellData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3. é…ç½®WriteCellDataå¯¹è±¡, è¿™é‡Œå¯ä»¥è®¾ç½®ä¸º EMPTY åˆ™ä»£è¡¨ä¸éœ€è¦å…¶ä»–æ•°æ®äº†</span>
    writeCellData<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>
    writeCellData<span class="token punctuation">.</span><span class="token function">setStringValue</span><span class="token punctuation">(</span><span class="token string">&quot;é¢å¤–çš„æ”¾ä¸€äº›æ–‡å­—,è¿™é‡Œæ˜¯å¤šä¸ªå›¾ç‰‡çš„è¡¨æ ¼å•å…ƒæ ¼...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 4. åˆ›å»ºå¯¹åº”å¯¹è±¡è¿›è¡Œå­˜å‚¨, å¯ä»¥æ”¾å…¥å¤šä¸ªå›¾ç‰‡</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageData</span><span class="token punctuation">&gt;</span></span> imageDataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ImageData</span> imageData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    writeCellData<span class="token punctuation">.</span><span class="token function">setImageDataList</span><span class="token punctuation">(</span>imageDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 5. æ”¾å…¥2è¿›åˆ¶å›¾ç‰‡-è®¾ç½®å›¾ç‰‡ç±»å‹</span>
    imageData<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setImageType</span><span class="token punctuation">(</span><span class="token class-name">ImageData<span class="token punctuation">.</span>ImageType</span><span class="token punctuation">.</span>PICTURE_TYPE_PNG<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 6. é…ç½®å›¾ç‰‡åœ¨å•å…ƒæ ¼çš„æ ·å¼ (ä¸Š/å³/ä¸‹/å·¦ éœ€è¦ç•™ç©º è¿™ä¸ªç±»ä¼¼äº css çš„ margin) è¿™é‡Œå®æµ‹ ä¸èƒ½è®¾ç½®å¤ªå¤§ è¶…è¿‡å•å…ƒæ ¼åŸå§‹å¤§å°å æ‰“å¼€ä¼šæç¤ºä¿®å¤ã€‚æš‚æ—¶æœªæ‰¾åˆ°å¾ˆå¥½çš„è§£æ³•ã€‚</span>
    imageData<span class="token punctuation">.</span><span class="token function">setTop</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRight</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setBottom</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setLeft</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 7. æ”¾å…¥ç¬¬äºŒä¸ªå›¾ç‰‡ å’Œæ”¾å…¥ç¬¬ä¸€ä¸ªå›¾ç‰‡ä¸€æ ·çš„æ“ä½œ</span>
    imageData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    writeCellData<span class="token punctuation">.</span><span class="token function">setImageDataList</span><span class="token punctuation">(</span>imageDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath7<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setImageType</span><span class="token punctuation">(</span><span class="token class-name">ImageData<span class="token punctuation">.</span>ImageType</span><span class="token punctuation">.</span>PICTURE_TYPE_PNG<span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setTop</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRight</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setBottom</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setLeft</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 8. è®¾ç½®å›¾ç‰‡çš„ä½ç½® å‡è®¾ ç°åœ¨ç›®æ ‡ æ˜¯ è¦†ç›– å½“å‰å•å…ƒæ ¼ å’Œå½“å‰å•å…ƒæ ¼å³è¾¹çš„å•å…ƒæ ¼ / èµ·ç‚¹ç›¸å¯¹äºå½“å‰å•å…ƒæ ¼ä¸º0 å½“ç„¶å¯ä»¥ä¸å†™</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstColumnIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 9. å‰é¢3ä¸ªå¯ä»¥ä¸å†™ ä¸‹é¢è¿™ä¸ªéœ€è¦å†™ ä¹Ÿå°±æ˜¯ ç»“å°¾ éœ€è¦ç›¸å¯¹å½“å‰å•å…ƒæ ¼ å¾€å³ç§»åŠ¨ä¸€æ ¼ / ä¹Ÿå°±æ˜¯è¯´ è¿™ä¸ªå›¾ç‰‡ä¼šè¦†ç›–å½“å‰å•å…ƒæ ¼å’Œ åé¢çš„é‚£ä¸€æ ¼</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastColumnIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å­˜å‚¨åˆ°listä¸­ è¿›è¡Œå¯¼å‡º</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageDemoApai<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-å›¾ç‰‡&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadImageUtil&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºå›¾ç‰‡è¡¨æ ¼ ä½¿ç”¨å·¥å…·ç±»&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadImageUtil</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
    <span class="token class-name">String</span> imagePath1 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-16-48.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath2 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\4bad14d0347d48cfb774bbc4e394629c.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath3 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-17.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath4 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_09-17-47.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath6 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-25_14-56-46.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> imagePath7 <span class="token operator">=</span> <span class="token string">&quot;D:\\Apai-HKWL\\Apai-App\\Apai_wxafter\\upload\\cscscs\\2023-07-20\\Snipaste_2023-05-30_14-51-55.png&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
    <span class="token class-name">String</span> imagePath5 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503204942958.png&quot;</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageDemoApai</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span>  <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ImageDemoApai</span> imageDemoApai <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">(</span><span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å›¾ç‰‡ä½ç½® æœ¬åœ°-ç»å¯¹è·¯å¾„</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setFile</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath1<span class="token punctuation">,</span> <span class="token class-name">File</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setInputStream</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath2<span class="token punctuation">,</span> <span class="token class-name">InputStream</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>imagePath3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setByteArray</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath4<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>imagePath5<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imagePath6<span class="token punctuation">)</span><span class="token punctuation">;</span>
    strs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imagePath7<span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageDemoApai<span class="token punctuation">.</span><span class="token function">setWriteCellDataFile</span><span class="token punctuation">(</span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> <span class="token string">&quot;cså¤šä¸ªå›¾ç‰‡&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å­˜å‚¨åˆ°listä¸­ è¿›è¡Œå¯¼å‡º</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageDemoApai<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownload</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token class-name">ImageDemoApai</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-å›¾ç‰‡&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å·¥å…·ç±»æ–¹æ³•"><a href="#å·¥å…·ç±»æ–¹æ³•" class="header-anchor">#</a> å·¥å…·ç±»æ–¹æ³•</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * å¯¼å‡ºè¡¨æ ¼å›¾ç‰‡ (å•ä¸ªå›¾ç‰‡): æ ¼å¼æµè½¬æ¢
 * @param imagePath å›¾ç‰‡è·¯å¾„ (æœ¬åœ°è·¯å¾„) (ç½‘ç»œè·¯å¾„)
 * @param typeClazz è½¬æ¢çš„ç±»å‹ (File.class, InputStream.class, byte[].class, URL.class)
 * @return è¿”å›è½¬æ¢åçš„ç±»å‹
 * @param &lt;T&gt; æ³›å‹
 * @throws IOException
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">imageConvert</span><span class="token punctuation">(</span><span class="token class-name">String</span> imagePath<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> typeClazz<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ¤æ–­ç±»å‹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> <span class="token class-name">File</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> <span class="token class-name">InputStream</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">openInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>typeClazz <span class="token operator">==</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * å¯¼å‡ºè¡¨æ ¼å›¾ç‰‡ (å¤šä¸ªå›¾ç‰‡): æ ¼å¼æµè½¬æ¢, å¤šå¼ å›¾ç‰‡ä¼šå åŠ åœ¨ä¸€ä¸ªå•å…ƒæ ¼ä¸­
 * @param imagePaths å›¾ç‰‡è·¯å¾„ (æœ¬åœ°è·¯å¾„)
 * @param wordStr å›¾ç‰‡åœ°ä¸‹å•å…ƒæ ¼å¯¹åº”çš„æ–‡å­—
 * @return è¿”å›è½¬æ¢åçš„ç±»å‹
 * @throws IOException æŠ›å‡ºå¼‚å¸¸
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">imageConvert</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> imagePaths<span class="token punctuation">,</span> <span class="token class-name">String</span> wordStr<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> writeCellData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1. é…ç½®WriteCellDataå¯¹è±¡, è¿™é‡Œå¯ä»¥è®¾ç½®ä¸º EMPTY åˆ™ä»£è¡¨ä¸éœ€è¦å…¶ä»–æ•°æ®äº†</span>
    writeCellData<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span>STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>
    writeCellData<span class="token punctuation">.</span><span class="token function">setStringValue</span><span class="token punctuation">(</span>wordStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageData</span><span class="token punctuation">&gt;</span></span> imageDataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ImageData</span> imageData <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">// 2. åˆ›å»ºå¯¹åº”å¯¹è±¡è¿›è¡Œå­˜å‚¨, å¯ä»¥æ”¾å…¥å¤šä¸ªå›¾ç‰‡</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> imagePath <span class="token operator">:</span> imagePaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        imageData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. æ”¾å…¥2è¿›åˆ¶å›¾ç‰‡-è®¾ç½®å›¾ç‰‡ç±»å‹</span>
        imageData<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>imagePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setImageType</span><span class="token punctuation">(</span><span class="token class-name">ImageData<span class="token punctuation">.</span>ImageType</span><span class="token punctuation">.</span>PICTURE_TYPE_PNG<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 4. é…ç½®å›¾ç‰‡åœ¨å•å…ƒæ ¼çš„æ ·å¼ (ä¸Š/å³/ä¸‹/å·¦ éœ€è¦ç•™ç©º è¿™ä¸ªç±»ä¼¼äº css çš„ margin) è¿™é‡Œå®æµ‹ ä¸èƒ½è®¾ç½®å¤ªå¤§ è¶…è¿‡å•å…ƒæ ¼åŸå§‹å¤§å°å æ‰“å¼€ä¼šæç¤ºä¿®å¤ã€‚æš‚æ—¶æœªæ‰¾åˆ°å¾ˆå¥½çš„è§£æ³•ã€‚</span>
        imageData<span class="token punctuation">.</span><span class="token function">setTop</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setRight</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setBottom</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        imageData<span class="token punctuation">.</span><span class="token function">setLeft</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 5. èµ‹å€¼</span>
        imageDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writeCellData<span class="token punctuation">.</span><span class="token function">setImageDataList</span><span class="token punctuation">(</span>imageDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 6. è®¾ç½®å›¾ç‰‡çš„ä½ç½® å‡è®¾ ç°åœ¨ç›®æ ‡ æ˜¯ è¦†ç›– å½“å‰å•å…ƒæ ¼ å’Œå½“å‰å•å…ƒæ ¼å³è¾¹çš„å•å…ƒæ ¼ / èµ·ç‚¹ç›¸å¯¹äºå½“å‰å•å…ƒæ ¼ä¸º0 å½“ç„¶å¯ä»¥ä¸å†™</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeFirstColumnIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastRowIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 7. å‰é¢3ä¸ªå¯ä»¥ä¸å†™ ä¸‹é¢è¿™ä¸ªéœ€è¦å†™ ä¹Ÿå°±æ˜¯ ç»“å°¾ éœ€è¦ç›¸å¯¹å½“å‰å•å…ƒæ ¼ å¾€å³ç§»åŠ¨ä¸€æ ¼ / ä¹Ÿå°±æ˜¯è¯´ è¿™ä¸ªå›¾ç‰‡ä¼šè¦†ç›–å½“å‰å•å…ƒæ ¼å’Œ åé¢çš„é‚£ä¸€æ ¼</span>
    imageData<span class="token punctuation">.</span><span class="token function">setRelativeLastColumnIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> writeCellData<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-2"><a href="#å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-2" class="header-anchor">#</a> å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230812112515292.png" alt="image-20230812112515292"></p> <h2 id="å¤æ‚è¡Œ-ä¸€å¯¹å¤šå¯¼å‡º"><a href="#å¤æ‚è¡Œ-ä¸€å¯¹å¤šå¯¼å‡º" class="header-anchor">#</a> å¤æ‚è¡Œ-ä¸€å¯¹å¤šå¯¼å‡º</h2> <h3 id="ç®€æ¦‚"><a href="#ç®€æ¦‚" class="header-anchor">#</a> ç®€æ¦‚:</h3> <ol><li>è¿˜æ˜¯ä½¿ç”¨åŸºç¡€çš„å¯¼å‡º ä½†æ˜¯æ·»åŠ äº†Easy Excelè‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ å¯¹æŒ‡å®šçš„åˆ—è¿›è¡Œäº†åˆå¹¶å¤„ç†</li> <li>å›¾ç‰‡è¡Œå³ä½¿æŒ‡å®šäº†åˆå¹¶åˆ—ä¹Ÿæ— æ³•åˆå¹¶ (å°bugåç»­å†çœ‹è§£å†³æ–¹æ³•)</li> <li>å¯¹äºå¯¼å‡ºæ•°æ® å³ä¸€ä¸ªå®ä½“ç±» (ä¸POIçš„å¯¼å‡ºæ˜¯ä½¿ç”¨çš„æ ‘çº§ç»“æ„éœ€æ³¨æ„)</li></ol> <h3 id="ä»£ç ç¤ºä¾‹-8"><a href="#ä»£ç ç¤ºä¾‹-8" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <h4 id="å®ä½“ç±»ä»£ç "><a href="#å®ä½“ç±»ä»£ç " class="header-anchor">#</a> å®ä½“ç±»ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>ex</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExcelProperty</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">ColumnWidth</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">ContentRowHeight</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HeadRowHeight</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HeadStyle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">EqualsAndHashCode</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URL<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆget/setæ–¹æ³•</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆequalså’ŒhashCodeæ–¹æ³•</span>
<span class="token annotation punctuation">@NoArgsConstructor</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆæ— å‚æ„é€ æ–¹æ³•</span>
<span class="token annotation punctuation">@AllArgsConstructor</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆå…¨å‚æ„é€ æ–¹æ³•</span>

<span class="token annotation punctuation">@HeadRowHeight</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token comment">//è¡¨å¤´é«˜åº¦</span>
<span class="token annotation punctuation">@ContentRowHeight</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span> <span class="token comment">//å†…å®¹è¡Œé«˜åº¦</span>
<span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token comment">//åˆ—å®½</span>
<span class="token annotation punctuation">@HeadStyle</span><span class="token punctuation">(</span>fillForegroundColor <span class="token operator">=</span> <span class="token number">44</span><span class="token punctuation">)</span> <span class="token comment">//è¡¨å¤´æ ·å¼</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">School</span> <span class="token punctuation">{</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> schoolName<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡ç¼–ç &quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> schoolCode<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹´çº§åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> personName<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç­çº§åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> telephone<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿä¿¡æ¯&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿå§“å&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿä¿¡æ¯&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿå¹´é¾„&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡æ‰€åœ¨åœ°å€&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> schoolAddress<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡é¢„è§ˆ&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">URL</span> url<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="æ‹¦æˆªå™¨ä»£ç "><a href="#æ‹¦æˆªå™¨ä»£ç " class="header-anchor">#</a> æ‹¦æˆªå™¨ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span></span><span class="token class-name">Head</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token class-name">WriteCellData</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>handler<span class="token punctuation">.</span></span><span class="token class-name">CellWriteHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>holder<span class="token punctuation">.</span></span><span class="token class-name">WriteSheetHolder</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>holder<span class="token punctuation">.</span></span><span class="token class-name">WriteTableHolder</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">Cell</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">CellType</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">Sheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">CellRangeAddress</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Apai-è‡ªå®šä¹‰åˆå¹¶è¡Œ
 * @Description è‡ªå®šä¹‰å•å…ƒæ ¼åˆå¹¶å¤„ç†Handlerç±»
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExcelMergeCellHandler</span> <span class="token keyword">implements</span> <span class="token class-name">CellWriteHandler</span> <span class="token punctuation">{</span>

    <span class="token comment">// éœ€è¦åˆå¹¶çš„åˆ—ï¼Œä»0å¼€å§‹ç®— ä¾‹å¦‚ï¼šnew int[]{0, 1, 2, 3, 6, 7}</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mergeColIndex<span class="token punctuation">;</span>
    <span class="token comment">// ä»æŒ‡å®šçš„è¡Œå¼€å§‹åˆå¹¶ï¼Œä»0å¼€å§‹ç®— ä¾‹å¦‚ï¼š0-ä»ç¬¬ä¸€è¡Œæ•°æ®åˆ—å¼€å§‹åˆå¹¶ï¼Œ1-ä»ç¬¬äºŒè¡Œæ•°æ®åˆ—å¼€å§‹åˆå¹¶</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> mergeRowIndex<span class="token punctuation">;</span>

    <span class="token comment">/**
     * åœ¨å•å…ƒæ ¼ä¸Šçš„æ‰€æœ‰æ“ä½œå®Œæˆåè°ƒç”¨ï¼Œéå†æ¯ä¸€ä¸ªå•å…ƒæ ¼ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦å‘ä¸Šåˆå¹¶
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCellDispose</span><span class="token punctuation">(</span><span class="token class-name">WriteSheetHolder</span> writeSheetHolder<span class="token punctuation">,</span> <span class="token class-name">WriteTableHolder</span> writeTableHolder<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WriteCellData</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cellDataList<span class="token punctuation">,</span> <span class="token class-name">Cell</span> cell<span class="token punctuation">,</span> <span class="token class-name">Head</span> head<span class="token punctuation">,</span> <span class="token class-name">Integer</span> relativeRowIndex<span class="token punctuation">,</span> <span class="token class-name">Boolean</span> isHead<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–å½“å‰å•å…ƒæ ¼è¡Œä¸‹æ ‡</span>
        <span class="token keyword">int</span> currRowIndex <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getRowIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–å½“å‰å•å…ƒæ ¼åˆ—ä¸‹æ ‡</span>
        <span class="token keyword">int</span> currColIndex <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ¤æ–­æ˜¯å¦å¤§äºæŒ‡å®šè¡Œä¸‹æ ‡ï¼Œå¦‚æœå¤§äºåˆ™åˆ¤æ–­åˆ—æ˜¯å¦ä¹Ÿåœ¨æŒ‡å®šçš„éœ€è¦çš„åˆå¹¶å•å…ƒåˆ—é›†åˆä¸­</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currRowIndex <span class="token operator">&gt;</span> mergeRowIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mergeColIndex<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>currColIndex <span class="token operator">==</span> mergeColIndex<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">/**
                     * è·å–åˆ—è¡¨æ•°æ®çš„å”¯ä¸€æ ‡è¯†ã€‚ä¸åŒé›†åˆçš„æ•°æ®å³ä½¿æ•°å€¼ç›¸åŒä¹Ÿä¸åˆå¹¶
                     * æ³¨æ„ï¼šæˆ‘è¿™é‡Œçš„å”¯ä¸€æ ‡è¯†ä¸ºå®¢æˆ·ç¼–å·ï¼ˆCustomer.userCodeï¼‰ï¼Œåœ¨ç¬¬ä¸€åˆ—ï¼Œå³ä¸‹æ ‡ä¸º0ã€‚å¤§å®¶éœ€è¦ç»“åˆä¸šåŠ¡é€»è¾‘æ¥åšä¿®æ”¹
                     */</span>
                    <span class="token comment">// è·å–å½“å‰å•å…ƒæ ¼æ‰€åœ¨çš„è¡Œæ•°æ®çš„å”¯ä¸€æ ‡è¯†</span>
                    <span class="token class-name">Object</span> currCode <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// è·å–å½“å‰å•å…ƒæ ¼çš„æ­£ä¸Šæ–¹çš„å•å…ƒæ ¼æ‰€åœ¨çš„è¡Œæ•°æ®çš„å”¯ä¸€æ ‡è¯†</span>
                    <span class="token class-name">Object</span> preCode <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>currRowIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// åˆ¤æ–­ä¸¤æ¡æ•°æ®çš„æ˜¯å¦æ˜¯åŒä¸€é›†åˆï¼Œåªæœ‰åŒä¸€é›†åˆçš„æ•°æ®æ‰èƒ½åˆå¹¶å•å…ƒæ ¼</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>preCode<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>currCode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">// å¦‚æœéƒ½ç¬¦åˆæ¡ä»¶ï¼Œåˆ™å‘ä¸Šåˆå¹¶å•å…ƒæ ¼</span>
                        <span class="token function">mergeWithPrevRow</span><span class="token punctuation">(</span>writeSheetHolder<span class="token punctuation">,</span> cell<span class="token punctuation">,</span> currRowIndex<span class="token punctuation">,</span> currColIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å½“å‰å•å…ƒæ ¼å‘ä¸Šåˆå¹¶
     *
     * @param writeSheetHolder è¡¨æ ¼å¤„ç†å¥æŸ„
     * @param cell             å½“å‰å•å…ƒæ ¼
     * @param currRowIndex     å½“å‰è¡Œ
     * @param currColIndex     å½“å‰åˆ—
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">mergeWithPrevRow</span><span class="token punctuation">(</span><span class="token class-name">WriteSheetHolder</span> writeSheetHolder<span class="token punctuation">,</span> <span class="token class-name">Cell</span> cell<span class="token punctuation">,</span> <span class="token keyword">int</span> currRowIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> currColIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–å½“å‰å•å…ƒæ ¼æ•°å€¼</span>
        <span class="token class-name">Object</span> currData <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getCellTypeEnum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">CellType</span><span class="token punctuation">.</span>STRING <span class="token operator">?</span> cell<span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> cell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–å½“å‰å•å…ƒæ ¼æ­£ä¸Šæ–¹çš„å•å…ƒæ ¼å¯¹è±¡</span>
        <span class="token class-name">Cell</span> preCell <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>currRowIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span>currColIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–å½“å‰å•å…ƒæ ¼æ­£ä¸Šæ–¹çš„å•å…ƒæ ¼çš„æ•°å€¼</span>
        <span class="token class-name">Object</span> preData <span class="token operator">=</span> preCell<span class="token punctuation">.</span><span class="token function">getCellTypeEnum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">CellType</span><span class="token punctuation">.</span>STRING <span class="token operator">?</span> preCell<span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> preCell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†å½“å‰å•å…ƒæ ¼æ•°å€¼ä¸å…¶æ­£ä¸Šæ–¹å•å…ƒæ ¼çš„æ•°å€¼æ¯”è¾ƒ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>preData<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>currData<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Sheet</span> sheet <span class="token operator">=</span> writeSheetHolder<span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CellRangeAddress</span><span class="token punctuation">&gt;</span></span> mergeRegions <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getMergedRegions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å½“å‰å•å…ƒæ ¼çš„æ­£ä¸Šæ–¹å•å…ƒæ ¼æ˜¯å¦æ˜¯å·²åˆå¹¶å•å…ƒæ ¼</span>
            <span class="token keyword">boolean</span> isMerged <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mergeRegions<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isMerged<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">CellRangeAddress</span> address <span class="token operator">=</span> mergeRegions<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// è‹¥ä¸Šä¸€ä¸ªå•å…ƒæ ¼å·²ç»è¢«åˆå¹¶ï¼Œåˆ™å…ˆç§»å‡ºåŸæœ‰çš„åˆå¹¶å•å…ƒï¼Œå†é‡æ–°æ·»åŠ åˆå¹¶å•å…ƒ</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>address<span class="token punctuation">.</span><span class="token function">isInRange</span><span class="token punctuation">(</span>currRowIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> currColIndex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    sheet<span class="token punctuation">.</span><span class="token function">removeMergedRegion</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    address<span class="token punctuation">.</span><span class="token function">setLastRow</span><span class="token punctuation">(</span>currRowIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    sheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    isMerged <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// è‹¥ä¸Šä¸€ä¸ªå•å…ƒæ ¼æœªè¢«åˆå¹¶ï¼Œåˆ™æ–°å¢åˆå¹¶å•å…ƒ</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMerged<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">CellRangeAddress</span> cellRangeAddress <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CellRangeAddress</span><span class="token punctuation">(</span>currRowIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> currRowIndex<span class="token punctuation">,</span> currColIndex<span class="token punctuation">,</span> currColIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span>cellRangeAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å·¥å…·ç±»æ–¹æ³•ä»£ç "><a href="#å·¥å…·ç±»æ–¹æ³•ä»£ç " class="header-anchor">#</a> å·¥å…·ç±»æ–¹æ³•ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * å¯¼å‡º Excel è¡¨æ ¼ å±…ä¸­æ ·å¼ æŒ‡å®šæ‹¦æˆªå™¨(å¯å®ç°ä¸€å¯¹å¤šå¯¼å‡º)
 * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
 * @param dataList æ•°æ®é›†åˆ
 * @param entityClass å®ä½“ç±»
 * @param sheetName å¤šè¡¨æ ¼sheetçš„åç§° ä¸æ˜¯å¯¼å‡ºè¡¨æ ¼æ–‡ä»¶çš„åç§°
 * @param t æ‹¦æˆªå™¨
 * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
 * @param &lt;T&gt; æ‹¦æˆªå™¨æ³›å‹
 * @throws IOException æŠ›å‡ºå¼‚å¸¸
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> dataList<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entityClass<span class="token punctuation">,</span> <span class="token class-name">String</span> sheetName<span class="token punctuation">,</span> <span class="token class-name">T</span> t<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”</span>
    <span class="token function">collocateResponse</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1 è®¾ç½®è¡¨å¤´æ ·å¼</span>
    <span class="token class-name">WriteCellStyle</span> headStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1.1 è®¾ç½®è¡¨å¤´æ•°æ®å±…ä¸­</span>
    headStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2 è®¾ç½®è¡¨æ ¼å†…å®¹æ ·å¼</span>
    <span class="token class-name">WriteCellStyle</span> bodyStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.1 è®¾ç½®è¡¨æ ¼å†…å®¹æ°´å¹³å±…ä¸­</span>
    bodyStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.2 è®¾ç½®è¡¨æ ¼å†…å®¹å‚ç›´å±…ä¸­</span>
    bodyStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3 è®¾ç½®è¡¨æ ¼sheetæ ·å¼</span>
    <span class="token class-name">WriteSheet</span> sheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetNo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 4 æ‹¿åˆ°è¡¨æ ¼å¤„ç†å¯¹è±¡</span>
    <span class="token class-name">ExcelWriter</span> writer <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">needHead</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">excelType</span><span class="token punctuation">(</span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span>
            <span class="token comment">// è‡ªå®šä¹‰æ‹¦æˆªå™¨</span>
            <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">WriteHandler</span><span class="token punctuation">)</span> t<span class="token punctuation">)</span>
            <span class="token comment">// è®¾ç½®å•å…ƒæ ¼çš„é£æ ¼æ ·å¼</span>
            <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">(</span>headStyle<span class="token punctuation">,</span> bodyStyle<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 5 å†™å…¥excelæ•°æ®</span>
    writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 6 å…³é—­æµ</span>
    writer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="è¡¨ç°å±‚ä»£ç "><a href="#è¡¨ç°å±‚ä»£ç " class="header-anchor">#</a> è¡¨ç°å±‚ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadOneIs&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºè¡¨æ ¼ ä¸€å¯¹å¤šæ ¼å¼æ•°æ®&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadOneIs</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
    <span class="token class-name">String</span> url1 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503204942958.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> url2 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503211609233.png&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">School</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">School</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">School</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;è€åˆ˜&quot;</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">School</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°æ&quot;</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">School</span> s4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒå¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸ƒç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°å¢&quot;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">School</span> s5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒå¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">School</span> s6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;å»ºæ°´åˆä¸­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JS-78425&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åˆä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°ä¹&quot;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">&quot;å»ºæ°´è·¯ç½‘é‡‘è¡—é“27å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url2<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">School</span> s7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;å»ºæ°´åˆä¸­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JS-78425&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åˆä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°é¹…&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;å»ºæ°´è·¯ç½‘é‡‘è¡—é“27å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url2<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s4<span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s6<span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s7<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®éœ€è¦å¾…åˆå¹¶çš„è¡Œå’Œåˆ—ã€‚å‚æ•°1ï¼šæ•°å€¼æ•°ç»„ï¼ŒæŒ‡å®šéœ€è¦åˆå¹¶çš„åˆ—ï¼›å‚æ•°2ï¼šæ•°å€¼ï¼ŒæŒ‡å®šä»ç¬¬å‡ è¡Œå¼€å§‹åˆå¹¶</span>
    <span class="token class-name">ExcelMergeCellHandler</span> excelMergeCellHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelMergeCellHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span><span class="token string">&quot;å­¦æ ¡_ä¸€å¯¹å¤šæ•°æ®è¡¨&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">,</span> <span class="token class-name">School</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-å­¦æ ¡ä¿¡æ¯&quot;</span><span class="token punctuation">,</span> excelMergeCellHandler<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¯¼å‡ºåŸºç¡€è¡¨ å±…ä¸­æ ·å¼</span>
    <span class="token comment">// EasyExcelUtil.easyDownloadStyle(&quot;å­¦æ ¡_ä¸€å¯¹å¤šæ•°æ®è¡¨&quot;, list, School.class, &quot;sheet-å­¦æ ¡ä¿¡æ¯&quot;, response);</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-3"><a href="#å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-3" class="header-anchor">#</a> å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230814102948398.png" alt="image-20230814102948398"></p> <h2 id="è®¾ç½®å†»ç»“ç­›é€‰å¤´"><a href="#è®¾ç½®å†»ç»“ç­›é€‰å¤´" class="header-anchor">#</a> è®¾ç½®å†»ç»“ç­›é€‰å¤´</h2> <h3 id="ç®€æ¦‚-2"><a href="#ç®€æ¦‚-2" class="header-anchor">#</a> ç®€æ¦‚:</h3> <ol><li>è¿˜æ˜¯ä½¿ç”¨åŸºç¡€çš„å¯¼å‡º ä½†æ˜¯æ·»åŠ äº†Easy Excelè‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ è®¾ç½®å†»ç»“ç­›é€‰å¤´</li> <li>å‚è€ƒä¸Šæ–¹ ä¸€å¯¹å¤š</li></ol> <h3 id="ä»£ç ç¤ºä¾‹-9"><a href="#ä»£ç ç¤ºä¾‹-9" class="header-anchor">#</a> ä»£ç ç¤ºä¾‹</h3> <h4 id="å®ä½“ç±»ä»£ç -2"><a href="#å®ä½“ç±»ä»£ç -2" class="header-anchor">#</a> å®ä½“ç±»ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>ex</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExcelProperty</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">ColumnWidth</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">ContentRowHeight</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HeadRowHeight</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HeadStyle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">EqualsAndHashCode</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URL<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆget/setæ–¹æ³•</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆequalså’ŒhashCodeæ–¹æ³•</span>
<span class="token annotation punctuation">@NoArgsConstructor</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆæ— å‚æ„é€ æ–¹æ³•</span>
<span class="token annotation punctuation">@AllArgsConstructor</span> <span class="token comment">//lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆå…¨å‚æ„é€ æ–¹æ³•</span>

<span class="token annotation punctuation">@HeadRowHeight</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token comment">//è¡¨å¤´é«˜åº¦</span>
<span class="token annotation punctuation">@ContentRowHeight</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span> <span class="token comment">//å†…å®¹è¡Œé«˜åº¦</span>
<span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token comment">//åˆ—å®½</span>
<span class="token annotation punctuation">@HeadStyle</span><span class="token punctuation">(</span>fillForegroundColor <span class="token operator">=</span> <span class="token number">44</span><span class="token punctuation">)</span> <span class="token comment">//è¡¨å¤´æ ·å¼</span>
<span class="token annotation punctuation">@ExcelIgnoreUnannotated</span> <span class="token comment">//å¿½ç•¥æœªæ ‡è®°çš„å­—æ®µ</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">School</span> <span class="token punctuation">{</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> schoolName<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡ç¼–ç &quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> schoolCode<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹´çº§åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> personName<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç­çº§åç§°&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> telephone<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿä¿¡æ¯&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿå§“å&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿä¿¡æ¯&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦ç”Ÿå¹´é¾„&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡æ‰€åœ¨åœ°å€&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> schoolAddress<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ColumnWidth</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;é€šåŸå¿å­¦æ ¡è¡¨&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å­¦æ ¡é¢„è§ˆ&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">URL</span> url<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="æ‹¦æˆªå™¨ä»£ç -2"><a href="#æ‹¦æˆªå™¨ä»£ç -2" class="header-anchor">#</a> æ‹¦æˆªå™¨ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>handler<span class="token punctuation">.</span></span><span class="token class-name">SheetWriteHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>holder<span class="token punctuation">.</span></span><span class="token class-name">WriteSheetHolder</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>holder<span class="token punctuation">.</span></span><span class="token class-name">WriteWorkbookHolder</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">Sheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">CellRangeAddress</span><span class="token punctuation">;</span>


<span class="token comment">/**
 * @author Apai-è‡ªå®šä¹‰æ‹¦æˆªå™¨
 * @Description å°†æŒ‡å®šçš„æ ‡é¢˜è¡Œå†»ç»“ï¼ŒæŒ‡å®šçš„æ ‡é¢˜è¡Œä»¥ä¸‹çš„æ•°æ®è¿›è¡Œç­›é€‰
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FreezeAndFilter</span> <span class="token keyword">implements</span> <span class="token class-name">SheetWriteHandler</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * æ°´å¹³æ‹†åˆ†ä½ç½®
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> colSplit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * æ‹†åˆ†çš„å‚ç›´ä½ç½®
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> rowSplit <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * å³çª—æ ¼ä¸­å¯è§çš„å·¦åˆ—
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> leftmostColumn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * åº•éƒ¨çª—æ ¼ä¸­å¯è§çš„é¡¶è¡Œ
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> topRow <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * è®¾ç½®ç­›é€‰èŒƒå›´
     * ï¼ˆå‚æ•°A2ï¼šD2ä»£è¡¨ä»ç¬¬äºŒè¡Œç¬¬Aåˆ—åˆ°ç¬¬äºŒè¡Œç¬¬Jåˆ—è¦ä½œä¸ºç­›é€‰æ¡†çš„ä½ç½®ï¼‰
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> autoFilterRange <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * è®¾ç½®å†»ç»“å’Œç­›é€‰
     * @param rowSplit å†»ç»“è¡Œæ•° ä¾‹å¦‚: 2 è¡¨ç¤ºå‰ä¸¤è¡Œå†»ç»“
     * @param autoFilterRange ç­›é€‰èŒƒå›´ ä¾‹å¦‚: A2:D2
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">FreezeAndFilter</span><span class="token punctuation">(</span><span class="token keyword">int</span> rowSplit<span class="token punctuation">,</span> <span class="token class-name">String</span> autoFilterRange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>rowSplit <span class="token operator">=</span> rowSplit<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>autoFilterRange <span class="token operator">=</span> autoFilterRange<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeSheetCreate</span><span class="token punctuation">(</span><span class="token class-name">WriteWorkbookHolder</span> writeWorkbookHolder<span class="token punctuation">,</span> <span class="token class-name">WriteSheetHolder</span> writeSheetHolder<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterSheetCreate</span><span class="token punctuation">(</span><span class="token class-name">WriteWorkbookHolder</span> writeWorkbookHolder<span class="token punctuation">,</span> <span class="token class-name">WriteSheetHolder</span> writeSheetHolder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Sheet</span> sheet <span class="token operator">=</span> writeSheetHolder<span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®å†»ç»“</span>
        sheet<span class="token punctuation">.</span><span class="token function">createFreezePane</span><span class="token punctuation">(</span>colSplit<span class="token punctuation">,</span> rowSplit<span class="token punctuation">,</span> leftmostColumn<span class="token punctuation">,</span> topRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®ç­›é€‰</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>autoFilterRange <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sheet<span class="token punctuation">.</span><span class="token function">setAutoFilter</span><span class="token punctuation">(</span><span class="token class-name">CellRangeAddress</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>autoFilterRange<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// è®¾ç½®å†»ç»“å’Œç­›é€‰ A2ï¼šD2ä»£è¡¨ä»ç¬¬äºŒè¡Œç¬¬Aåˆ—åˆ°ç¬¬äºŒè¡Œç¬¬Jåˆ—è¦ä½œä¸ºç­›é€‰æ¡†çš„ä½ç½®</span>
        <span class="token comment">// sheet.setAutoFilter(new CellRangeAddress(1,1,0,3));</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å·¥å…·ç±»æ–¹æ³•ä»£ç -2"><a href="#å·¥å…·ç±»æ–¹æ³•ä»£ç -2" class="header-anchor">#</a> å·¥å…·ç±»æ–¹æ³•ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * å¯¼å‡º Excel è¡¨æ ¼ å±…ä¸­æ ·å¼ æŒ‡å®šæ‹¦æˆªå™¨(å¯å®ç°ä¸€å¯¹å¤šå¯¼å‡º)
 * @param excelName å¯¼å‡ºè¡¨æ ¼çš„åç§°
 * @param dataList æ•°æ®é›†åˆ
 * @param entityClass å®ä½“ç±»
 * @param sheetName å¤šè¡¨æ ¼sheetçš„åç§° ä¸æ˜¯å¯¼å‡ºè¡¨æ ¼æ–‡ä»¶çš„åç§°
 * @param t æ‹¦æˆªå™¨
 * @param response å‰ç«¯è¯·æ±‚è¿”å›çš„å“åº”
 * @param &lt;T&gt; æ‹¦æˆªå™¨æ³›å‹
 * @throws IOException æŠ›å‡ºå¼‚å¸¸
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> dataList<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> entityClass<span class="token punctuation">,</span> <span class="token class-name">String</span> sheetName<span class="token punctuation">,</span> <span class="token class-name">T</span> t<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// é…ç½®å¯¼å‡ºå‰çš„ HttpServletResponse å“åº”</span>
    <span class="token function">collocateResponse</span><span class="token punctuation">(</span>excelName<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1 è®¾ç½®è¡¨å¤´æ ·å¼</span>
    <span class="token class-name">WriteCellStyle</span> headStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1.1 è®¾ç½®è¡¨å¤´æ•°æ®å±…ä¸­</span>
    headStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2 è®¾ç½®è¡¨æ ¼å†…å®¹æ ·å¼</span>
    <span class="token class-name">WriteCellStyle</span> bodyStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.1 è®¾ç½®è¡¨æ ¼å†…å®¹æ°´å¹³å±…ä¸­</span>
    bodyStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.2 è®¾ç½®è¡¨æ ¼å†…å®¹å‚ç›´å±…ä¸­</span>
    bodyStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3 è®¾ç½®è¡¨æ ¼sheetæ ·å¼</span>
    <span class="token class-name">WriteSheet</span> sheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>entityClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheetNo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 4 æ‹¿åˆ°è¡¨æ ¼å¤„ç†å¯¹è±¡</span>
    <span class="token class-name">ExcelWriter</span> writer <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">needHead</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">excelType</span><span class="token punctuation">(</span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span>
            <span class="token comment">// è‡ªå®šä¹‰æ‹¦æˆªå™¨</span>
            <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">WriteHandler</span><span class="token punctuation">)</span> t<span class="token punctuation">)</span>
            <span class="token comment">// è®¾ç½®å•å…ƒæ ¼çš„é£æ ¼æ ·å¼</span>
            <span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">(</span>headStyle<span class="token punctuation">,</span> bodyStyle<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 5 å†™å…¥excelæ•°æ®</span>
    writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 6 å…³é—­æµ</span>
    writer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="è¡¨ç°å±‚ä»£ç -2"><a href="#è¡¨ç°å±‚ä»£ç -2" class="header-anchor">#</a> è¡¨ç°å±‚ä»£ç </h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;downloadOneIs&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¯¼å‡ºè¡¨æ ¼ ä¸€å¯¹å¤šæ ¼å¼æ•°æ®&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadOneIs</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç½‘ç»œå›¾ç‰‡</span>
        <span class="token class-name">String</span> url1 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503204942958.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> url2 <span class="token operator">=</span> <span class="token string">&quot;https://apaiimages.oss-cn-guangzhou.aliyuncs.com/MD/image-20230503211609233.png&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">School</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;è€åˆ˜&quot;</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€å¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°æ&quot;</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒå¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸ƒç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°å¢&quot;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;åŸå…³å°å­¦&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CG-47725&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;äºŒå¹´çº§&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°ç‹&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;æµ·é¼å¢25å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url1<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;å»ºæ°´åˆä¸­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JS-78425&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åˆä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°ä¹&quot;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">&quot;å»ºæ°´è·¯ç½‘é‡‘è¡—é“27å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url2<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">School</span> s7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">School</span><span class="token punctuation">(</span><span class="token string">&quot;å»ºæ°´åˆä¸­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JS-78425&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åˆä¸€&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸€ç­&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å°é¹…&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;å»ºæ°´è·¯ç½‘é‡‘è¡—é“27å·&quot;</span><span class="token punctuation">,</span> <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">imageConvert</span><span class="token punctuation">(</span>url2<span class="token punctuation">,</span> URL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s7<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®éœ€è¦å¾…åˆå¹¶çš„è¡Œå’Œåˆ—ã€‚å‚æ•°1ï¼šæ•°å€¼æ•°ç»„ï¼ŒæŒ‡å®šéœ€è¦åˆå¹¶çš„åˆ—ï¼›å‚æ•°2ï¼šæ•°å€¼ï¼ŒæŒ‡å®šä»ç¬¬å‡ è¡Œå¼€å§‹åˆå¹¶</span>
<span class="token comment">//        ExcelMergeCellHandler excelMergeCellHandler = new ExcelMergeCellHandler(new int[]{0, 1, 2, 3, 6, 7}, 0);</span>
<span class="token comment">//        EasyExcelUtil.easyDownloadBlocker(&quot;å­¦æ ¡_ä¸€å¯¹å¤šæ•°æ®è¡¨&quot;, list, School.class, &quot;sheet-å­¦æ ¡ä¿¡æ¯&quot;, excelMergeCellHandler, response);</span>
        <span class="token comment">// å†»ç»“ç­›é€‰è¡¨å¤´</span>
        <span class="token class-name">FreezeAndFilter</span> freezeAndFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FreezeAndFilter</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;A3:H3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span><span class="token function">easyDownloadBlocker</span><span class="token punctuation">(</span><span class="token string">&quot;å­¦æ ¡_ä¸€å¯¹å¤šæ•°æ®è¡¨&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">,</span> <span class="token class-name">School</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-å­¦æ ¡ä¿¡æ¯&quot;</span><span class="token punctuation">,</span> freezeAndFilter<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¯¼å‡ºåŸºç¡€è¡¨ å±…ä¸­æ ·å¼</span>
        <span class="token comment">// EasyExcelUtil.easyDownloadStyle(&quot;å­¦æ ¡_ä¸€å¯¹å¤šæ•°æ®è¡¨&quot;, list, School.class, &quot;sheet-å­¦æ ¡ä¿¡æ¯&quot;, response);</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-4"><a href="#å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-4" class="header-anchor">#</a> å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</h3> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/MaYun-PicGo/image-20230814144330527.png" alt="image-20230814144330527"></p> <blockquote><h1 id="excel-å¡«å……æ¨¡æ¿æ“ä½œ"><a href="#excel-å¡«å……æ¨¡æ¿æ“ä½œ" class="header-anchor">#</a> | --&gt; Excel å¡«å……æ¨¡æ¿æ“ä½œ</h1></blockquote> <h2 id="æµ‹è¯•æ–‡ä»¶"><a href="#æµ‹è¯•æ–‡ä»¶" class="header-anchor">#</a> æµ‹è¯•æ–‡ä»¶</h2> <ul><li>ä½¿ç”¨çš„æµ‹è¯•æ¨¡æ¿æ–‡ä»¶ <a href="https://gitee.com/LuisApai/apai_wxafter/tree/master/Lu-Dome/Execl-Dome/src/main/resources/excel" target="_blank" rel="noopener noreferrer">ä¸‹è½½é“¾æ¥</a></li></ul> <h3 id="è¡¨ç°å±‚-6"><a href="#è¡¨ç°å±‚-6" class="header-anchor">#</a> è¡¨ç°å±‚</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">EasyExcel</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span></span><span class="token class-name">ExcelWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">WriteDirectionEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>data<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">FileUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ListUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">MapUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span></span><span class="token class-name">WriteSheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>fill<span class="token punctuation">.</span></span><span class="token class-name">FillConfig</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>fill<span class="token punctuation">.</span></span><span class="token class-name">FillWrapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteCellStyle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteFont</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb<span class="token punctuation">.</span></span><span class="token class-name">ExcelMergeCellHandler</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb<span class="token punctuation">.</span></span><span class="token class-name">FreezeAndFilter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>alibb<span class="token punctuation">.</span></span><span class="token class-name">TestFileUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>ex<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>setEntity<span class="token punctuation">.</span></span><span class="token class-name">FillData</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>setEntity<span class="token punctuation">.</span></span><span class="token class-name">FillDataTest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ExecelTestService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Api</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiOperation</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">FillPatternType</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">IndexedColors</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URL<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span>collocateResponse<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">EasyExcelUtil</span><span class="token punctuation">.</span>easyFillDownload<span class="token punctuation">;</span>


<span class="token comment">/**
 * (ExecelTest)è¡¨æ§åˆ¶å±‚
 *
 * @author Lu-Apai: There is no BUG in seeing light and believing light to be light AOLIGEI ...
 * @since 2023-08-09 15:43:32
 */</span>

<span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;å¡«å……è¡¨æ ¼æµ‹è¯•ç±»&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/setExecel&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SetExecelController</span> <span class="token punctuation">{</span>


    <span class="token comment">/**
     * ä¸šåŠ¡å±‚å¯¹è±¡
     */</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">ExecelTestService</span> execelTestService<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;simpleFill&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç®€å•çš„å¡«å……&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">simpleFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;simple.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// æ–¹æ¡ˆ1 æ ¹æ®å¯¹è±¡å¡«å…… è¿™é‡Œä¼šå¡«å……åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span>
        <span class="token comment">// FillData fillData = new FillData();</span>
        <span class="token comment">// fillData.setName(&quot;ææ¢…æ²¡11111&quot;);</span>
        <span class="token comment">// fillData.setNumber(6.25);</span>
        <span class="token comment">// fillData.setDate(new Date());</span>

        <span class="token comment">// æ–¹æ¡ˆ2 æ ¹æ®Mapå¡«å……  è¿™é‡Œä¼šå¡«å……åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token class-name">MapUtils</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span> <span class="token number">5.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ ¹æ®æ—¶é—´æˆ³ç”Ÿæˆæ–°çš„è¡¨æ ¼åç§° ç„¶åå¯¼å‡ºåˆ°æœ¬åœ° \Execl-Dome\target\classes ä¸‹</span>
        <span class="token comment">// String fileName = TestFileUtil.getPath() + &quot;simpleFill&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span>
        <span class="token comment">// EasyExcel.write(fileName).withTemplate(templateFileName).sheet().doFill(fillData);</span>

        <span class="token comment">// ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
        <span class="token comment">// collocateResponse(&quot;excelName&quot;, response);</span>
        <span class="token comment">// ExcelWriter excelWriter = EasyExcel.write(response.getOutputStream()).withTemplate(templateFileName).build();</span>
        <span class="token comment">// WriteSheet writeSheet  = EasyExcel.writerSheet().build();</span>
        <span class="token comment">// excelWriter.fill(fillData, writeSheet);</span>
        <span class="token comment">// excelWriter.finish();</span>

        <span class="token comment">// å·¥å…·ç±»å¯¼å‡ºæµå“åº”</span>
        <span class="token function">easyFillDownload</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">,</span> map<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æµ‹è¯•æ•°æ® é›†åˆ
     *
     * @return
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillData</span><span class="token punctuation">&gt;</span></span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillData</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">FillData</span> fillData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fillData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            fillData<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fillData<span class="token punctuation">.</span><span class="token function">setNumber</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            fillData<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;listFill&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¡«å……åˆ—è¡¨&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;list.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// æµ‹è¯•æ•°æ®</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillData</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ–¹æ¡ˆ1 ä¸€ä¸‹å­å…¨éƒ¨æ”¾åˆ°å†…å­˜é‡Œé¢ å¹¶å¡«å……</span>
<span class="token comment">//        String fileName = TestFileUtil.getPath() + &quot;listFill&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span>
<span class="token comment">//        // è¿™é‡Œ ä¼šå¡«å……åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span>
<span class="token comment">//        EasyExcel.write(fileName).withTemplate(templateFileName).sheet().doFill(list);</span>

        <span class="token comment">// æ–¹æ¡ˆ2 åˆ†å¤šæ¬¡ å¡«å…… ä¼šä½¿ç”¨æ–‡ä»¶ç¼“å­˜ï¼ˆçœå†…å­˜ï¼‰</span>
        <span class="token comment">// fileName = TestFileUtil.getPath() + &quot;listFill&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            excelWriter.fill(list, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(list, writeSheet);</span>
<span class="token comment">//        }</span>

        <span class="token comment">// æ–¹æ¡ˆ1 å·¥å…·ç±»å¯¼å‡ºæµå“åº”</span>
        <span class="token function">easyFillDownload</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">,</span> list<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;complexFill&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¤æ‚çš„å¡«å……&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">complexFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;complex.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            // è¿™é‡Œæ³¨æ„ å…¥å‚ç”¨äº†forceNewRow ä»£è¡¨åœ¨å†™å…¥listçš„æ—¶å€™ä¸ç®¡listä¸‹é¢æœ‰æ²¡æœ‰ç©ºè¡Œ éƒ½ä¼šåˆ›å»ºä¸€è¡Œï¼Œç„¶åä¸‹é¢çš„æ•°æ®å¾€åç§»åŠ¨ã€‚é»˜è®¤ æ˜¯falseï¼Œä¼šç›´æ¥ä½¿ç”¨ä¸‹ä¸€è¡Œï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºã€‚</span>
<span class="token comment">//            // forceNewRow å¦‚æœè®¾ç½®äº†true,æœ‰ä¸ªç¼ºç‚¹ å°±æ˜¯ä»–ä¼šæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½æ”¾åˆ°å†…å­˜äº†ï¼Œæ‰€ä»¥æ…ç”¨</span>
<span class="token comment">//            // ç®€å•çš„è¯´ å¦‚æœä½ çš„æ¨¡æ¿æœ‰list,ä¸”listä¸æ˜¯æœ€åä¸€è¡Œï¼Œä¸‹é¢è¿˜æœ‰æ•°æ®éœ€è¦å¡«å…… å°±å¿…é¡»è®¾ç½® forceNewRow=true ä½†æ˜¯è¿™ä¸ªå°±ä¼šæŠŠæ‰€æœ‰æ•°æ®æ”¾åˆ°å†…å­˜ ä¼šå¾ˆè€—å†…å­˜</span>
<span class="token comment">//            // å¦‚æœæ•°æ®é‡å¤§ listä¸æ˜¯æœ€åä¸€è¡Œ å‚ç…§ä¸‹ä¸€ä¸ª</span>
<span class="token comment">//            FillConfig fillConfig = FillConfig.builder().forceNewRow(Boolean.TRUE).build();</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = MapUtils.newHashMap();</span>
<span class="token comment">//            map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            map.put(&quot;total&quot;, 1000);</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//        }</span>

        <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forceNewRow</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token class-name">MapUtils</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;total&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;complexFillWithTable&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ®é‡å¤§çš„å¤æ‚å¡«å…… è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ ç¡®ä¿æ¨¡æ¿listä¸ºæœ€åä¸€è¡Œï¼Œç„¶åå†æ‹¼æ¥table.è¿˜æœ‰03ç‰ˆæ²¡æ•‘ï¼Œåªèƒ½åˆšæ­£é¢åŠ å†…å­˜ã€‚&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">complexFillWithTable</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;complexFillWithTable.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            // ç›´æ¥å†™å…¥æ•°æ®</span>
<span class="token comment">//            excelWriter.fill(data(), writeSheet);</span>
<span class="token comment">//            excelWriter.fill(data(), writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            // å†™å…¥listä¹‹å‰çš„æ•°æ®</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();</span>
<span class="token comment">//            map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            // list åé¢è¿˜æœ‰ä¸ªç»Ÿè®¡ æƒ³åŠæ³•æ‰‹åŠ¨å†™å…¥</span>
<span class="token comment">//            // è¿™é‡Œå·æ‡’ç›´æ¥ç”¨list ä¹Ÿå¯ä»¥ç”¨å¯¹è±¡</span>
<span class="token comment">//            List&lt;List&lt;String&gt;&gt; totalListList = ListUtils.newArrayList();</span>
<span class="token comment">//            List&lt;String&gt; totalList = ListUtils.newArrayList();</span>
<span class="token comment">//            totalListList.add(totalList);</span>
<span class="token comment">//            totalList.add(null);</span>
<span class="token comment">//            totalList.add(null);</span>
<span class="token comment">//            totalList.add(null);</span>
<span class="token comment">//            // ç¬¬å››åˆ—</span>
<span class="token comment">//            totalList.add(&quot;ç»Ÿè®¡:1000&quot;);</span>
<span class="token comment">//            // è¿™é‡Œæ˜¯write åˆ«å’Œfill æé”™äº†</span>
<span class="token comment">//            excelWriter.write(totalListList, writeSheet);</span>
<span class="token comment">//            // æ€»ä½“ä¸Šå†™æ³•æ¯”è¾ƒå¤æ‚ ä½†æ˜¯ä¹Ÿæ²¡æœ‰æƒ³åˆ°å¥½çš„ç‰ˆæœ¬ å¼‚æ­¥çš„å»å†™å…¥excel ä¸æ”¯æŒè¡Œçš„åˆ é™¤å’Œç§»åŠ¨ï¼Œä¹Ÿä¸æ”¯æŒå¤‡æ³¨è¿™ç§çš„å†™å…¥ï¼Œæ‰€ä»¥ä¹Ÿæ’é™¤äº†å¯ä»¥</span>
<span class="token comment">//            // æ–°å»ºä¸€ä¸ª ç„¶åä¸€ç‚¹ç‚¹å¤åˆ¶è¿‡æ¥çš„æ–¹æ¡ˆï¼Œæœ€åå¯¼è‡´listéœ€è¦æ–°å¢è¡Œçš„æ—¶å€™ï¼Œåé¢çš„åˆ—çš„æ•°æ®æ²¡æ³•åç§»ï¼Œåç»­ä¼šç»§ç»­æƒ³æƒ³è§£å†³æ–¹æ¡ˆ</span>
<span class="token comment">//        }</span>

        <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ç›´æ¥å†™å…¥æ•°æ®</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å†™å…¥listä¹‹å‰çš„æ•°æ®</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2024å¹´05æœˆ9æ—¥13:28:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> totalListList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> totalList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        totalListList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>totalList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç¬¬å››åˆ— ä½ç½®</span>
        totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ç»Ÿè®¡:1000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿™é‡Œæ˜¯write åˆ«å’Œfill æé”™äº†</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>totalListList<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å…³é—­æµ</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;horizontalFill&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ¨ªå‘çš„å¡«å……&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">horizontalFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;horizontal.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span>
<span class="token comment">//            map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//        }</span>

        <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ¨ªå‘å¡«å……</span>
        <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">direction</span><span class="token punctuation">(</span><span class="token class-name">WriteDirectionEnum</span><span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å…³é—­æµ</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;compositeFill&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¤šåˆ—è¡¨ç»„åˆå¡«å……å¡«å……&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">compositeFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;composite.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();</span>
<span class="token comment">//            // å¦‚æœæœ‰å¤šä¸ªlist æ¨¡æ¿ä¸Šå¿…é¡»æœ‰{å‰ç¼€.} è¿™é‡Œçš„å‰ç¼€å°±æ˜¯ data1ï¼Œç„¶åå¤šä¸ªlistå¿…é¡»ç”¨ FillWrapperåŒ…è£¹</span>
<span class="token comment">//            excelWriter.fill(new FillWrapper(&quot;data1&quot;, data()), fillConfig, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(new FillWrapper(&quot;data2&quot;, data()), writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();</span>
<span class="token comment">//            //map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            map.put(&quot;date&quot;, new Date());</span>
<span class="token comment">//</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//        }</span>

        <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">direction</span><span class="token punctuation">(</span><span class="token class-name">WriteDirectionEnum</span><span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœæœ‰å¤šä¸ªlist æ¨¡æ¿ä¸Šå¿…é¡»æœ‰{å‰ç¼€.} è¿™é‡Œçš„å‰ç¼€å°±æ˜¯ data1ï¼Œç„¶åå¤šä¸ªlistå¿…é¡»ç”¨ FillWrapperåŒ…è£¹</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;data1&quot;</span><span class="token punctuation">,</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;data2&quot;</span><span class="token punctuation">,</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å…³é—­æµ</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;compositeFillTest&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¤æ‚å¤šshellå¡«å……æ¨¡æ¿&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">compositeFillTest</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;compositeFillTest.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// ç›´æ¥é…ç½®responseå¯¼å‡ºæµå“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;11111&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å†™å…¥sheet å¯ä»¥å¤šä¸ª æŒ‰ç…§æ¨¡æ¿çš„å¤šä¸ªsheetçš„åå­—</span>
        <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token string">&quot;sheet-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteSheet</span> writeSheet2 <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¼€å§‹å†™å…¥</span>
        <span class="token class-name">FillDataTest</span> vo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setA1</span><span class="token punctuation">(</span><span class="token string">&quot;å¼ å©·å©·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setA2</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿¡æ¯éƒ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setA3</span><span class="token punctuation">(</span><span class="token string">&quot;è®¾è®¡å¸ˆ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setA4</span><span class="token punctuation">(</span><span class="token string">&quot;06&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setA5</span><span class="token punctuation">(</span><span class="token string">&quot;2019-01-01 ç‰ˆè®¾è®¡å®ˆåˆ™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setB1</span><span class="token punctuation">(</span><span class="token string">&quot;å¤§å£®&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setB2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setB3</span><span class="token punctuation">(</span><span class="token string">&quot;2024-05-06 12:21:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setB4</span><span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vo<span class="token punctuation">.</span><span class="token function">setB5</span><span class="token punctuation">(</span><span class="token string">&quot;Consistent with real life: in line with the process and logic of real life, and comply with languages and habits that the users are used to;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¡«å……æ•°æ®åˆ°æŒ‡å®šçš„sheetè¡¨æ ¼ä¸­</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>vo<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>vo<span class="token punctuation">,</span> writeSheet2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¡«å……åˆ—è¡¨</span>
        <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forceNewRow</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¡«å……åˆ—è¡¨æ•°æ®</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillDataTest</span><span class="token punctuation">&gt;</span></span> voList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">FillDataTest</span> fillDataTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token string">&quot;è·³è·³-&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token string">&quot;æµ‹è¯•&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wwww&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ccc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;adadwadadwad&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            voList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fillDataTest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¡«å……åˆ—è¡¨ æŒ‡å®šsheet</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> voList<span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¡«å……åˆ—è¡¨</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillDataTest</span><span class="token punctuation">&gt;</span></span> voList2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">FillDataTest</span> fillDataTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token string">&quot;sheet-02-&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            voList2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fillDataTest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¡«å……åˆ—è¡¨ æŒ‡å®šsheet</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> voList2<span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å…³é—­æµ</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¡«å……å®ä½“ç±»"><a href="#å¡«å……å®ä½“ç±»" class="header-anchor">#</a> å¡«å……å®ä½“ç±»</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>setEntity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">EqualsAndHashCode</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Getter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Setter</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jiaju Zhuang
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FillData</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">double</span> number<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>apai<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>setEntity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">EqualsAndHashCode</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Getter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Setter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jiaju Zhuang
 */</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@EqualsAndHashCode</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FillDataTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> a1<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> a2<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> a3<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> a4<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> a5<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> b1<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> b2<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> b3<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> b4<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> b5<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> a1<span class="token punctuation">,</span> <span class="token class-name">String</span> a2<span class="token punctuation">,</span> <span class="token class-name">String</span> a3<span class="token punctuation">,</span> <span class="token class-name">String</span> a4<span class="token punctuation">,</span> <span class="token class-name">String</span> a5<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a1 <span class="token operator">=</span> a1<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a2 <span class="token operator">=</span> a2<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a3 <span class="token operator">=</span> a3<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a4 <span class="token operator">=</span> a4<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a5 <span class="token operator">=</span> a5<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="æ¨¡æ¿å˜é‡"><a href="#æ¨¡æ¿å˜é‡" class="header-anchor">#</a> æ¨¡æ¿å˜é‡</h2> <ul><li>å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;{&quot;,&quot;}&quot;ä»£æ›¿   --&gt;   {name}å¿½ç•¥ï¼Œ{name}</li></ul> <p>å•ä¸ªå˜é‡å’Œå¯¹è±¡å˜é‡: {a2}</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// å†™å…¥sheet å¯ä»¥å¤šä¸ª æŒ‰ç…§æ¨¡æ¿çš„å¤šä¸ªsheetçš„åå­— </span>
<span class="token comment">// å•ä¸ªsheetä¸éœ€è¦æŒ‡å®šåç§° WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token string">&quot;sheet-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FillDataTest</span> vo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
vo<span class="token punctuation">.</span><span class="token function">setA1</span><span class="token punctuation">(</span><span class="token string">&quot;å¼ å©·å©·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
vo<span class="token punctuation">.</span><span class="token function">setA2</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿¡æ¯éƒ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>vo<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ¸²æŸ“è¡¨æ ¼å•ä¸ªåˆ—è¡¨: {.name} ç›´æ¥å¡«å…… excelWriter.fill(list, writeSheet);</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// è¿™é‡Œ ä¼šå¡«å……åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span>
<span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doFill</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ¸²æŸ“è¡¨æ ¼å¤šä¸ªåˆ—è¡¨: {list.a1} éœ€è¦æŒ‡å®š excelWriter.fill(new FillWrapper(&quot;data1&quot;, data()), fillConfig, writeSheet);</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å¦‚æœæœ‰å¤šä¸ªlist æ¨¡æ¿ä¸Šå¿…é¡»æœ‰{å‰ç¼€.} è¿™é‡Œçš„å‰ç¼€å°±æ˜¯ data1ï¼Œç„¶åå¤šä¸ªlistå¿…é¡»ç”¨ FillWrapperåŒ…è£¹</span>
excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;data2&quot;</span><span class="token punctuation">,</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="ç®€å•çš„å¡«å……"><a href="#ç®€å•çš„å¡«å……" class="header-anchor">#</a> ç®€å•çš„å¡«å……</h2> <ul><li>æ ¹æ®å¯¹è±¡å¡«å…… / æ ¹æ®Mapå¡«å……</li> <li>å¯¼å‡ºåˆ°æœ¬åœ°</li> <li>ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</li> <li>å·¥å…·ç±»å¯¼å‡ºæµå“åº”</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;simpleFill&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æœ€ç®€å•çš„å¡«å……&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">simpleFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
    <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
    <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
    <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;simple.xlsx&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// æ–¹æ¡ˆ1 æ ¹æ®å¯¹è±¡å¡«å…… è¿™é‡Œä¼šå¡«å……åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span>
    <span class="token comment">// FillData fillData = new FillData();</span>
    <span class="token comment">// fillData.setName(&quot;ææ¢…æ²¡11111&quot;);</span>
    <span class="token comment">// fillData.setNumber(6.25);</span>
    <span class="token comment">// fillData.setDate(new Date());</span>

    <span class="token comment">// æ–¹æ¡ˆ2 æ ¹æ®Mapå¡«å……  è¿™é‡Œä¼šå¡«å……åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token class-name">MapUtils</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span> <span class="token number">5.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ ¹æ®æ—¶é—´æˆ³ç”Ÿæˆæ–°çš„è¡¨æ ¼åç§° ç„¶åå¯¼å‡ºåˆ°æœ¬åœ° \Execl-Dome\target\classes ä¸‹</span>
    <span class="token comment">// String fileName = TestFileUtil.getPath() + &quot;simpleFill&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span>
    <span class="token comment">// EasyExcel.write(fileName).withTemplate(templateFileName).sheet().doFill(fillData);</span>

    <span class="token comment">// ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
    <span class="token comment">// collocateResponse(&quot;excelName&quot;, response);</span>
    <span class="token comment">// ExcelWriter excelWriter = EasyExcel.write(response.getOutputStream()).withTemplate(templateFileName).build();</span>
    <span class="token comment">// WriteSheet writeSheet  = EasyExcel.writerSheet().build();</span>
    <span class="token comment">// excelWriter.fill(fillData, writeSheet);</span>
    <span class="token comment">// excelWriter.finish();</span>

    <span class="token comment">// å·¥å…·ç±»å¯¼å‡ºæµå“åº”</span>
    <span class="token function">easyFillDownload</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">,</span> map<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061502780.png" alt="image-20240506145330883"></p> <h2 id="å¡«å……åˆ—è¡¨"><a href="#å¡«å……åˆ—è¡¨" class="header-anchor">#</a> å¡«å……åˆ—è¡¨</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;listFill&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¡«å……åˆ—è¡¨&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
    <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
    <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
    <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;list.xlsx&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// æµ‹è¯•æ•°æ®</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillData</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ–¹æ¡ˆ1 ä¸€ä¸‹å­å…¨éƒ¨æ”¾åˆ°å†…å­˜é‡Œé¢ å¹¶å¡«å……</span>
<span class="token comment">//        String fileName = TestFileUtil.getPath() + &quot;listFill&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span>
<span class="token comment">//        // è¿™é‡Œ ä¼šå¡«å……åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span>
<span class="token comment">//        EasyExcel.write(fileName).withTemplate(templateFileName).sheet().doFill(list);</span>

    <span class="token comment">// æ–¹æ¡ˆ2 åˆ†å¤šæ¬¡ å¡«å…… ä¼šä½¿ç”¨æ–‡ä»¶ç¼“å­˜ï¼ˆçœå†…å­˜ï¼‰</span>
    <span class="token comment">// fileName = TestFileUtil.getPath() + &quot;listFill&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            excelWriter.fill(list, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(list, writeSheet);</span>
<span class="token comment">//        }</span>

    <span class="token comment">// æ–¹æ¡ˆ1 å·¥å…·ç±»å¯¼å‡ºæµå“åº”</span>
    <span class="token function">easyFillDownload</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">,</span> list<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061516315.png" alt="image-20240506151656146"></p> <h2 id="å¤æ‚çš„å¡«å……"><a href="#å¤æ‚çš„å¡«å……" class="header-anchor">#</a> å¤æ‚çš„å¡«å……</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;complexFill&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¤æ‚çš„å¡«å……&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">complexFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
        <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
        <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
        <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;complex.xlsx&quot;</span><span class="token punctuation">;</span>

        <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            // è¿™é‡Œæ³¨æ„ å…¥å‚ç”¨äº†forceNewRow ä»£è¡¨åœ¨å†™å…¥listçš„æ—¶å€™ä¸ç®¡listä¸‹é¢æœ‰æ²¡æœ‰ç©ºè¡Œ éƒ½ä¼šåˆ›å»ºä¸€è¡Œï¼Œç„¶åä¸‹é¢çš„æ•°æ®å¾€åç§»åŠ¨ã€‚é»˜è®¤ æ˜¯falseï¼Œä¼šç›´æ¥ä½¿ç”¨ä¸‹ä¸€è¡Œï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºã€‚</span>
<span class="token comment">//            // forceNewRow å¦‚æœè®¾ç½®äº†true,æœ‰ä¸ªç¼ºç‚¹ å°±æ˜¯ä»–ä¼šæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½æ”¾åˆ°å†…å­˜äº†ï¼Œæ‰€ä»¥æ…ç”¨</span>
<span class="token comment">//            // ç®€å•çš„è¯´ å¦‚æœä½ çš„æ¨¡æ¿æœ‰list,ä¸”listä¸æ˜¯æœ€åä¸€è¡Œï¼Œä¸‹é¢è¿˜æœ‰æ•°æ®éœ€è¦å¡«å…… å°±å¿…é¡»è®¾ç½® forceNewRow=true ä½†æ˜¯è¿™ä¸ªå°±ä¼šæŠŠæ‰€æœ‰æ•°æ®æ”¾åˆ°å†…å­˜ ä¼šå¾ˆè€—å†…å­˜</span>
<span class="token comment">//            // å¦‚æœæ•°æ®é‡å¤§ listä¸æ˜¯æœ€åä¸€è¡Œ å‚ç…§ä¸‹ä¸€ä¸ª</span>
<span class="token comment">//            FillConfig fillConfig = FillConfig.builder().forceNewRow(Boolean.TRUE).build();</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = MapUtils.newHashMap();</span>
<span class="token comment">//            map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            map.put(&quot;total&quot;, 1000);</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//        }</span>

        <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
        <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forceNewRow</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token class-name">MapUtils</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;total&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061514208.png" alt="image-20240506151455050"></p> <h2 id="æ•°æ®é‡å¤§çš„å¤æ‚å¡«å……"><a href="#æ•°æ®é‡å¤§çš„å¤æ‚å¡«å……" class="header-anchor">#</a> æ•°æ®é‡å¤§çš„å¤æ‚å¡«å……</h2> <ul><li>æ•°æ®é‡å¤§çš„å¤æ‚å¡«å…… è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ ç¡®ä¿æ¨¡æ¿listä¸ºæœ€åä¸€è¡Œï¼Œç„¶åå†æ‹¼æ¥table.è¿˜æœ‰03ç‰ˆæ²¡æ•‘ï¼Œåªèƒ½åˆšæ­£é¢åŠ å†…å­˜ã€‚</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;complexFillWithTable&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ®é‡å¤§çš„å¤æ‚å¡«å…… è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ ç¡®ä¿æ¨¡æ¿listä¸ºæœ€åä¸€è¡Œï¼Œç„¶åå†æ‹¼æ¥table.è¿˜æœ‰03ç‰ˆæ²¡æ•‘ï¼Œåªèƒ½åˆšæ­£é¢åŠ å†…å­˜ã€‚&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">complexFillWithTable</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
    <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
    <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
    <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;complexFillWithTable.xlsx&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            // ç›´æ¥å†™å…¥æ•°æ®</span>
<span class="token comment">//            excelWriter.fill(data(), writeSheet);</span>
<span class="token comment">//            excelWriter.fill(data(), writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            // å†™å…¥listä¹‹å‰çš„æ•°æ®</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();</span>
<span class="token comment">//            map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            // list åé¢è¿˜æœ‰ä¸ªç»Ÿè®¡ æƒ³åŠæ³•æ‰‹åŠ¨å†™å…¥</span>
<span class="token comment">//            // è¿™é‡Œå·æ‡’ç›´æ¥ç”¨list ä¹Ÿå¯ä»¥ç”¨å¯¹è±¡</span>
<span class="token comment">//            List&lt;List&lt;String&gt;&gt; totalListList = ListUtils.newArrayList();</span>
<span class="token comment">//            List&lt;String&gt; totalList = ListUtils.newArrayList();</span>
<span class="token comment">//            totalListList.add(totalList);</span>
<span class="token comment">//            totalList.add(null);</span>
<span class="token comment">//            totalList.add(null);</span>
<span class="token comment">//            totalList.add(null);</span>
<span class="token comment">//            // ç¬¬å››åˆ—</span>
<span class="token comment">//            totalList.add(&quot;ç»Ÿè®¡:1000&quot;);</span>
<span class="token comment">//            // è¿™é‡Œæ˜¯write åˆ«å’Œfill æé”™äº†</span>
<span class="token comment">//            excelWriter.write(totalListList, writeSheet);</span>
<span class="token comment">//            // æ€»ä½“ä¸Šå†™æ³•æ¯”è¾ƒå¤æ‚ ä½†æ˜¯ä¹Ÿæ²¡æœ‰æƒ³åˆ°å¥½çš„ç‰ˆæœ¬ å¼‚æ­¥çš„å»å†™å…¥excel ä¸æ”¯æŒè¡Œçš„åˆ é™¤å’Œç§»åŠ¨ï¼Œä¹Ÿä¸æ”¯æŒå¤‡æ³¨è¿™ç§çš„å†™å…¥ï¼Œæ‰€ä»¥ä¹Ÿæ’é™¤äº†å¯ä»¥</span>
<span class="token comment">//            // æ–°å»ºä¸€ä¸ª ç„¶åä¸€ç‚¹ç‚¹å¤åˆ¶è¿‡æ¥çš„æ–¹æ¡ˆï¼Œæœ€åå¯¼è‡´listéœ€è¦æ–°å¢è¡Œçš„æ—¶å€™ï¼Œåé¢çš„åˆ—çš„æ•°æ®æ²¡æ³•åç§»ï¼Œåç»­ä¼šç»§ç»­æƒ³æƒ³è§£å†³æ–¹æ¡ˆ</span>
<span class="token comment">//        }</span>

    <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
    <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ç›´æ¥å†™å…¥æ•°æ®</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å†™å…¥listä¹‹å‰çš„æ•°æ®</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2024å¹´05æœˆ9æ—¥13:28:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> totalListList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> totalList <span class="token operator">=</span> <span class="token class-name">ListUtils</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    totalListList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>totalList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç¬¬å››åˆ— ä½ç½®</span>
    totalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ç»Ÿè®¡:1000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¿™é‡Œæ˜¯write åˆ«å’Œfill æé”™äº†</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>totalListList<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å…³é—­æµ</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061514831.png" alt="image-20240506151405686"></p> <h2 id="åˆ—è¡¨æ¨ªå‘çš„å¡«å……"><a href="#åˆ—è¡¨æ¨ªå‘çš„å¡«å……" class="header-anchor">#</a> åˆ—è¡¨æ¨ªå‘çš„å¡«å……</h2> <ul><li>å¿…é¡»åœ¨å¡«å……ä½¿ç”¨ FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;horizontalFill&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;æ¨ªå‘çš„å¡«å……&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">horizontalFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
    <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
    <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
    <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;horizontal.xlsx&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(data(), fillConfig, writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span>
<span class="token comment">//            map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//        }</span>

    <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
    <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ¨ªå‘å¡«å……</span>
    <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">direction</span><span class="token punctuation">(</span><span class="token class-name">WriteDirectionEnum</span><span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å…³é—­æµ</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061513188.png" alt="image-20240506151300009"></p> <h2 id="å¤šåˆ—è¡¨ç»„åˆå¡«å……"><a href="#å¤šåˆ—è¡¨ç»„åˆå¡«å……" class="header-anchor">#</a> å¤šåˆ—è¡¨ç»„åˆå¡«å……</h2> <ul><li>æ¸²æŸ“è¡¨æ ¼å¤šä¸ªåˆ—è¡¨: {list.a1} éœ€è¦æŒ‡å®š excelWriter.fill(new FillWrapper(&quot;data1&quot;, data()), fillConfig, writeSheet);</li> <li>å¦‚æœæœ‰å¤šä¸ªlist æ¨¡æ¿ä¸Šå¿…é¡»æœ‰{å‰ç¼€.} è¿™é‡Œçš„å‰ç¼€å°±æ˜¯ data1ï¼Œç„¶åå¤šä¸ªlistå¿…é¡»ç”¨ FillWrapperåŒ…è£¹</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;compositeFill&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¤šåˆ—è¡¨ç»„åˆå¡«å……&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">compositeFill</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
    <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
    <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
    <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;composite.xlsx&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// æ–¹æ¡ˆ1</span>
<span class="token comment">//        try (ExcelWriter excelWriter = EasyExcel.write(&quot;fileName&quot;).withTemplate(templateFileName).build()) {</span>
<span class="token comment">//            WriteSheet writeSheet = EasyExcel.writerSheet().build();</span>
<span class="token comment">//            FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();</span>
<span class="token comment">//            // å¦‚æœæœ‰å¤šä¸ªlist æ¨¡æ¿ä¸Šå¿…é¡»æœ‰{å‰ç¼€.} è¿™é‡Œçš„å‰ç¼€å°±æ˜¯ data1ï¼Œç„¶åå¤šä¸ªlistå¿…é¡»ç”¨ FillWrapperåŒ…è£¹</span>
<span class="token comment">//            excelWriter.fill(new FillWrapper(&quot;data1&quot;, data()), fillConfig, writeSheet);</span>
<span class="token comment">//            excelWriter.fill(new FillWrapper(&quot;data2&quot;, data()), writeSheet);</span>
<span class="token comment">//</span>
<span class="token comment">//            Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();</span>
<span class="token comment">//            //map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
<span class="token comment">//            map.put(&quot;date&quot;, new Date());</span>
<span class="token comment">//</span>
<span class="token comment">//            excelWriter.fill(map, writeSheet);</span>
<span class="token comment">//        }</span>

    <span class="token comment">// æ–¹æ¡ˆ1 ç›´æ¥é…ç½®å¯¼å‡ºæµå“åº”</span>
    <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;excelName&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">direction</span><span class="token punctuation">(</span><span class="token class-name">WriteDirectionEnum</span><span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¦‚æœæœ‰å¤šä¸ªlist æ¨¡æ¿ä¸Šå¿…é¡»æœ‰{å‰ç¼€.} è¿™é‡Œçš„å‰ç¼€å°±æ˜¯ data1ï¼Œç„¶åå¤šä¸ªlistå¿…é¡»ç”¨ FillWrapperåŒ…è£¹</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;data1&quot;</span><span class="token punctuation">,</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;data2&quot;</span><span class="token punctuation">,</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//map.put(&quot;date&quot;, &quot;2019å¹´10æœˆ9æ—¥13:28:28&quot;);</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å…³é—­æµ</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061512190.png" alt="image-20240506151200024"></p> <h2 id="å¤æ‚å¤šshellå¡«å……æ¨¡æ¿"><a href="#å¤æ‚å¤šshellå¡«å……æ¨¡æ¿" class="header-anchor">#</a> å¤æ‚å¤šshellå¡«å……æ¨¡æ¿</h2> <ul><li>å†™å…¥sheet å¯ä»¥å¤šä¸ª æŒ‰ç…§æ¨¡æ¿çš„å¤šä¸ªsheetçš„åå­— EasyExcel.writerSheet(&quot;sheet-01&quot;).build();</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;compositeFillTest&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;å¤æ‚å¤šshellå¡«å……æ¨¡æ¿&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">compositeFillTest</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token comment">// æ¨¡æ¿æ³¨æ„ ç”¨{} æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ å¦‚æœæœ¬æ¥å°±æœ‰&quot;{&quot;,&quot;}&quot; ç‰¹æ®Šå­—ç¬¦ ç”¨&quot;\{&quot;,&quot;\}&quot;ä»£æ›¿</span>
    <span class="token comment">// è¿™é‡Œæ¨¡æ¿ä¸­{name} ä¼šè¢«æ›¿æ¢æˆå¯¹åº”çš„å€¼</span>
    <span class="token comment">// templateFileName = Excel-Dome\src\main\resources\excel\simple.xlsx</span>
    <span class="token class-name">String</span> templateFileName <span class="token operator">=</span> <span class="token class-name">TestFileUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;excel&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;compositeFillTest.xlsx&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// ç›´æ¥é…ç½®responseå¯¼å‡ºæµå“åº”</span>
    <span class="token function">collocateResponse</span><span class="token punctuation">(</span><span class="token string">&quot;11111&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ExcelWriter</span> excelWriter <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTemplate</span><span class="token punctuation">(</span>templateFileName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å†™å…¥sheet å¯ä»¥å¤šä¸ª æŒ‰ç…§æ¨¡æ¿çš„å¤šä¸ªsheetçš„åå­—</span>
    <span class="token class-name">WriteSheet</span> writeSheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token string">&quot;sheet-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WriteSheet</span> writeSheet2 <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span><span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¼€å§‹å†™å…¥</span>
    <span class="token class-name">FillDataTest</span> vo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setA1</span><span class="token punctuation">(</span><span class="token string">&quot;å¼ å©·å©·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setA2</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿¡æ¯éƒ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setA3</span><span class="token punctuation">(</span><span class="token string">&quot;è®¾è®¡å¸ˆ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setA4</span><span class="token punctuation">(</span><span class="token string">&quot;06&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setA5</span><span class="token punctuation">(</span><span class="token string">&quot;2019-01-01 ç‰ˆè®¾è®¡å®ˆåˆ™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setB1</span><span class="token punctuation">(</span><span class="token string">&quot;å¤§å£®&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setB2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setB3</span><span class="token punctuation">(</span><span class="token string">&quot;2024-05-06 12:21:28&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setB4</span><span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vo<span class="token punctuation">.</span><span class="token function">setB5</span><span class="token punctuation">(</span><span class="token string">&quot;Consistent with real life: in line with the process and logic of real life, and comply with languages and habits that the users are used to;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¡«å……æ•°æ®åˆ°æŒ‡å®šçš„sheetè¡¨æ ¼ä¸­</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>vo<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>vo<span class="token punctuation">,</span> writeSheet2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¡«å……åˆ—è¡¨</span>
    <span class="token class-name">FillConfig</span> fillConfig <span class="token operator">=</span> <span class="token class-name">FillConfig</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forceNewRow</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¡«å……åˆ—è¡¨æ•°æ®</span>
    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillDataTest</span><span class="token punctuation">&gt;</span></span> voList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FillDataTest</span> fillDataTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token string">&quot;è·³è·³-&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token string">&quot;æµ‹è¯•&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wwww&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ccc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;adadwadadwad&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        voList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fillDataTest<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¡«å……åˆ—è¡¨ æŒ‡å®šsheet</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> voList<span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¡«å……åˆ—è¡¨</span>
    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FillDataTest</span><span class="token punctuation">&gt;</span></span> voList2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FillDataTest</span> fillDataTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FillDataTest</span><span class="token punctuation">(</span><span class="token string">&quot;sheet-02-&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sheet-02&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        voList2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fillDataTest<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¡«å……åˆ—è¡¨ æŒ‡å®šsheet</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FillWrapper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> voList2<span class="token punctuation">)</span><span class="token punctuation">,</span> fillConfig<span class="token punctuation">,</span> writeSheet2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å…³é—­æµ</span>
    excelWriter<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061510346.png" alt="image-20240506151028169"></p> <p><img src="https://cdn.jsdelivr.net/gh/LuJunandapai/ApaiImage@main/KaiYu-PicGo/202405061509292.png" alt="image-20240506150923105"></p> <h1 id="ç‰¹åˆ«æ³¨æ„"><a href="#ç‰¹åˆ«æ³¨æ„" class="header-anchor">#</a> ç‰¹åˆ«æ³¨æ„</h1> <h2 id="liunx-ç¯å¢ƒå¯¼å‡ºæŠ¥é”™"><a href="#liunx-ç¯å¢ƒå¯¼å‡ºæŠ¥é”™" class="header-anchor">#</a> Liunx  ç¯å¢ƒå¯¼å‡ºæŠ¥é”™</h2> <p>com.alibaba.excel.exception.ExcelGenerateException: java.lang.UnsatisfiedLinkError: /usr/local/openjdk-8/lib/amd64/libfontmanager.so: libfreetype.so.6: cannot open shared object file: No such file or directory</p> <ul><li>é—®é¢˜: åœ¨æœ¬åœ°æ­£å¸¸ä½¿ç”¨, Liunx ç¯å¢ƒå¯¼å‡ºæŠ¥é”™</li> <li>è¯´æ˜: ç¯å¢ƒç¼ºå°‘ easyexcel çš„æ‰€éœ€å­—ä½“, åœ¨å¯¼å‡ºæ—¶æŠ¥é”™</li> <li>è§£å†³: ä½¿ç”¨ FROM frolvlad/alpine-java:jdk8-slim é•œåƒ,  æ­¤é•œåƒåŒ…å«äº†easyexcelæ‰€éœ€è¦çš„å­—ä½“æ–‡ä»¶</li> <li>å‚è€ƒåœ°å€: https://lhalcyon.com/alpine-font-issue/</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># æŒ‡å®šåŸºç¡€é•œåƒï¼Œåœ¨å…¶ä¸Šè¿›è¡Œå®šåˆ¶ (FROM java:8 å¼ƒç”¨) æ³¨æ„:é•œåƒè¿‡äºç²¾ç®€æ²¡æœ‰å­—ä½“easyexcelåœ¨å¯¼å‡ºæ—¶ä¼šæŠ¥é”™</span>
<span class="token comment">#FROM openjdk:8-jre-slim</span>

<span class="token comment"># æ­¤é•œåƒåŒ…å«äº†easyexcelæ‰€éœ€è¦çš„å­—ä½“æ–‡ä»¶</span>
FROM frolvlad/alpine-java:jdk8-slim
<span class="token comment"># ç»´æŠ¤è€…ä¿¡æ¯</span>
MAINTAINER Your Name <span class="token operator">&lt;</span><span class="token number">2386297795</span>@QQ.com<span class="token operator">&gt;</span>
<span class="token comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span>
ENV <span class="token assign-left variable">PARAMS</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
ENV <span class="token assign-left variable">TZ</span><span class="token operator">=</span>PRC
<span class="token comment"># è®¾ç½®æ—¶åŒº</span>
RUN <span class="token function">ln</span> -snf /usr/share/zoneinfo/<span class="token variable">$TZ</span> /etc/localtime <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token variable">$TZ</span> <span class="token operator">&gt;</span> /etc/timezone
<span class="token comment"># é‡å‘½å jar æ–‡ä»¶</span>
ADD target/aftersaleserver-*.jar /KaiYun-App/aftersaleserverApp.jar
<span class="token comment"># è®¾ç½®å·¥ä½œç›®å½•ä¸º JAR æ–‡ä»¶çš„ç›®å½• | System.getProperty(&quot;user.dir&quot;)) æŒ‡å®šçš„å·¥ä½œç›®å½•</span>
WORKDIR /KaiYun-App
<span class="token comment"># å£°æ˜è¿è¡Œæ—¶å®¹å™¨æä¾›æœåŠ¡ç«¯å£ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå£°æ˜ï¼Œåœ¨è¿è¡Œæ—¶å¹¶ä¸ä¼šå› ä¸ºè¿™ä¸ªå£°æ˜åº”ç”¨å°±ä¼šå¼€å¯è¿™ä¸ªç«¯å£çš„æœåŠ¡</span>
EXPOSE <span class="token number">3001</span>
<span class="token comment"># è®¾ç½®æœ€å¤§è¿è¡Œå†…å­˜ä¸º256mb</span>
ENV <span class="token assign-left variable">JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xmx256m&quot;</span>
<span class="token comment"># æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•° ENTRYPOINT [&quot;cmdå‘½ä»¤&quot;]</span>
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;java&quot;</span>,<span class="token string">&quot;-jar&quot;</span>,<span class="token string">&quot;/KaiYun-App/aftersaleserverApp.jar&quot;</span>, <span class="token string">&quot;--server.port=3001&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># å¤‡ç”¨: CMD java -jar $JAVA_OPTS /app.jar --server.port=$SERVER_PORT $PARAMS</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="pager"><a href="/Welcome/post/2022/08/01/%E4%BB%A3%E7%A0%81%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7/" class="next">
    ä¸‹ä¸€ç¯‡<br> <span>
      ä»£ç è¾…åŠ©å·¥å…·
    </span></a> <a href="/Welcome/post/2022/07/14/sharding-jdbc-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" class="previous">
    ä¸Šä¸€ç¯‡<br> <span>
      Sharding_JDBC åˆ†åº“åˆ†è¡¨
    </span></a></div> <!----></main> <ul class="catalog" style="top:0px !important;" data-v-86932056><li class="level-2 toc-link-easy-excel-åŸºç¡€" data-v-86932056>Easy Excel åŸºç¡€</li><li class="level-3 toc-link-easy-excel-ä»‹ç»" data-v-86932056>Easy Excel ä»‹ç»</li><li class="level-3 toc-link-easy-excel-ä¾èµ–" data-v-86932056>Easy Excel ä¾èµ–</li><li class="level-2 toc-link-excel-æ³¨è§£" data-v-86932056>Excel æ³¨è§£</li><li class="level-3 toc-link-ç±»æ³¨è§£" data-v-86932056>ç±»æ³¨è§£</li><li class="level-3 toc-link-å­—æ®µæ³¨è§£" data-v-86932056>å­—æ®µæ³¨è§£</li><li class="level-4 toc-link-excelproperty-å¯¼å‡ºåˆ—" data-v-86932056>@ExcelProperty å¯¼å‡ºåˆ—</li><li class="level-4 toc-link-excelignoreunannotated" data-v-86932056>@ExcelIgnoreUnannotated</li><li class="level-4 toc-link-columnwith" data-v-86932056>@ColumnWith</li><li class="level-4 toc-link-excelignore-å¿½ç•¥å¯¼å‡º" data-v-86932056>@ExcelIgnore å¿½ç•¥å¯¼å‡º</li><li class="level-4 toc-link-datetimeformat-æ—¶é—´è½¬æ¢" data-v-86932056>@DateTimeFormat æ—¶é—´è½¬æ¢</li><li class="level-4 toc-link-numberformat-åŠ åç¼€å•ä½" data-v-86932056>@NumberFormat åŠ åç¼€å•ä½</li><li class="level-2 toc-link-vue-å¯¼å…¥ç»„ä»¶" data-v-86932056>Vue å¯¼å…¥ç»„ä»¶</li><li class="level-2 toc-link-ajax-è¯·æ±‚å¯¼å…¥" data-v-86932056>Ajax è¯·æ±‚å¯¼å…¥</li><li class="level-3 toc-link-æ ‡å‡†å¯¼å…¥å¯¼å‡ºç»„ä»¶" data-v-86932056>æ ‡å‡†å¯¼å…¥å¯¼å‡ºç»„ä»¶</li><li class="level-3 toc-link-è¡¨æ ¼é”™è¯¯ä¿¡æ¯ç»„ä»¶" data-v-86932056>è¡¨æ ¼é”™è¯¯ä¿¡æ¯ç»„ä»¶</li><li class="level-3 toc-link-å¯¼å…¥å¯¼å‡ºæ–¹æ³•" data-v-86932056>å¯¼å…¥å¯¼å‡ºæ–¹æ³•</li><li class="level-3 toc-link-å‘èµ·è¡¨æ ¼è¯·æ±‚" data-v-86932056>å‘èµ·è¡¨æ ¼è¯·æ±‚</li><li class="level-3 toc-link-ajax-æ‹¦æˆªå™¨" data-v-86932056>ajax æ‹¦æˆªå™¨</li><li class="level-3 toc-link-è¡¨ç°å±‚" data-v-86932056>è¡¨ç°å±‚</li><li class="level-3 toc-link-ä¸šåŠ¡å±‚" data-v-86932056>ä¸šåŠ¡å±‚</li><li class="level-3 toc-link-å¯¼å…¥æ–¹æ³•ç±»" data-v-86932056>å¯¼å…¥æ–¹æ³•ç±»</li><li class="level-3 toc-link-è¡¨æ ¼å¯¼å…¥å¼‚å¸¸ç±»" data-v-86932056>è¡¨æ ¼å¯¼å…¥å¼‚å¸¸ç±»</li><li class="level-3 toc-link-å…¨å±€è¡¨æ ¼å¼‚å¸¸æ•æ‰" data-v-86932056>å…¨å±€è¡¨æ ¼å¼‚å¸¸æ•æ‰</li><li class="level-2 toc-link-åŸºæœ¬å¯¼å…¥" data-v-86932056>åŸºæœ¬å¯¼å…¥</li><li class="level-3 toc-link-ç®€è¿°" data-v-86932056>ç®€è¿°</li><li class="level-3 toc-link-å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹" data-v-86932056>å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</li><li class="level-3 toc-link-å¯¼å…¥ä»£ç ç¤ºä¾‹" data-v-86932056>å¯¼å…¥ä»£ç ç¤ºä¾‹</li><li class="level-4 toc-link-å®ä½“ç±»" data-v-86932056>å®ä½“ç±»</li><li class="level-4 toc-link-å¯¼å…¥ç›‘å¬å™¨" data-v-86932056>å¯¼å…¥ç›‘å¬å™¨</li><li class="level-4 toc-link-è¡¨ç°å±‚-2" data-v-86932056>è¡¨ç°å±‚</li><li class="level-4 toc-link-ä¸šåŠ¡å±‚-2" data-v-86932056>ä¸šåŠ¡å±‚</li><li class="level-4 toc-link-å¯¼å…¥æµ‹è¯•ç»“æœ" data-v-86932056>å¯¼å…¥æµ‹è¯•ç»“æœ</li><li class="level-2 toc-link-ä¸€æ¬¡è¯»å–å…¨éƒ¨-sheet" data-v-86932056>ä¸€æ¬¡è¯»å–å…¨éƒ¨ Sheet</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-3 toc-link-å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-2" data-v-86932056>å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</li><li class="level-2 toc-link-åˆ†åˆ«è¯»å–-sheet" data-v-86932056>åˆ†åˆ«è¯»å– Sheet</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-2" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-3 toc-link-å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-3" data-v-86932056>å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</li><li class="level-2 toc-link-ä»¥æµå¯¼å…¥å¤šä¸ª-sheet" data-v-86932056>ä»¥æµå¯¼å…¥å¤šä¸ª Sheet</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-3" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-3 toc-link-å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹-4" data-v-86932056>å¯¼å…¥æ¨¡æ¿ç¤ºä¾‹</li><li class="level-2 toc-link-ajax-è¯·æ±‚ä¸‹è½½" data-v-86932056>Ajax è¯·æ±‚ä¸‹è½½</li><li class="level-2 toc-link-excel-å†™å·¥å…·ç±»" data-v-86932056>Excel å†™å·¥å…·ç±»</li><li class="level-2 toc-link-åŸºæœ¬å¯¼å‡º" data-v-86932056>åŸºæœ¬å¯¼å‡º</li><li class="level-3 toc-link-å®ä½“ç±»-2" data-v-86932056>å®ä½“ç±»</li><li class="level-3 toc-link-è¡¨ç°å±‚-3" data-v-86932056>è¡¨ç°å±‚</li><li class="level-3 toc-link-å¯¼å‡ºæ¨¡æ¿ç¤ºä¾‹" data-v-86932056>å¯¼å‡ºæ¨¡æ¿ç¤ºä¾‹</li><li class="level-2 toc-link-å¤æ‚å¤´å¯¼å‡º" data-v-86932056>å¤æ‚å¤´å¯¼å‡º</li><li class="level-3 toc-link-å®ä½“ç±»åŠæ ·å¼" data-v-86932056>å®ä½“ç±»åŠæ ·å¼</li><li class="level-3 toc-link-è¡¨ç°å±‚-4" data-v-86932056>è¡¨ç°å±‚</li><li class="level-2 toc-link-å¯¼å‡ºå¤šä¸ªsheet-åŒå¯¹è±¡" data-v-86932056>å¯¼å‡ºå¤šä¸ªsheet(åŒå¯¹è±¡)</li><li class="level-3 toc-link-æ³¨æ„ç‚¹" data-v-86932056>æ³¨æ„ç‚¹</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-4" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-3 toc-link-å¯¼å‡ºæ ·å¼ç¤ºä¾‹" data-v-86932056>å¯¼å‡ºæ ·å¼ç¤ºä¾‹</li><li class="level-2 toc-link-å¯¼å‡ºå¤šä¸ªsheet-ä¸åŒå¯¹è±¡" data-v-86932056>å¯¼å‡ºå¤šä¸ªsheet(ä¸åŒå¯¹è±¡)</li><li class="level-3 toc-link-æ³¨æ„ç‚¹-2" data-v-86932056>æ³¨æ„ç‚¹</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-5" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-3 toc-link-å¯¼å‡ºæ ·å¼ç¤ºä¾‹-2" data-v-86932056>å¯¼å‡ºæ ·å¼ç¤ºä¾‹</li><li class="level-2 toc-link-å¯¼å‡ºè‡ªå®šä¹‰æ ¼å¼è½¬æ¢" data-v-86932056>å¯¼å‡ºè‡ªå®šä¹‰æ ¼å¼è½¬æ¢</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-6" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-3 toc-link-å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹" data-v-86932056>å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</li><li class="level-2 toc-link-å›¾ç‰‡å¯¼å‡º" data-v-86932056>å›¾ç‰‡å¯¼å‡º</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-7" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-4 toc-link-å®ä½“ç±»-3" data-v-86932056>å®ä½“ç±»</li><li class="level-4 toc-link-è¡¨ç°å±‚-5" data-v-86932056>è¡¨ç°å±‚</li><li class="level-4 toc-link-å·¥å…·ç±»æ–¹æ³•" data-v-86932056>å·¥å…·ç±»æ–¹æ³•</li><li class="level-3 toc-link-å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-2" data-v-86932056>å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</li><li class="level-2 toc-link-å¤æ‚è¡Œ-ä¸€å¯¹å¤šå¯¼å‡º" data-v-86932056>å¤æ‚è¡Œ-ä¸€å¯¹å¤šå¯¼å‡º</li><li class="level-3 toc-link-ç®€æ¦‚" data-v-86932056>ç®€æ¦‚:</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-8" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-4 toc-link-å®ä½“ç±»ä»£ç " data-v-86932056>å®ä½“ç±»ä»£ç </li><li class="level-4 toc-link-æ‹¦æˆªå™¨ä»£ç " data-v-86932056>æ‹¦æˆªå™¨ä»£ç </li><li class="level-4 toc-link-å·¥å…·ç±»æ–¹æ³•ä»£ç " data-v-86932056>å·¥å…·ç±»æ–¹æ³•ä»£ç </li><li class="level-4 toc-link-è¡¨ç°å±‚ä»£ç " data-v-86932056>è¡¨ç°å±‚ä»£ç </li><li class="level-3 toc-link-å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-3" data-v-86932056>å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</li><li class="level-2 toc-link-è®¾ç½®å†»ç»“ç­›é€‰å¤´" data-v-86932056>è®¾ç½®å†»ç»“ç­›é€‰å¤´</li><li class="level-3 toc-link-ç®€æ¦‚-2" data-v-86932056>ç®€æ¦‚:</li><li class="level-3 toc-link-ä»£ç ç¤ºä¾‹-9" data-v-86932056>ä»£ç ç¤ºä¾‹</li><li class="level-4 toc-link-å®ä½“ç±»ä»£ç -2" data-v-86932056>å®ä½“ç±»ä»£ç </li><li class="level-4 toc-link-æ‹¦æˆªå™¨ä»£ç -2" data-v-86932056>æ‹¦æˆªå™¨ä»£ç </li><li class="level-4 toc-link-å·¥å…·ç±»æ–¹æ³•ä»£ç -2" data-v-86932056>å·¥å…·ç±»æ–¹æ³•ä»£ç </li><li class="level-4 toc-link-è¡¨ç°å±‚ä»£ç -2" data-v-86932056>è¡¨ç°å±‚ä»£ç </li><li class="level-3 toc-link-å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹-4" data-v-86932056>å¯¼å‡ºè¡¨æ ¼ç¤ºä¾‹</li><li class="level-2 toc-link-æµ‹è¯•æ–‡ä»¶" data-v-86932056>æµ‹è¯•æ–‡ä»¶</li><li class="level-3 toc-link-è¡¨ç°å±‚-6" data-v-86932056>è¡¨ç°å±‚</li><li class="level-3 toc-link-å¡«å……å®ä½“ç±»" data-v-86932056>å¡«å……å®ä½“ç±»</li><li class="level-2 toc-link-æ¨¡æ¿å˜é‡" data-v-86932056>æ¨¡æ¿å˜é‡</li><li class="level-2 toc-link-ç®€å•çš„å¡«å……" data-v-86932056>ç®€å•çš„å¡«å……</li><li class="level-2 toc-link-å¡«å……åˆ—è¡¨" data-v-86932056>å¡«å……åˆ—è¡¨</li><li class="level-2 toc-link-å¤æ‚çš„å¡«å……" data-v-86932056>å¤æ‚çš„å¡«å……</li><li class="level-2 toc-link-æ•°æ®é‡å¤§çš„å¤æ‚å¡«å……" data-v-86932056>æ•°æ®é‡å¤§çš„å¤æ‚å¡«å……</li><li class="level-2 toc-link-åˆ—è¡¨æ¨ªå‘çš„å¡«å……" data-v-86932056>åˆ—è¡¨æ¨ªå‘çš„å¡«å……</li><li class="level-2 toc-link-å¤šåˆ—è¡¨ç»„åˆå¡«å……" data-v-86932056>å¤šåˆ—è¡¨ç»„åˆå¡«å……</li><li class="level-2 toc-link-å¤æ‚å¤šshellå¡«å……æ¨¡æ¿" data-v-86932056>å¤æ‚å¤šshellå¡«å……æ¨¡æ¿</li><li class="level-2 toc-link-liunx-ç¯å¢ƒå¯¼å‡ºæŠ¥é”™" data-v-86932056>Liunx  ç¯å¢ƒå¯¼å‡ºæŠ¥é”™</li></ul></div> <div class="search-page" data-v-60b9a85e><span class="search-close"><svg aria-hidden="true" width="34.56" height="34.56" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:2.16em;"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></span> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="menu-btn-container" data-v-413dbfb4 data-v-60b9a85e><div class="menu-btn-wrapper" data-v-413dbfb4><div class="menu-btn" data-v-413dbfb4><div class="menu-btn-icon" style="display:;" data-v-413dbfb4><span data-v-413dbfb4></span> <span data-v-413dbfb4></span> <span data-v-413dbfb4></span></div> <div class="menu-text" style="display:none;" data-v-413dbfb4>
        0
      </div> <svg class="menu-svg" data-v-413dbfb4><circle cx="50%" cy="50%" r="48%" class="menu-border" style="stroke-dasharray:0% 314.15926%;" data-v-413dbfb4></circle></svg></div> <div class="menu-btn-child-wrapper" data-v-413dbfb4><a role="button" aria-label="Toggle light" title="Toggle light" class="toggle-mode menu-btn-child" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;"><path d="M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"/></svg></a> <div class="menu-btn-child" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></div> <div class="menu-btn-child" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg></div> <div class="menu-btn-child menu-toc-btn" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg></div> <div class="menu-btn-child menu-btn-sidebar" data-v-413dbfb4><svg aria-hidden="true" width="19.2" height="19.2" viewBox="-1.6 -1.6 19.2 19.2" fill="currentColor" class="ov-icon" style="font-size:1.2em;" data-v-413dbfb4><path d="M14 2a1 1 0 011 1v10a1 1 0 01-1 1H2a1 1 0 01-1-1V3a1 1 0 011-1h12zM2 1a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V3a2 2 0 00-2-2H2z"/><path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v8a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"/></svg></div></div></div></div> <div class="footer-wrapper footer" data-v-2f609db5 data-v-60b9a85e><span data-v-2f609db5>
      &copy; <a href="https://lujunandapai.github.io/" target="_blank">æ˜¯é˜¿æ´¾å•Š! </a> 2000 - 2024
      <br>
      ç¥æˆ‘ä»¬ - <a href="https://gitee.com/LuisApai" target="_blank">å¹³å®‰å–œä¹</a> &
      <a href="https://github.com/LuJunandapai" target="_blank">ä¸‡äº‹é¡ºé‚</a>
    </span></div></div><div class="global-ui"></div></div>
    <script src="/Welcome/assets/js/app.62c113e7.js" defer></script><script src="/Welcome/assets/js/8.d7055a2e.js" defer></script><script src="/Welcome/assets/js/1.ed48a7ee.js" defer></script><script src="/Welcome/assets/js/2.9a3f7cc9.js" defer></script><script src="/Welcome/assets/js/21.4ee97050.js" defer></script>
  </body>
</html>
